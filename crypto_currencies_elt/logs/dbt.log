[0m18:08:04.373546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d93e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a5e20>]}


============================== 18:08:04.374837 | aa3dab1d-1e40-490c-b936-b28a6e5baf42 ==============================
[0m18:08:04.374837 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:08:04.375106 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt', 'log_cache_events': 'False', 'version_check': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_path': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/logs', 'indirect_selection': 'eager'}
[0m18:08:04.383206 [info ] [MainThread]: dbt version: 1.8.7
[0m18:08:04.383377 [info ] [MainThread]: python version: 3.12.4
[0m18:08:04.383499 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m18:08:04.383606 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m18:08:04.384851 [info ] [MainThread]: Using profiles dir at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt
[0m18:08:04.384972 [info ] [MainThread]: Using profiles.yml file at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/profiles.yml
[0m18:08:04.385074 [info ] [MainThread]: Using dbt_project.yml file at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/dbt_project.yml
[0m18:08:04.412341 [info ] [MainThread]: Configuration:
[0m18:08:04.412551 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:08:04.412675 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:08:04.412777 [info ] [MainThread]: Required dependencies:
[0m18:08:04.412923 [debug] [MainThread]: Executing "git --help"
[0m18:08:04.438947 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:08:04.439393 [debug] [MainThread]: STDERR: "b''"
[0m18:08:04.439528 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:08:04.439666 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:08:04.439780 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:08:04.439886 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'bitcoin_price'


[0m18:08:04.454570 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.12563592, "process_user_time": 0.543786, "process_kernel_time": 0.131219, "process_mem_max_rss": "102318080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:08:04.454919 [debug] [MainThread]: Command `dbt debug` failed at 18:08:04.454863 after 0.13 seconds
[0m18:08:04.455147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104775e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103700860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104887530>]}
[0m18:08:04.455355 [debug] [MainThread]: Flushing usage events
[0m18:12:20.633745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103abf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae2120>]}


============================== 18:12:20.635274 | cf938f36-c6da-4208-baa3-ec73b4433419 ==============================
[0m18:12:20.635274 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:12:20.635559 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'None', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'invocation_command': 'dbt debug', 'log_path': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/logs', 'no_print': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt', 'cache_selected_only': 'False'}
[0m18:12:20.643507 [info ] [MainThread]: dbt version: 1.8.7
[0m18:12:20.643683 [info ] [MainThread]: python version: 3.12.4
[0m18:12:20.643806 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m18:12:20.643912 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m18:12:20.645281 [info ] [MainThread]: Using profiles dir at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt
[0m18:12:20.645402 [info ] [MainThread]: Using profiles.yml file at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/profiles.yml
[0m18:12:20.645504 [info ] [MainThread]: Using dbt_project.yml file at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/dbt_project.yml
[0m18:12:20.673128 [info ] [MainThread]: Configuration:
[0m18:12:20.673379 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:12:20.673501 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:12:20.673606 [info ] [MainThread]: Required dependencies:
[0m18:12:20.673762 [debug] [MainThread]: Executing "git --help"
[0m18:12:20.693313 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:12:20.693687 [debug] [MainThread]: STDERR: "b''"
[0m18:12:20.693803 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:12:20.693936 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:12:20.694061 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:12:20.694164 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'bitcoin_price'


[0m18:12:20.695469 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.10504717, "process_user_time": 0.518935, "process_kernel_time": 0.123617, "process_mem_max_rss": "103038976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:12:20.695779 [debug] [MainThread]: Command `dbt debug` failed at 18:12:20.695725 after 0.11 seconds
[0m18:12:20.695982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10443ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bcbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103abf0b0>]}
[0m18:12:20.696156 [debug] [MainThread]: Flushing usage events
[0m18:13:46.466683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e56300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e56090>]}


============================== 18:13:46.468566 | 788e3d04-0149-43e1-83e8-c8ac6da5e214 ==============================
[0m18:13:46.468566 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:13:46.468840 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'debug': 'False', 'profiles_dir': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True'}
[0m18:13:46.475422 [info ] [MainThread]: dbt version: 1.8.7
[0m18:13:46.475561 [info ] [MainThread]: python version: 3.12.4
[0m18:13:46.475673 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m18:13:46.475776 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m18:13:49.217739 [info ] [MainThread]: Using profiles dir at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt
[0m18:13:49.217980 [info ] [MainThread]: Using profiles.yml file at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/profiles.yml
[0m18:13:49.218111 [info ] [MainThread]: Using dbt_project.yml file at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/dbt_project.yml
[0m18:13:49.218550 [info ] [MainThread]: adapter type: snowflake
[0m18:13:49.218720 [info ] [MainThread]: adapter version: 1.8.4
[0m18:13:49.246112 [info ] [MainThread]: Configuration:
[0m18:13:49.246279 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:13:49.246399 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:13:49.246504 [info ] [MainThread]: Required dependencies:
[0m18:13:49.246648 [debug] [MainThread]: Executing "git --help"
[0m18:13:49.260699 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:13:49.261164 [debug] [MainThread]: STDERR: "b''"
[0m18:13:49.261289 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:13:49.261430 [info ] [MainThread]: Connection:
[0m18:13:49.261558 [info ] [MainThread]:   account: XKIPMEW-RUB78960
[0m18:13:49.261662 [info ] [MainThread]:   user: sadhvisingh
[0m18:13:49.261757 [info ] [MainThread]:   database: dev
[0m18:13:49.261851 [info ] [MainThread]:   warehouse: compute_wh
[0m18:13:49.261940 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m18:13:49.262038 [info ] [MainThread]:   schema: analytics
[0m18:13:49.262134 [info ] [MainThread]:   authenticator: None
[0m18:13:49.262223 [info ] [MainThread]:   oauth_client_id: None
[0m18:13:49.262315 [info ] [MainThread]:   query_tag: None
[0m18:13:49.262405 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:13:49.262495 [info ] [MainThread]:   host: None
[0m18:13:49.262590 [info ] [MainThread]:   port: None
[0m18:13:49.262681 [info ] [MainThread]:   proxy_host: None
[0m18:13:49.262779 [info ] [MainThread]:   proxy_port: None
[0m18:13:49.262868 [info ] [MainThread]:   protocol: None
[0m18:13:49.262957 [info ] [MainThread]:   connect_retries: 1
[0m18:13:49.263050 [info ] [MainThread]:   connect_timeout: None
[0m18:13:49.263142 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:13:49.263232 [info ] [MainThread]:   retry_all: False
[0m18:13:49.263318 [info ] [MainThread]:   insecure_mode: False
[0m18:13:49.263408 [info ] [MainThread]:   reuse_connections: None
[0m18:13:49.263677 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:13:49.278051 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:13:49.278971 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:13:49.279091 [debug] [MainThread]: On debug: select 1 as id
[0m18:13:49.279204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:49.865553 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.586 seconds
[0m18:13:49.868042 [debug] [MainThread]: On debug: Close
[0m18:13:49.987440 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:13:49.988484 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:13:49.994964 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.5676346, "process_user_time": 2.028309, "process_kernel_time": 2.182124, "process_mem_max_rss": "190676992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:13:49.995960 [debug] [MainThread]: Command `dbt debug` succeeded at 18:13:49.995813 after 3.57 seconds
[0m18:13:49.996566 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:13:49.997079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104916de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f3e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1267285c0>]}
[0m18:13:49.997620 [debug] [MainThread]: Flushing usage events
[0m18:31:58.532419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540dfa0>]}


============================== 18:31:58.533872 | 7f192894-bb3e-4ddf-a511-e63b63f7571b ==============================
[0m18:31:58.533872 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:31:58.534149 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'target_path': 'None'}
[0m18:31:58.542028 [info ] [MainThread]: dbt version: 1.8.7
[0m18:31:58.542169 [info ] [MainThread]: python version: 3.12.4
[0m18:31:58.542279 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m18:31:58.542379 [info ] [MainThread]: os info: macOS-15.1-arm64-arm-64bit
[0m18:31:59.258793 [info ] [MainThread]: Using profiles dir at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt
[0m18:31:59.259038 [info ] [MainThread]: Using profiles.yml file at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/profiles.yml
[0m18:31:59.259168 [info ] [MainThread]: Using dbt_project.yml file at /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/dbt_project.yml
[0m18:31:59.259582 [info ] [MainThread]: adapter type: snowflake
[0m18:31:59.259699 [info ] [MainThread]: adapter version: 1.8.4
[0m18:31:59.286722 [info ] [MainThread]: Configuration:
[0m18:31:59.286898 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:31:59.287017 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:31:59.287126 [info ] [MainThread]: Required dependencies:
[0m18:31:59.287263 [debug] [MainThread]: Executing "git --help"
[0m18:31:59.309592 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:31:59.310384 [debug] [MainThread]: STDERR: "b''"
[0m18:31:59.310552 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:31:59.310706 [info ] [MainThread]: Connection:
[0m18:31:59.310845 [info ] [MainThread]:   account: XKIPMEW-RUB78960
[0m18:31:59.310949 [info ] [MainThread]:   user: sadhvisingh
[0m18:31:59.311048 [info ] [MainThread]:   database: dev
[0m18:31:59.311141 [info ] [MainThread]:   warehouse: compute_wh
[0m18:31:59.311235 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m18:31:59.311330 [info ] [MainThread]:   schema: analytics
[0m18:31:59.311426 [info ] [MainThread]:   authenticator: None
[0m18:31:59.311519 [info ] [MainThread]:   oauth_client_id: None
[0m18:31:59.311608 [info ] [MainThread]:   query_tag: None
[0m18:31:59.311700 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:31:59.311789 [info ] [MainThread]:   host: None
[0m18:31:59.311882 [info ] [MainThread]:   port: None
[0m18:31:59.311969 [info ] [MainThread]:   proxy_host: None
[0m18:31:59.312058 [info ] [MainThread]:   proxy_port: None
[0m18:31:59.312144 [info ] [MainThread]:   protocol: None
[0m18:31:59.312232 [info ] [MainThread]:   connect_retries: 1
[0m18:31:59.312320 [info ] [MainThread]:   connect_timeout: None
[0m18:31:59.312407 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:31:59.312498 [info ] [MainThread]:   retry_all: False
[0m18:31:59.312585 [info ] [MainThread]:   insecure_mode: False
[0m18:31:59.312673 [info ] [MainThread]:   reuse_connections: None
[0m18:31:59.312950 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m18:31:59.316688 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:31:59.318312 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:31:59.318476 [debug] [MainThread]: On debug: select 1 as id
[0m18:31:59.318623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:59.783208 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.464 seconds
[0m18:31:59.786189 [debug] [MainThread]: On debug: Close
[0m18:31:59.898305 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:31:59.899388 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:31:59.905614 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4146575, "process_user_time": 2.658, "process_kernel_time": 1.073591, "process_mem_max_rss": "189923328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:31:59.906693 [debug] [MainThread]: Command `dbt debug` succeeded at 18:31:59.906527 after 1.42 seconds
[0m18:31:59.907303 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:31:59.907838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104369dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10161eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121027a70>]}
[0m18:31:59.908408 [debug] [MainThread]: Flushing usage events
[0m03:21:14.303551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab1cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c243e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c240170>]}


============================== 03:21:14.315130 | b1d1df24-296b-4942-9a25-69e33ab61cd7 ==============================
[0m03:21:14.315130 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:21:14.315693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:21:14.707524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1d1df24-296b-4942-9a25-69e33ab61cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86141760>]}
[0m03:21:14.726911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1d1df24-296b-4942-9a25-69e33ab61cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7396f2c0>]}
[0m03:21:14.727431 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:21:14.770024 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:21:14.770637 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:21:14.771036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b1d1df24-296b-4942-9a25-69e33ab61cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a57cb30>]}
[0m03:21:15.124976 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dummy_analytics' in the 'models' section of file 'models/schema.yml'
[0m03:21:15.186044 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.unique_dummy_analytics_symbol.893ab8a82b' (models/schema.yml) depends on a node named 'dummy_analytics' in package '' which was not found
[0m03:21:15.186452 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_dummy_analytics_symbol.4d91630bd6' (models/schema.yml) depends on a node named 'dummy_analytics' in package '' which was not found
[0m03:21:15.221001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1d1df24-296b-4942-9a25-69e33ab61cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72ef2d50>]}
[0m03:21:15.266219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1d1df24-296b-4942-9a25-69e33ab61cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72fda0c0>]}
[0m03:21:15.266488 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m03:21:15.266818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d1df24-296b-4942-9a25-69e33ab61cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff725683b0>]}
[0m03:21:15.267608 [info ] [MainThread]: 
[0m03:21:15.267940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:21:15.268391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m03:21:15.273638 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m03:21:15.273858 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m03:21:15.274013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:15.697948 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.424 seconds
[0m03:21:15.701324 [debug] [ThreadPool]: On list_dev: Close
[0m03:21:15.816882 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m03:21:15.831952 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m03:21:15.832788 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m03:21:15.833349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:21:16.251773 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.418 seconds
[0m03:21:16.256781 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m03:21:16.362572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d1df24-296b-4942-9a25-69e33ab61cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff725d0710>]}
[0m03:21:16.364792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:21:16.366880 [info ] [MainThread]: 
[0m03:21:16.381287 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:21:16.382467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m03:21:16.383033 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:21:16.390059 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m03:21:16.393243 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:21:16.394169 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:21:16.394714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m03:21:16.395105 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:21:16.404658 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m03:21:16.405960 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:21:16.406342 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:21:16.406711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m03:21:16.406970 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:21:16.411056 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m03:21:16.412862 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:21:16.413465 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:21:16.413836 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m03:21:16.414487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m03:21:16.414779 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:21:16.418650 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:21:16.419643 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:21:16.433819 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:21:16.436494 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:21:16.436784 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH  __dbt__cte__stg_bitcoin_price as (
WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.dummy_crypto
)
SELECT * FROM stg_bitcoin_price
),  __dbt__cte__fact_bitcoin_daily_with_sma as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
),  __dbt__cte__fact_bitcoin_daily_with_rsi as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM __dbt__cte__stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
), sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM __dbt__cte__fact_bitcoin_daily_with_rsi
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count
FROM sma
JOIN rsi
ON sma.symbol = rsi.symbol AND sma.date = rsi.date
        );
[0m03:21:16.437080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:21:16.884052 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85b69-0004-2ce7-0002-7873000164be
[0m03:21:16.884832 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV.RAW_DATA.DUMMY_CRYPTO' does not exist or not authorized.
[0m03:21:16.885547 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m03:21:17.021023 [debug] [Thread-1 (]: Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEV.RAW_DATA.DUMMY_CRYPTO' does not exist or not authorized.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m03:21:17.022786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1d1df24-296b-4942-9a25-69e33ab61cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b27a180>]}
[0m03:21:17.023628 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.stg_bitcoin_daily_metrics ...... [[31mERROR[0m in 0.61s]
[0m03:21:17.024487 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:21:17.026056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:21:17.026392 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m03:21:17.026714 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m03:21:17.027005 [info ] [MainThread]: 
[0m03:21:17.027454 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m03:21:17.028020 [debug] [MainThread]: Command end result
[0m03:21:17.052365 [info ] [MainThread]: 
[0m03:21:17.052824 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:21:17.053104 [info ] [MainThread]: 
[0m03:21:17.053373 [error] [MainThread]:   Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEV.RAW_DATA.DUMMY_CRYPTO' does not exist or not authorized.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m03:21:17.053599 [info ] [MainThread]: 
[0m03:21:17.053837 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:21:17.054394 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7876697, "process_user_time": 2.76421, "process_kernel_time": 0.154408, "process_mem_max_rss": "209656", "process_in_blocks": "5736", "process_out_blocks": "3077", "command_success": false}
[0m03:21:17.054708 [debug] [MainThread]: Command `dbt run` failed at 03:21:17.054646 after 2.79 seconds
[0m03:21:17.054942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f20aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba0ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72dd6540>]}
[0m03:21:17.055152 [debug] [MainThread]: Flushing usage events
[0m03:23:55.214438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2fc4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b8f2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40f98e0>]}


============================== 03:23:55.217762 | 7bf7e2b4-6150-4df7-a346-76d4e5fa271a ==============================
[0m03:23:55.217762 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:23:55.218266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:23:55.567287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bf7e2b4-6150-4df7-a346-76d4e5fa271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a9343e0>]}
[0m03:23:55.586506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bf7e2b4-6150-4df7-a346-76d4e5fa271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935cf7a0>]}
[0m03:23:55.586925 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:23:55.625790 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:23:55.676566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:23:55.676850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:23:55.693063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bf7e2b4-6150-4df7-a346-76d4e5fa271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5d5d90>]}
[0m03:23:55.736245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bf7e2b4-6150-4df7-a346-76d4e5fa271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2ec2f0>]}
[0m03:23:55.736513 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m03:23:55.736903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf7e2b4-6150-4df7-a346-76d4e5fa271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ae39940>]}
[0m03:23:55.737697 [info ] [MainThread]: 
[0m03:23:55.738053 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:23:55.738506 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m03:23:55.744663 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m03:23:55.744881 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m03:23:55.745070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:23:56.151791 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.407 seconds
[0m03:23:56.154104 [debug] [ThreadPool]: On list_dev: Close
[0m03:23:56.264496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m03:23:56.277968 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m03:23:56.278956 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m03:23:56.279391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:56.701898 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.422 seconds
[0m03:23:56.703720 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m03:23:56.811117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf7e2b4-6150-4df7-a346-76d4e5fa271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bda0c20>]}
[0m03:23:56.812406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:23:56.813475 [info ] [MainThread]: 
[0m03:23:56.823607 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:23:56.824512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m03:23:56.825088 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:23:56.831692 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m03:23:56.833465 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:23:56.834558 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:23:56.834976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m03:23:56.835304 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:23:56.843084 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m03:23:56.844084 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:23:56.844469 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:23:56.844873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m03:23:56.845182 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:23:56.848941 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m03:23:56.849859 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:23:56.850406 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:23:56.850757 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m03:23:56.851443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m03:23:56.851664 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:23:56.856375 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:23:56.857212 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:23:56.871263 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:23:56.873170 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:23:56.873431 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH  __dbt__cte__stg_bitcoin_price as (
WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.dummy_crypto
)
SELECT * FROM stg_bitcoin_price
),  __dbt__cte__fact_bitcoin_daily_with_sma as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
),  __dbt__cte__fact_bitcoin_daily_with_rsi as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM __dbt__cte__stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
), sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM __dbt__cte__fact_bitcoin_daily_with_rsi
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count
FROM sma
JOIN rsi
ON sma.symbol = rsi.symbol AND sma.date = rsi.date
        );
[0m03:23:56.873698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:23:57.194458 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85b6b-0004-2ceb-0002-78730001158e
[0m03:23:57.195863 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV.RAW_DATA.DUMMY_CRYPTO' does not exist or not authorized.
[0m03:23:57.198856 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m03:23:57.281481 [debug] [Thread-1 (]: Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEV.RAW_DATA.DUMMY_CRYPTO' does not exist or not authorized.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m03:23:57.282483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf7e2b4-6150-4df7-a346-76d4e5fa271a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa283a150>]}
[0m03:23:57.282926 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.stg_bitcoin_daily_metrics ...... [[31mERROR[0m in 0.43s]
[0m03:23:57.283552 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:23:57.284669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:23:57.284885 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m03:23:57.285105 [info ] [MainThread]: 
[0m03:23:57.285407 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m03:23:57.285816 [debug] [MainThread]: Command end result
[0m03:23:57.306032 [info ] [MainThread]: 
[0m03:23:57.306633 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:23:57.306856 [info ] [MainThread]: 
[0m03:23:57.307093 [error] [MainThread]:   Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEV.RAW_DATA.DUMMY_CRYPTO' does not exist or not authorized.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m03:23:57.307333 [info ] [MainThread]: 
[0m03:23:57.307586 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:23:57.308166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.127856, "process_user_time": 2.36803, "process_kernel_time": 0.126268, "process_mem_max_rss": "207776", "process_out_blocks": "1910", "command_success": false, "process_in_blocks": "0"}
[0m03:23:57.308486 [debug] [MainThread]: Command `dbt run` failed at 03:23:57.308438 after 2.13 seconds
[0m03:23:57.308708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa22e33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8b4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8b5640>]}
[0m03:23:57.308900 [debug] [MainThread]: Flushing usage events
[0m03:27:56.358673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850de030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850dbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850dde80>]}


============================== 03:27:56.362811 | 74b40f37-7439-4274-9f6a-225e6dfc8de1 ==============================
[0m03:27:56.362811 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:27:56.363407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m03:27:56.759719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74b40f37-7439-4274-9f6a-225e6dfc8de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d37710>]}
[0m03:27:56.778189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74b40f37-7439-4274-9f6a-225e6dfc8de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff619173b0>]}
[0m03:27:56.778635 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:27:56.817188 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:27:56.867420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:27:56.867677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:27:56.883242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74b40f37-7439-4274-9f6a-225e6dfc8de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff616161b0>]}
[0m03:27:56.925701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74b40f37-7439-4274-9f6a-225e6dfc8de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff612fc800>]}
[0m03:27:56.925966 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m03:27:56.926320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b40f37-7439-4274-9f6a-225e6dfc8de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61604350>]}
[0m03:27:56.927068 [info ] [MainThread]: 
[0m03:27:56.927390 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:27:56.927870 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m03:27:56.934101 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m03:27:56.934373 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m03:27:56.934559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:57.354459 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.420 seconds
[0m03:27:57.358271 [debug] [ThreadPool]: On list_dev: Close
[0m03:27:57.452325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m03:27:57.467005 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m03:27:57.467816 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m03:27:57.468349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:27:57.868634 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.400 seconds
[0m03:27:57.871501 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m03:27:57.976548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b40f37-7439-4274-9f6a-225e6dfc8de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff615ea150>]}
[0m03:27:57.978422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:27:57.980066 [info ] [MainThread]: 
[0m03:27:57.992568 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:27:57.993349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m03:27:57.993801 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:27:58.000383 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m03:27:58.003106 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:27:58.003854 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:27:58.004382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m03:27:58.004767 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:27:58.012695 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m03:27:58.013922 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:27:58.014290 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:27:58.014737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m03:27:58.015049 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:27:58.018658 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m03:27:58.019428 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:27:58.019939 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:27:58.020231 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m03:27:58.020766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m03:27:58.021027 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:27:58.025543 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:27:58.026295 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:27:58.040385 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:27:58.042231 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:27:58.042522 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH  __dbt__cte__stg_bitcoin_price as (
WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.dummy_crypto
)
SELECT * FROM stg_bitcoin_price
),  __dbt__cte__fact_bitcoin_daily_with_sma as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
),  __dbt__cte__fact_bitcoin_daily_with_rsi as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM __dbt__cte__stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
), sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM __dbt__cte__fact_bitcoin_daily_with_rsi
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count
FROM sma
JOIN rsi
ON sma.symbol = rsi.symbol AND sma.date = rsi.date
        );
[0m03:27:58.042801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:27:59.474283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.431 seconds
[0m03:27:59.505085 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m03:27:59.626222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b40f37-7439-4274-9f6a-225e6dfc8de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85839f70>]}
[0m03:27:59.627193 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 1.60s]
[0m03:27:59.627994 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:27:59.629035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:59.629292 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m03:27:59.629519 [info ] [MainThread]: 
[0m03:27:59.629965 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m03:27:59.630524 [debug] [MainThread]: Command end result
[0m03:27:59.653538 [info ] [MainThread]: 
[0m03:27:59.654702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:27:59.655217 [info ] [MainThread]: 
[0m03:27:59.655560 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:27:59.656268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3465927, "process_user_time": 2.639678, "process_kernel_time": 0.152523, "process_mem_max_rss": "207768", "process_out_blocks": "1908", "process_in_blocks": "0"}
[0m03:27:59.656602 [debug] [MainThread]: Command `dbt run` succeeded at 03:27:59.656535 after 3.35 seconds
[0m03:27:59.656894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8980aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6093c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85867350>]}
[0m03:27:59.657162 [debug] [MainThread]: Flushing usage events
[0m03:28:01.943565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56b0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d6bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b94f20>]}


============================== 03:28:01.946922 | 736402f2-cffd-4f2d-b656-4208f24573eb ==============================
[0m03:28:01.946922 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:28:01.947465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:28:02.309523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '736402f2-cffd-4f2d-b656-4208f24573eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b039b0>]}
[0m03:28:02.328139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '736402f2-cffd-4f2d-b656-4208f24573eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fdc1d0>]}
[0m03:28:02.328580 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:28:02.365866 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:28:02.412738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:28:02.413091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:28:02.429287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '736402f2-cffd-4f2d-b656-4208f24573eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0fe0410>]}
[0m03:28:02.479385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '736402f2-cffd-4f2d-b656-4208f24573eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90395c40>]}
[0m03:28:02.479685 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m03:28:02.480075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736402f2-cffd-4f2d-b656-4208f24573eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a79fa0>]}
[0m03:28:02.480850 [info ] [MainThread]: 
[0m03:28:02.481140 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:28:02.481938 [debug] [MainThread]: Command end result
[0m03:28:02.496819 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.58982646, "process_user_time": 1.988232, "process_kernel_time": 0.076432, "process_mem_max_rss": "207764", "process_in_blocks": "1968", "process_out_blocks": "1841"}
[0m03:28:02.497130 [debug] [MainThread]: Command `dbt test` succeeded at 03:28:02.497080 after 0.59 seconds
[0m03:28:02.497330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48c51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905ac5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4571250>]}
[0m03:28:02.497508 [debug] [MainThread]: Flushing usage events
[0m03:28:05.069236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96eb2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96bd6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973fca70>]}


============================== 03:28:05.072339 | 71440fa2-160f-4a1f-b209-9dda4cd22da9 ==============================
[0m03:28:05.072339 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:28:05.072865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:28:05.421228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71440fa2-160f-4a1f-b209-9dda4cd22da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f937ef0>]}
[0m03:28:05.440488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71440fa2-160f-4a1f-b209-9dda4cd22da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9820c530>]}
[0m03:28:05.440930 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:28:05.482872 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:28:05.530553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:28:05.530837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:28:05.546170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71440fa2-160f-4a1f-b209-9dda4cd22da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f10de50>]}
[0m03:28:05.589020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71440fa2-160f-4a1f-b209-9dda4cd22da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6edf3830>]}
[0m03:28:05.589284 [info ] [MainThread]: Found 4 models, 3 sources, 459 macros
[0m03:28:05.589660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71440fa2-160f-4a1f-b209-9dda4cd22da9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f0fa9f0>]}
[0m03:28:05.590412 [info ] [MainThread]: 
[0m03:28:05.590695 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:28:05.591503 [debug] [MainThread]: Command end result
[0m03:28:05.605919 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5706259, "process_user_time": 2.101106, "process_kernel_time": 0.083844, "process_mem_max_rss": "207768", "process_in_blocks": "8", "process_out_blocks": "1841"}
[0m03:28:05.606218 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:28:05.606171 after 0.57 seconds
[0m03:28:05.606453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979b8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b025b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c223f0>]}
[0m03:28:05.606676 [debug] [MainThread]: Flushing usage events
[0m03:46:45.328017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49b1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb71edf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f7b800>]}


============================== 03:46:45.331505 | 331914f5-2ae2-4217-8f2f-eb4e3a300aea ==============================
[0m03:46:45.331505 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:46:45.331829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:46:45.693361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '331914f5-2ae2-4217-8f2f-eb4e3a300aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27df710>]}
[0m03:46:45.711775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '331914f5-2ae2-4217-8f2f-eb4e3a300aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b334f80>]}
[0m03:46:45.712234 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:46:45.750532 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:46:45.797946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:46:45.798310 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/schema.yml
[0m03:46:45.798675 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/sources.yml
[0m03:46:45.881251 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'analysis_crypto_currencies' in the 'models' section of file 'models/schema.yml'
[0m03:46:45.936725 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.crypto_currencies_elt.stg_bitcoin_price' (models/input/stg_bitcoin_price.sql) depends on a source named 'raw_data.dummy_crypto' which was not found
[0m03:46:45.937673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6445188, "process_user_time": 2.241735, "process_kernel_time": 0.112237, "process_mem_max_rss": "207828", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m03:46:45.937946 [debug] [MainThread]: Command `dbt run` failed at 03:46:45.937889 after 0.64 seconds
[0m03:46:45.938183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49b1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af20440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af5ea80>]}
[0m03:46:45.938416 [debug] [MainThread]: Flushing usage events
[0m03:49:35.213504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6ee570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb42180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea28050>]}


============================== 03:49:35.217684 | 649d7c93-d068-45d5-9577-0ea417a2481f ==============================
[0m03:49:35.217684 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:49:35.218155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m03:49:35.657735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '649d7c93-d068-45d5-9577-0ea417a2481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff774d7e60>]}
[0m03:49:35.680053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '649d7c93-d068-45d5-9577-0ea417a2481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8176e120>]}
[0m03:49:35.680665 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:49:35.733796 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:49:35.797939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:49:35.798593 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/sources.yml
[0m03:49:35.798944 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/schema.yml
[0m03:49:35.799193 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/input/stg_bitcoin_price.sql
[0m03:49:35.924860 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'analysis_crypto_currencies' in the 'models' section of file 'models/schema.yml'
[0m03:49:35.961924 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.unique_analysis_crypto_currencies_symbol.41c2819f5c' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m03:49:35.962462 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_symbol.2689d6bf11' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m03:49:35.992628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '649d7c93-d068-45d5-9577-0ea417a2481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76d6bb90>]}
[0m03:49:36.045318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '649d7c93-d068-45d5-9577-0ea417a2481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7736e300>]}
[0m03:49:36.045734 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:49:36.046310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '649d7c93-d068-45d5-9577-0ea417a2481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7749da60>]}
[0m03:49:36.047509 [info ] [MainThread]: 
[0m03:49:36.048163 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:49:36.048710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m03:49:36.054954 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m03:49:36.055532 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m03:49:36.055940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:36.453588 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.397 seconds
[0m03:49:36.458060 [debug] [ThreadPool]: On list_dev: Close
[0m03:49:36.549198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m03:49:36.556459 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m03:49:36.556826 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m03:49:36.557135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:36.911861 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.354 seconds
[0m03:49:36.916352 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m03:49:37.000090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '649d7c93-d068-45d5-9577-0ea417a2481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76d6a4b0>]}
[0m03:49:37.001796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:49:37.003704 [info ] [MainThread]: 
[0m03:49:37.018084 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:49:37.018983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m03:49:37.019519 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:49:37.026816 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m03:49:37.029648 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:49:37.030463 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:49:37.030946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m03:49:37.031332 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:49:37.039605 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m03:49:37.040619 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:49:37.041053 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:49:37.041432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m03:49:37.041706 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:49:37.046218 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m03:49:37.046941 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:49:37.047418 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:49:37.047689 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m03:49:37.048203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m03:49:37.048455 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:49:37.052273 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:49:37.053083 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:49:37.067725 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:49:37.069563 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:49:37.069814 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH  __dbt__cte__stg_bitcoin_price as (
WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
),  __dbt__cte__fact_bitcoin_daily_with_sma as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
),  __dbt__cte__fact_bitcoin_daily_with_rsi as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM __dbt__cte__stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
), sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM __dbt__cte__fact_bitcoin_daily_with_rsi
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count
FROM sma
JOIN rsi
ON sma.symbol = rsi.symbol AND sma.date = rsi.date
        );
[0m03:49:37.070046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:37.464608 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85b85-0004-2cee-0000-00027873e61d
[0m03:49:37.465523 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV.RAW_DATA.CRYPTO_CURRENCIES' does not exist or not authorized.
[0m03:49:37.466235 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m03:49:37.568458 [debug] [Thread-1 (]: Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEV.RAW_DATA.CRYPTO_CURRENCIES' does not exist or not authorized.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m03:49:37.571744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '649d7c93-d068-45d5-9577-0ea417a2481f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f555f10>]}
[0m03:49:37.573531 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.stg_bitcoin_daily_metrics ...... [[31mERROR[0m in 0.52s]
[0m03:49:37.575516 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:49:37.578439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:37.578945 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m03:49:37.579327 [info ] [MainThread]: 
[0m03:49:37.580209 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m03:49:37.581275 [debug] [MainThread]: Command end result
[0m03:49:37.610860 [info ] [MainThread]: 
[0m03:49:37.611747 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:49:37.612087 [info ] [MainThread]: 
[0m03:49:37.612486 [error] [MainThread]:   Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  002003 (42S02): SQL compilation error:
  Object 'DEV.RAW_DATA.CRYPTO_CURRENCIES' does not exist or not authorized.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m03:49:37.612871 [info ] [MainThread]: 
[0m03:49:37.613275 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m03:49:37.614131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4509242, "process_user_time": 2.652562, "process_kernel_time": 0.198463, "process_mem_max_rss": "212504", "process_out_blocks": "2825", "command_success": false, "process_in_blocks": "0"}
[0m03:49:37.614599 [debug] [MainThread]: Command `dbt run` failed at 03:49:37.614522 after 2.45 seconds
[0m03:49:37.614903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6ee570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff770ae210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed72300>]}
[0m03:49:37.615126 [debug] [MainThread]: Flushing usage events
[0m03:53:53.883795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29c3da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32a3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29c3e30>]}


============================== 03:53:53.887210 | dc4a1670-0732-4775-ba5a-b27075e4e355 ==============================
[0m03:53:53.887210 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:53:53.887541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:53:54.250118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc4a1670-0732-4775-ba5a-b27075e4e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b78ce0>]}
[0m03:53:54.269136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc4a1670-0732-4775-ba5a-b27075e4e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b792510>]}
[0m03:53:54.269562 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:53:54.307935 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:53:54.358663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:53:54.359200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:53:54.377374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc4a1670-0732-4775-ba5a-b27075e4e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b28dd60>]}
[0m03:53:54.420790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc4a1670-0732-4775-ba5a-b27075e4e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7afc8140>]}
[0m03:53:54.421062 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:53:54.421255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc4a1670-0732-4775-ba5a-b27075e4e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2b5130>]}
[0m03:53:54.422094 [info ] [MainThread]: 
[0m03:53:54.422417 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:53:54.422918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m03:53:54.429039 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m03:53:54.429319 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m03:53:54.429494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:53:54.904290 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.475 seconds
[0m03:53:54.905262 [debug] [ThreadPool]: On list_dev: Close
[0m03:53:54.999177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m03:53:55.004938 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m03:53:55.006006 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m03:53:55.006335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:53:55.443492 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.437 seconds
[0m03:53:55.447336 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m03:53:55.531667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc4a1670-0732-4775-ba5a-b27075e4e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd8e390>]}
[0m03:53:55.532380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:53:55.532826 [info ] [MainThread]: 
[0m03:53:55.539301 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:53:55.539697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m03:53:55.540001 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:53:55.544443 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m03:53:55.545752 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:53:55.546350 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:53:55.546595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m03:53:55.546793 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:53:55.553038 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m03:53:55.553693 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:53:55.553906 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:53:55.554146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m03:53:55.554358 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:53:55.557636 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m03:53:55.558605 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:53:55.559075 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:53:55.559362 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m03:53:55.559593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m03:53:55.559803 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:53:55.563966 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:53:55.564505 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:53:55.577725 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:53:55.579330 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:53:55.579583 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH  __dbt__cte__stg_bitcoin_price as (
WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
),  __dbt__cte__fact_bitcoin_daily_with_sma as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
),  __dbt__cte__fact_bitcoin_daily_with_rsi as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM __dbt__cte__stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
), sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM __dbt__cte__fact_bitcoin_daily_with_rsi
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count
FROM sma
JOIN rsi
ON sma.symbol = rsi.symbol AND sma.date = rsi.date
        );
[0m03:53:55.579796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:53:56.680411 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m03:53:56.703959 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m03:53:56.791052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc4a1670-0732-4775-ba5a-b27075e4e355', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3509ee0>]}
[0m03:53:56.792107 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 1.23s]
[0m03:53:56.793122 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:53:56.794650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:53:56.795135 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m03:53:56.795675 [info ] [MainThread]: 
[0m03:53:56.796186 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m03:53:56.797228 [debug] [MainThread]: Command end result
[0m03:53:56.824410 [info ] [MainThread]: 
[0m03:53:56.824750 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:53:56.825118 [info ] [MainThread]: 
[0m03:53:56.825463 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:53:56.826221 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9788125, "process_user_time": 2.388294, "process_kernel_time": 0.118961, "process_mem_max_rss": "207824", "process_out_blocks": "1904", "process_in_blocks": "0"}
[0m03:53:56.826597 [debug] [MainThread]: Command `dbt run` succeeded at 03:53:56.826510 after 2.98 seconds
[0m03:53:56.826894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f0cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29c3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30c7380>]}
[0m03:53:56.827195 [debug] [MainThread]: Flushing usage events
[0m03:53:58.955358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6006510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5226450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5226390>]}


============================== 03:53:58.958431 | 72918c18-a1e6-4df8-95c8-27aab7ebaeee ==============================
[0m03:53:58.958431 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:53:58.958935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:53:59.318844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72918c18-a1e6-4df8-95c8-27aab7ebaeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f90ce0>]}
[0m03:53:59.337154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72918c18-a1e6-4df8-95c8-27aab7ebaeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f90ce0>]}
[0m03:53:59.337629 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:53:59.374540 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:53:59.419135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:53:59.419424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:53:59.435076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72918c18-a1e6-4df8-95c8-27aab7ebaeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81771d90>]}
[0m03:53:59.480704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72918c18-a1e6-4df8-95c8-27aab7ebaeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813e1880>]}
[0m03:53:59.480998 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:53:59.481413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72918c18-a1e6-4df8-95c8-27aab7ebaeee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b192e0>]}
[0m03:53:59.482105 [info ] [MainThread]: 
[0m03:53:59.482426 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:53:59.483193 [debug] [MainThread]: Command end result
[0m03:53:59.497104 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5764245, "process_user_time": 2.152559, "process_kernel_time": 0.097341, "process_mem_max_rss": "207824", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:53:59.497419 [debug] [MainThread]: Command `dbt test` succeeded at 03:53:59.497369 after 0.58 seconds
[0m03:53:59.497613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6006510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c4da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f92570>]}
[0m03:53:59.497812 [debug] [MainThread]: Flushing usage events
[0m03:54:01.673502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb26e9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4a8adb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb35624b0>]}


============================== 03:54:01.676591 | 86ce3958-5c8a-48c6-bec8-805dd4dba7a6 ==============================
[0m03:54:01.676591 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:01.677098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:02.049749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86ce3958-5c8a-48c6-bec8-805dd4dba7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4046b0>]}
[0m03:54:02.069164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86ce3958-5c8a-48c6-bec8-805dd4dba7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d03d7c0>]}
[0m03:54:02.069623 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:02.106467 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:02.154060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:02.154390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:02.169830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ce3958-5c8a-48c6-bec8-805dd4dba7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ceb1a00>]}
[0m03:54:02.211573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ce3958-5c8a-48c6-bec8-805dd4dba7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca77b60>]}
[0m03:54:02.211847 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:02.212221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ce3958-5c8a-48c6-bec8-805dd4dba7a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa339e300>]}
[0m03:54:02.212956 [info ] [MainThread]: 
[0m03:54:02.213260 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:02.214070 [debug] [MainThread]: Command end result
[0m03:54:02.228272 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5888899, "process_user_time": 2.131825, "process_kernel_time": 0.11793, "process_mem_max_rss": "207832", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:02.228656 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:54:02.228591 after 0.59 seconds
[0m03:54:02.228928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5592e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f02630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1c727b0>]}
[0m03:54:02.229176 [debug] [MainThread]: Flushing usage events
[0m03:54:03.826114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa57d7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa584b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58485c0>]}


============================== 03:54:03.829436 | 7a6a737b-b9f8-4131-bc29-7d406afbefd7 ==============================
[0m03:54:03.829436 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:03.830000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m03:54:04.228195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a6a737b-b9f8-4131-bc29-7d406afbefd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8234eba0>]}
[0m03:54:04.250172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a6a737b-b9f8-4131-bc29-7d406afbefd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d9e870>]}
[0m03:54:04.250735 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:04.294173 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:04.346631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:04.346971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:04.363824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a6a737b-b9f8-4131-bc29-7d406afbefd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa470f1a0>]}
[0m03:54:04.416192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a6a737b-b9f8-4131-bc29-7d406afbefd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8107dfa0>]}
[0m03:54:04.416564 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:04.416970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a6a737b-b9f8-4131-bc29-7d406afbefd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815e1f10>]}
[0m03:54:04.417736 [info ] [MainThread]: 
[0m03:54:04.418017 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:04.418847 [debug] [MainThread]: Command end result
[0m03:54:04.435540 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.64807343, "process_user_time": 2.140437, "process_kernel_time": 0.098526, "process_mem_max_rss": "207784", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:04.435882 [debug] [MainThread]: Command `dbt test` succeeded at 03:54:04.435836 after 0.65 seconds
[0m03:54:04.436125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa57d7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa596bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815acfe0>]}
[0m03:54:04.436365 [debug] [MainThread]: Flushing usage events
[0m03:54:06.920389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69ae0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6af7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b72db0>]}


============================== 03:54:06.923694 | 931825d1-c608-4af8-bc8b-057f6e339840 ==============================
[0m03:54:06.923694 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:06.924260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:07.305072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '931825d1-c608-4af8-bc8b-057f6e339840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f00bfb0>]}
[0m03:54:07.325654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '931825d1-c608-4af8-bc8b-057f6e339840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff995c7020>]}
[0m03:54:07.326239 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:07.367112 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:07.422188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:07.422671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:07.440751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '931825d1-c608-4af8-bc8b-057f6e339840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b27ce0>]}
[0m03:54:07.487356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '931825d1-c608-4af8-bc8b-057f6e339840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee2f710>]}
[0m03:54:07.487702 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:07.488075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '931825d1-c608-4af8-bc8b-057f6e339840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84242480>]}
[0m03:54:07.488827 [info ] [MainThread]: 
[0m03:54:07.489080 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:07.490009 [debug] [MainThread]: Command end result
[0m03:54:07.507182 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.6248207, "process_user_time": 2.116042, "process_kernel_time": 0.106102, "process_mem_max_rss": "207760", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:07.507521 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:54:07.507475 after 0.63 seconds
[0m03:54:07.507725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68ff8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65e09b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7efa7f20>]}
[0m03:54:07.507958 [debug] [MainThread]: Flushing usage events
[0m03:54:10.107345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23cb9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2c5fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23cb530>]}


============================== 03:54:10.110920 | efe572ed-f797-492b-857f-d1a96b83c201 ==============================
[0m03:54:10.110920 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:10.111463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:54:10.552850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efe572ed-f797-492b-857f-d1a96b83c201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd73da0>]}
[0m03:54:10.574789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efe572ed-f797-492b-857f-d1a96b83c201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23cb470>]}
[0m03:54:10.575364 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:10.617702 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:10.670558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:10.670890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:10.688949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efe572ed-f797-492b-857f-d1a96b83c201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac74da0>]}
[0m03:54:10.745374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efe572ed-f797-492b-857f-d1a96b83c201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a29d0d0>]}
[0m03:54:10.745739 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:10.746199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe572ed-f797-492b-857f-d1a96b83c201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a602720>]}
[0m03:54:10.747104 [info ] [MainThread]: 
[0m03:54:10.747531 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:10.748816 [debug] [MainThread]: Command end result
[0m03:54:10.765818 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.70230746, "process_user_time": 2.177602, "process_kernel_time": 0.104982, "process_mem_max_rss": "207828", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:10.766224 [debug] [MainThread]: Command `dbt test` succeeded at 03:54:10.766147 after 0.70 seconds
[0m03:54:10.766479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1ccb9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f03c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5dda60>]}
[0m03:54:10.766709 [debug] [MainThread]: Flushing usage events
[0m03:54:12.727888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed706e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f180650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdfa7e0>]}


============================== 03:54:12.731058 | 767a1cd1-efb4-4bc6-87f6-8b4c572cff19 ==============================
[0m03:54:12.731058 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:12.731594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:13.083643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '767a1cd1-efb4-4bc6-87f6-8b4c572cff19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e75a030>]}
[0m03:54:13.102992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '767a1cd1-efb4-4bc6-87f6-8b4c572cff19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6729a420>]}
[0m03:54:13.103449 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:13.142401 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:13.191162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:13.191440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:13.207228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '767a1cd1-efb4-4bc6-87f6-8b4c572cff19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66fecbf0>]}
[0m03:54:13.250015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '767a1cd1-efb4-4bc6-87f6-8b4c572cff19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66cd3c80>]}
[0m03:54:13.250339 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:13.250789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '767a1cd1-efb4-4bc6-87f6-8b4c572cff19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e759d60>]}
[0m03:54:13.251608 [info ] [MainThread]: 
[0m03:54:13.251964 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:13.252910 [debug] [MainThread]: Command end result
[0m03:54:13.268806 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5753493, "process_user_time": 2.080576, "process_kernel_time": 0.108709, "process_mem_max_rss": "207828", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:13.269148 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:54:13.269100 after 0.58 seconds
[0m03:54:13.269361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff98cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff99220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8edae570>]}
[0m03:54:13.269569 [debug] [MainThread]: Flushing usage events
[0m03:54:17.007287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a165f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a078fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a07a600>]}


============================== 03:54:17.010355 | eaac7ac8-8996-4d2f-aaeb-bc15877296ea ==============================
[0m03:54:17.010355 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:17.010765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m03:54:17.357841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaac7ac8-8996-4d2f-aaeb-bc15877296ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a7a9b20>]}
[0m03:54:17.376258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaac7ac8-8996-4d2f-aaeb-bc15877296ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76165d00>]}
[0m03:54:17.376680 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:17.415659 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:17.462900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:17.463186 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:17.478671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eaac7ac8-8996-4d2f-aaeb-bc15877296ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff769a0bc0>]}
[0m03:54:17.523418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eaac7ac8-8996-4d2f-aaeb-bc15877296ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75b2b350>]}
[0m03:54:17.523725 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:17.523940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eaac7ac8-8996-4d2f-aaeb-bc15877296ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75fc19a0>]}
[0m03:54:17.524638 [info ] [MainThread]: 
[0m03:54:17.525001 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:17.525815 [debug] [MainThread]: Command end result
[0m03:54:17.539100 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5659232, "process_user_time": 2.140134, "process_kernel_time": 0.106608, "process_mem_max_rss": "207828", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:17.539387 [debug] [MainThread]: Command `dbt test` succeeded at 03:54:17.539344 after 0.57 seconds
[0m03:54:17.539590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99587b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75ad9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7625af60>]}
[0m03:54:17.539800 [debug] [MainThread]: Flushing usage events
[0m03:54:20.142617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f1c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9271550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f1e090>]}


============================== 03:54:20.145764 | d5c03200-5636-427b-861b-a979cf0c6f4a ==============================
[0m03:54:20.145764 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:20.146270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m03:54:20.538301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5c03200-5636-427b-861b-a979cf0c6f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9492f1a0>]}
[0m03:54:20.558331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5c03200-5636-427b-861b-a979cf0c6f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96738f0>]}
[0m03:54:20.558846 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:20.602915 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:20.653380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:20.653733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:20.670669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5c03200-5636-427b-861b-a979cf0c6f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944769f0>]}
[0m03:54:20.716733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5c03200-5636-427b-861b-a979cf0c6f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9415fbc0>]}
[0m03:54:20.717070 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:20.717470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c03200-5636-427b-861b-a979cf0c6f4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94131910>]}
[0m03:54:20.718267 [info ] [MainThread]: 
[0m03:54:20.718558 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:20.719429 [debug] [MainThread]: Command end result
[0m03:54:20.735076 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.6272423, "process_user_time": 2.189567, "process_kernel_time": 0.110584, "process_mem_max_rss": "207828", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:20.735446 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:54:20.735395 after 0.63 seconds
[0m03:54:20.735677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e9a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ec7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945d1970>]}
[0m03:54:20.735894 [debug] [MainThread]: Flushing usage events
[0m03:54:21.777317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6438b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb666c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb666d4c0>]}


============================== 03:54:21.780462 | 324badce-c83f-440c-9701-2c7f769c1551 ==============================
[0m03:54:21.780462 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:21.780800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:22.154055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '324badce-c83f-440c-9701-2c7f769c1551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7381d30>]}
[0m03:54:22.173204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '324badce-c83f-440c-9701-2c7f769c1551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5bbe720>]}
[0m03:54:22.173624 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:22.212902 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:22.258433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:22.258722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:22.274518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '324badce-c83f-440c-9701-2c7f769c1551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9465d0>]}
[0m03:54:22.319112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '324badce-c83f-440c-9701-2c7f769c1551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e410da0>]}
[0m03:54:22.319387 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:22.319751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '324badce-c83f-440c-9701-2c7f769c1551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5f3bc0>]}
[0m03:54:22.320437 [info ] [MainThread]: 
[0m03:54:22.320700 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:22.321519 [debug] [MainThread]: Command end result
[0m03:54:22.334640 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.60833627, "process_user_time": 2.176571, "process_kernel_time": 0.098708, "process_mem_max_rss": "207840", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:22.334918 [debug] [MainThread]: Command `dbt test` succeeded at 03:54:22.334877 after 0.61 seconds
[0m03:54:22.335120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb659ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d72d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e945ac0>]}
[0m03:54:22.335325 [debug] [MainThread]: Flushing usage events
[0m03:54:24.939134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03f9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1003530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2c55940>]}


============================== 03:54:24.942252 | e02e2b09-6f2e-48ca-ab0a-172b0f503c58 ==============================
[0m03:54:24.942252 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:24.942781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m03:54:25.297196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e02e2b09-6f2e-48ca-ab0a-172b0f503c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b57950>]}
[0m03:54:25.317603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e02e2b09-6f2e-48ca-ab0a-172b0f503c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cccf380>]}
[0m03:54:25.318217 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:25.362558 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:25.430648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:25.430965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:25.447304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e02e2b09-6f2e-48ca-ab0a-172b0f503c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9a1ca0>]}
[0m03:54:25.491411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e02e2b09-6f2e-48ca-ab0a-172b0f503c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6877a0>]}
[0m03:54:25.491732 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:25.492129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e02e2b09-6f2e-48ca-ab0a-172b0f503c58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6cf0230>]}
[0m03:54:25.492827 [info ] [MainThread]: 
[0m03:54:25.493078 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:25.493928 [debug] [MainThread]: Command end result
[0m03:54:25.507897 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.60635453, "process_user_time": 2.154251, "process_kernel_time": 0.104221, "process_mem_max_rss": "207828", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:25.508226 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:54:25.508163 after 0.61 seconds
[0m03:54:25.508519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03f9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cccc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb002c1a0>]}
[0m03:54:25.508770 [debug] [MainThread]: Flushing usage events
[0m03:54:27.022181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fd4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977c1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977c1a30>]}


============================== 03:54:27.025406 | 7d2ca857-fd29-4f0e-8c98-2fa6ba2a060f ==============================
[0m03:54:27.025406 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:27.025909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:54:27.371190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d2ca857-fd29-4f0e-8c98-2fa6ba2a060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c2f980>]}
[0m03:54:27.390620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d2ca857-fd29-4f0e-8c98-2fa6ba2a060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f8e0d70>]}
[0m03:54:27.391066 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:27.428709 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:27.477899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:27.478187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:27.494404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d2ca857-fd29-4f0e-8c98-2fa6ba2a060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f509e80>]}
[0m03:54:27.541888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d2ca857-fd29-4f0e-8c98-2fa6ba2a060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6efadb80>]}
[0m03:54:27.542208 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:27.542611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d2ca857-fd29-4f0e-8c98-2fa6ba2a060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f509e20>]}
[0m03:54:27.543341 [info ] [MainThread]: 
[0m03:54:27.543626 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:27.544420 [debug] [MainThread]: Command end result
[0m03:54:27.559627 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.57321906, "process_user_time": 2.134496, "process_kernel_time": 0.088144, "process_mem_max_rss": "207848", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:27.559952 [debug] [MainThread]: Command `dbt test` succeeded at 03:54:27.559910 after 0.57 seconds
[0m03:54:27.560142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981c3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c2c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e19730>]}
[0m03:54:27.560321 [debug] [MainThread]: Flushing usage events
[0m03:54:30.133287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804edc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb4f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f930e00>]}


============================== 03:54:30.136366 | c5ea077f-2485-47b2-8744-a131e7e5fc40 ==============================
[0m03:54:30.136366 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:54:30.136899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m03:54:30.522004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5ea077f-2485-47b2-8744-a131e7e5fc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c600620>]}
[0m03:54:30.541971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5ea077f-2485-47b2-8744-a131e7e5fc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fe58d70>]}
[0m03:54:30.542537 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:54:30.582795 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:54:30.636596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:54:30.636994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:54:30.655114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5ea077f-2485-47b2-8744-a131e7e5fc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f95cb00>]}
[0m03:54:30.698524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5ea077f-2485-47b2-8744-a131e7e5fc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57e57890>]}
[0m03:54:30.698836 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:54:30.699218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5ea077f-2485-47b2-8744-a131e7e5fc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d59ad20>]}
[0m03:54:30.699952 [info ] [MainThread]: 
[0m03:54:30.700202 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:54:30.700996 [debug] [MainThread]: Command end result
[0m03:54:30.715177 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.61720455, "process_user_time": 2.156238, "process_kernel_time": 0.093749, "process_mem_max_rss": "207828", "process_out_blocks": "1838", "process_in_blocks": "0"}
[0m03:54:30.715581 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:54:30.715519 after 0.62 seconds
[0m03:54:30.715853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804edc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57e26d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57e274a0>]}
[0m03:54:30.716093 [debug] [MainThread]: Flushing usage events
[0m03:56:48.324982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ecb85f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5fabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f5fb860>]}


============================== 03:56:48.329175 | b773d0a3-7202-4364-9c84-2bd2c0a640a1 ==============================
[0m03:56:48.329175 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:56:48.329746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:56:48.683949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b773d0a3-7202-4364-9c84-2bd2c0a640a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56c0bc20>]}
[0m03:56:48.703127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b773d0a3-7202-4364-9c84-2bd2c0a640a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56dd4fb0>]}
[0m03:56:48.703553 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:56:48.742799 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:56:48.780424 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:56:48.780884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b773d0a3-7202-4364-9c84-2bd2c0a640a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ecb8da0>]}
[0m03:56:49.105635 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'analysis_crypto_currencies' in the 'models' section of file 'models/schema.yml'
[0m03:56:49.164889 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.unique_analysis_crypto_currencies_symbol.41c2819f5c' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m03:56:49.165380 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_symbol.2689d6bf11' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m03:56:49.233653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b773d0a3-7202-4364-9c84-2bd2c0a640a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5664b2f0>]}
[0m03:56:49.276107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b773d0a3-7202-4364-9c84-2bd2c0a640a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56645730>]}
[0m03:56:49.276394 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:56:49.276753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b773d0a3-7202-4364-9c84-2bd2c0a640a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff566736b0>]}
[0m03:56:49.277588 [info ] [MainThread]: 
[0m03:56:49.277931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:56:49.278416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m03:56:49.283959 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m03:56:49.284168 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m03:56:49.284328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:49.699041 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.414 seconds
[0m03:56:49.703158 [debug] [ThreadPool]: On list_dev: Close
[0m03:56:49.815468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m03:56:49.830869 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m03:56:49.831565 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m03:56:49.832012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:50.557580 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.725 seconds
[0m03:56:50.562111 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m03:56:50.666790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b773d0a3-7202-4364-9c84-2bd2c0a640a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff569eccb0>]}
[0m03:56:50.668393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:56:50.670190 [info ] [MainThread]: 
[0m03:56:50.683299 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:56:50.684292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m03:56:50.685192 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:56:50.691749 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m03:56:50.694268 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m03:56:50.695206 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:56:50.695631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m03:56:50.695987 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:56:50.704068 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m03:56:50.705112 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m03:56:50.705602 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:56:50.705967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m03:56:50.706277 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:56:50.709990 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m03:56:50.710762 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m03:56:50.711228 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:56:50.711536 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m03:56:50.712060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m03:56:50.712270 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:56:50.715928 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:56:50.716623 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:56:50.731614 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:56:50.733572 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m03:56:50.733891 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH  __dbt__cte__stg_bitcoin_price as (
WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
),  __dbt__cte__fact_bitcoin_daily_with_sma as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
),  __dbt__cte__fact_bitcoin_daily_with_rsi as (
WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM __dbt__cte__stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
), sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM __dbt__cte__fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM __dbt__cte__fact_bitcoin_daily_with_rsi
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count
FROM sma
JOIN rsi
ON sma.symbol = rsi.symbol AND sma.date = rsi.date
        );
[0m03:56:50.734261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:51.890336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.155 seconds
[0m03:56:51.913632 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m03:56:51.997592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b773d0a3-7202-4364-9c84-2bd2c0a640a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ecba060>]}
[0m03:56:51.998392 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 1.28s]
[0m03:56:51.999263 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m03:56:52.000447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:52.000792 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m03:56:52.001127 [info ] [MainThread]: 
[0m03:56:52.001617 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m03:56:52.002227 [debug] [MainThread]: Command end result
[0m03:56:52.035566 [info ] [MainThread]: 
[0m03:56:52.036143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:56:52.036548 [info ] [MainThread]: 
[0m03:56:52.036920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:56:52.037601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7468877, "process_user_time": 2.789597, "process_kernel_time": 0.12037, "process_mem_max_rss": "209204", "process_out_blocks": "2824", "process_in_blocks": "0"}
[0m03:56:52.038001 [debug] [MainThread]: Command `dbt run` succeeded at 03:56:52.037953 after 3.75 seconds
[0m03:56:52.038301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f80d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e558dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4ae030>]}
[0m03:56:52.038605 [debug] [MainThread]: Flushing usage events
[0m03:56:54.196719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e7a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98011310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98011df0>]}


============================== 03:56:54.200016 | 12a6bbc7-0bd6-4dce-ab07-0499e561a35e ==============================
[0m03:56:54.200016 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:56:54.200555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:56:54.552966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12a6bbc7-0bd6-4dce-ab07-0499e561a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9747f590>]}
[0m03:56:54.572670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12a6bbc7-0bd6-4dce-ab07-0499e561a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a11a480>]}
[0m03:56:54.573193 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:56:54.614552 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:56:54.679011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:56:54.679332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:56:54.695277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12a6bbc7-0bd6-4dce-ab07-0499e561a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd428a0>]}
[0m03:56:54.742879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12a6bbc7-0bd6-4dce-ab07-0499e561a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7568ee10>]}
[0m03:56:54.743211 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:56:54.743689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a6bbc7-0bd6-4dce-ab07-0499e561a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd41f10>]}
[0m03:56:54.744480 [info ] [MainThread]: 
[0m03:56:54.744760 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:56:54.745542 [debug] [MainThread]: Command end result
[0m03:56:54.759898 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6011324, "process_user_time": 2.178232, "process_kernel_time": 0.087727, "process_mem_max_rss": "207824", "process_out_blocks": "1839", "process_in_blocks": "0"}
[0m03:56:54.760237 [debug] [MainThread]: Command `dbt test` succeeded at 03:56:54.760177 after 0.60 seconds
[0m03:56:54.760489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e79b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd14470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff748a89b0>]}
[0m03:56:54.760696 [debug] [MainThread]: Flushing usage events
[0m03:56:56.986663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12a5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae644c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb02e9700>]}


============================== 03:56:56.989874 | 738cff8f-fce4-43b8-8834-a9111a21b329 ==============================
[0m03:56:56.989874 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:56:56.990388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:56:57.332817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '738cff8f-fce4-43b8-8834-a9111a21b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90180ce0>]}
[0m03:56:57.351950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '738cff8f-fce4-43b8-8834-a9111a21b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c8d6d0>]}
[0m03:56:57.352354 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:56:57.392334 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:56:57.439189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:56:57.439462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:56:57.455172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '738cff8f-fce4-43b8-8834-a9111a21b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86adb6b0>]}
[0m03:56:57.497483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '738cff8f-fce4-43b8-8834-a9111a21b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866478f0>]}
[0m03:56:57.497776 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m03:56:57.498167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '738cff8f-fce4-43b8-8834-a9111a21b329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8671c7a0>]}
[0m03:56:57.498878 [info ] [MainThread]: 
[0m03:56:57.499136 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m03:56:57.499895 [debug] [MainThread]: Command end result
[0m03:56:57.515501 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5628368, "process_user_time": 2.120985, "process_kernel_time": 0.07689, "process_mem_max_rss": "207836", "process_out_blocks": "1839", "process_in_blocks": "0"}
[0m03:56:57.515825 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:56:57.515772 after 0.56 seconds
[0m03:56:57.516033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb8cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869612e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869616d0>]}
[0m03:56:57.516210 [debug] [MainThread]: Flushing usage events
[0m04:03:06.117175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f71e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efbcbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efc20f0>]}


============================== 04:03:06.121544 | 603245a1-e627-4d01-9c93-c6e42ad7df3c ==============================
[0m04:03:06.121544 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:03:06.121924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:03:06.495843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff675ff3b0>]}
[0m04:03:06.514761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff05eb0>]}
[0m04:03:06.515180 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:03:06.554244 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:03:06.590059 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:03:06.590443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6728f800>]}
[0m04:03:06.920760 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'analysis_crypto_currencies' in the 'models' section of file 'models/schema.yml'
[0m04:03:06.975805 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.unique_analysis_crypto_currencies_symbol.41c2819f5c' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m04:03:06.976255 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_symbol.2689d6bf11' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m04:03:07.068150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff671fa240>]}
[0m04:03:07.108604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6721b5c0>]}
[0m04:03:07.108896 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m04:03:07.109298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67040560>]}
[0m04:03:07.110067 [info ] [MainThread]: 
[0m04:03:07.110450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:03:07.112193 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:03:07.117456 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:03:07.117662 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:03:07.117813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:03:07.585246 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.467 seconds
[0m04:03:07.589694 [debug] [ThreadPool]: On list_dev: Close
[0m04:03:07.683357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:03:07.699761 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:03:07.700458 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:03:07.700944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:03:08.111891 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.411 seconds
[0m04:03:08.116024 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:03:08.210661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6714c290>]}
[0m04:03:08.212306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:03:08.214259 [info ] [MainThread]: 
[0m04:03:08.228421 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:03:08.229480 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m04:03:08.231024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m04:03:08.231586 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:03:08.238185 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m04:03:08.240506 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:03:08.258648 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m04:03:08.260039 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m04:03:08.260289 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m04:03:08.260570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:03:08.929399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m04:03:08.953770 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m04:03:09.092179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677d47a0>]}
[0m04:03:09.093424 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 0.86s]
[0m04:03:09.094909 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:03:09.096218 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:03:09.096869 [info ] [Thread-1 (]: 2 of 4 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m04:03:09.097774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m04:03:09.098367 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:03:09.101717 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m04:03:09.103082 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:03:09.106898 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m04:03:09.108832 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m04:03:09.109213 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m04:03:09.109585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:03:09.814645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.705 seconds
[0m04:03:09.819107 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m04:03:09.946302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff669fe750>]}
[0m04:03:09.948314 [info ] [Thread-1 (]: 2 of 4 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 0.85s]
[0m04:03:09.950766 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:03:09.951777 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:03:09.952714 [info ] [Thread-1 (]: 3 of 4 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m04:03:09.953840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m04:03:09.954470 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:03:09.959626 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m04:03:09.961833 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:03:09.965394 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m04:03:09.967498 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m04:03:09.967987 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m04:03:09.968430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:03:10.669065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m04:03:10.671913 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m04:03:10.777735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f71f770>]}
[0m04:03:10.779545 [info ] [Thread-1 (]: 3 of 4 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.82s]
[0m04:03:10.781195 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:03:10.782714 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:03:10.783855 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m04:03:10.785074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m04:03:10.785643 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:03:10.789252 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m04:03:10.790765 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:03:10.807283 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m04:03:10.808673 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m04:03:10.809006 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count
FROM sma
JOIN rsi
ON sma.symbol = rsi.symbol AND sma.date = rsi.date
        );
[0m04:03:10.809307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:03:12.103286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.293 seconds
[0m04:03:12.112238 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m04:03:12.201945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '603245a1-e627-4d01-9c93-c6e42ad7df3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff669e5160>]}
[0m04:03:12.202632 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 1.42s]
[0m04:03:12.203352 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:03:12.204501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:03:12.204828 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m04:03:12.205212 [info ] [MainThread]: 
[0m04:03:12.205553 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m04:03:12.206493 [debug] [MainThread]: Command end result
[0m04:03:12.230733 [info ] [MainThread]: 
[0m04:03:12.231082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:03:12.231492 [info ] [MainThread]: 
[0m04:03:12.231870 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:03:12.232589 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1513867, "process_user_time": 2.97482, "process_kernel_time": 0.179072, "process_mem_max_rss": "209684", "process_out_blocks": "2819", "process_in_blocks": "0"}
[0m04:03:12.233000 [debug] [MainThread]: Command `dbt run` succeeded at 04:03:12.232941 after 6.15 seconds
[0m04:03:12.233268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebd7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff670ce7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebf5f70>]}
[0m04:03:12.233508 [debug] [MainThread]: Flushing usage events
[0m04:03:14.505821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4c751c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2376360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23fa0f0>]}


============================== 04:03:14.509280 | 0338318f-a5ca-4230-be5e-5628aecdb7ff ==============================
[0m04:03:14.509280 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:03:14.509962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m04:03:14.884518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0338318f-a5ca-4230-be5e-5628aecdb7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aac4950>]}
[0m04:03:14.902991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0338318f-a5ca-4230-be5e-5628aecdb7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa41580>]}
[0m04:03:14.903429 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:03:14.942730 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:03:14.989951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:03:14.990269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:03:15.005912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0338318f-a5ca-4230-be5e-5628aecdb7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a971010>]}
[0m04:03:15.053658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0338318f-a5ca-4230-be5e-5628aecdb7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a409190>]}
[0m04:03:15.054011 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m04:03:15.054439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0338318f-a5ca-4230-be5e-5628aecdb7ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6cf9b0>]}
[0m04:03:15.055191 [info ] [MainThread]: 
[0m04:03:15.055520 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:03:15.056385 [debug] [MainThread]: Command end result
[0m04:03:15.071952 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5998425, "process_user_time": 2.11214, "process_kernel_time": 0.09696, "process_mem_max_rss": "207824", "process_out_blocks": "1839", "process_in_blocks": "0"}
[0m04:03:15.072269 [debug] [MainThread]: Command `dbt test` succeeded at 04:03:15.072219 after 0.60 seconds
[0m04:03:15.072500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa262b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4235be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d88bf0>]}
[0m04:03:15.072728 [debug] [MainThread]: Flushing usage events
[0m04:03:17.428052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa377ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ae99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa300f5f0>]}


============================== 04:03:17.431241 | 58de834b-4072-4b94-83de-d613a8894d48 ==============================
[0m04:03:17.431241 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:03:17.431769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m04:03:17.767923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58de834b-4072-4b94-83de-d613a8894d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927f0ce0>]}
[0m04:03:17.788116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58de834b-4072-4b94-83de-d613a8894d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17d6720>]}
[0m04:03:17.788696 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:03:17.828544 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:03:17.876548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:03:17.876838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:03:17.892662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58de834b-4072-4b94-83de-d613a8894d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7faf69c0>]}
[0m04:03:17.935074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58de834b-4072-4b94-83de-d613a8894d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dddb920>]}
[0m04:03:17.935355 [info ] [MainThread]: Found 4 models, 2 sources, 459 macros
[0m04:03:17.935752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58de834b-4072-4b94-83de-d613a8894d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17d5a30>]}
[0m04:03:17.936488 [info ] [MainThread]: 
[0m04:03:17.936746 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:03:17.937595 [debug] [MainThread]: Command end result
[0m04:03:17.952636 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5588892, "process_user_time": 2.109063, "process_kernel_time": 0.089874, "process_mem_max_rss": "207832", "process_out_blocks": "1839", "process_in_blocks": "0"}
[0m04:03:17.952927 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:03:17.952884 after 0.56 seconds
[0m04:03:17.953122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23dacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa620a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2473260>]}
[0m04:03:17.953331 [debug] [MainThread]: Flushing usage events
[0m04:30:22.841268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39d3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6051610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39d1a90>]}


============================== 04:30:22.847776 | 66e11664-464b-47b6-b9af-9305b204f2de ==============================
[0m04:30:22.847776 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:30:22.848444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:30:23.243395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be27860>]}
[0m04:30:23.263560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44f75c0>]}
[0m04:30:23.264208 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:30:23.306893 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:30:23.364851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m04:30:23.365348 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://models/input/fact_bitcoin_price_momentum.sql
[0m04:30:23.365652 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/output/stg_bitcoin_daily_metrics.sql
[0m04:30:23.456730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b845c70>]}
[0m04:30:23.498811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b187950>]}
[0m04:30:23.499105 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m04:30:23.499458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4ddd60>]}
[0m04:30:23.500235 [info ] [MainThread]: 
[0m04:30:23.500591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:30:23.502562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:30:23.508136 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:30:23.508347 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:30:23.508499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:23.915287 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.407 seconds
[0m04:30:23.917815 [debug] [ThreadPool]: On list_dev: Close
[0m04:30:24.006007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:30:24.020490 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:30:24.021198 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:30:24.021739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:30:24.549799 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.528 seconds
[0m04:30:24.555278 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:30:24.658317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5c1550>]}
[0m04:30:24.660024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:30:24.661679 [info ] [MainThread]: 
[0m04:30:24.674472 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:30:24.675242 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m04:30:24.676133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m04:30:24.676570 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:30:24.683594 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m04:30:24.686177 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:30:24.702732 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m04:30:24.704373 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m04:30:24.704698 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m04:30:24.704970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:30:25.368555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m04:30:25.397539 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m04:30:25.500835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bad4290>]}
[0m04:30:25.501523 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 0.82s]
[0m04:30:25.502261 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:30:25.503003 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:30:25.503333 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m04:30:25.503750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m04:30:25.504020 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:30:25.505677 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m04:30:25.506529 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:30:25.507958 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m04:30:25.509238 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m04:30:25.509549 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m04:30:25.509857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:30:26.152393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m04:30:26.157247 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m04:30:26.267021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b86a180>]}
[0m04:30:26.269103 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 0.76s]
[0m04:30:26.271398 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:30:26.272342 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:30:26.273248 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m04:30:26.274504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m04:30:26.275083 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:30:26.278638 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m04:30:26.281256 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:30:26.283479 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m04:30:26.285391 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m04:30:26.285835 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m04:30:26.286315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:30:26.954744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.668 seconds
[0m04:30:26.958060 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m04:30:27.063260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a540bc0>]}
[0m04:30:27.065972 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.79s]
[0m04:30:27.068578 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:30:27.069654 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m04:30:27.071080 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.fact_bitcoin_price_momentum .............. [RUN]
[0m04:30:27.072317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.fact_bitcoin_price_momentum)
[0m04:30:27.073334 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m04:30:27.079230 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m04:30:27.080963 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m04:30:27.083503 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m04:30:27.085590 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m04:30:27.086065 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_price_momentum"} */
create or replace   view dev.analytics.fact_bitcoin_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) AS price_close_14d_ago
    FROM dev.analytics.stg_bitcoin_price
)
, momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_14d_ago,
        -- Calculate the price momentum as percentage change over 14 days
        CASE 
            WHEN price_close_14d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_14d_ago) / price_close_14d_ago) * 100
        END AS price_momentum_14d
    FROM base
)
SELECT
    symbol,
    date,
    price_close,
    price_momentum_14d
FROM momentum_calc
ORDER BY symbol, date;
[0m04:30:27.086505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:30:27.546572 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85bae-0004-2ced-0000-00027873f6ad
[0m04:30:27.548223 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 21 unexpected ';'.
[0m04:30:27.549631 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: Close
[0m04:30:27.650766 [debug] [Thread-1 (]: Database Error in model fact_bitcoin_price_momentum (models/input/fact_bitcoin_price_momentum.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 21 unexpected ';'.
  compiled code at target/run/crypto_currencies_elt/models/input/fact_bitcoin_price_momentum.sql
[0m04:30:27.652552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a932d80>]}
[0m04:30:27.654254 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model analytics.fact_bitcoin_price_momentum ..... [[31mERROR[0m in 0.58s]
[0m04:30:27.655850 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m04:30:27.656591 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:30:27.658159 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m04:30:27.659157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_price_momentum, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m04:30:27.659730 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:30:27.663727 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m04:30:27.665753 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:30:27.681637 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m04:30:27.683482 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m04:30:27.683849 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

momentum AS (
    SELECT
        symbol,
        date,
        -- Calculate price momentum as percentage change over 14 days
        CASE 
            WHEN LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) IS NULL THEN NULL
            ELSE ((price_close - LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) / LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) * 100
        END AS price_momentum_14d
    FROM dev.analytics.stg_bitcoin_price
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    momentum.price_momentum_14d
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN momentum ON sma.symbol = momentum.symbol AND sma.date = momentum.date;
[0m04:30:27.684209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:30:28.027002 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85bae-0004-2ce7-0002-7873000166be
[0m04:30:28.028905 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 74 unexpected ';'.
[0m04:30:28.030605 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m04:30:28.127229 [debug] [Thread-1 (]: Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 74 unexpected ';'.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m04:30:28.129579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66e11664-464b-47b6-b9af-9305b204f2de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5638c0>]}
[0m04:30:28.131632 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model analytics.stg_bitcoin_daily_metrics ...... [[31mERROR[0m in 0.47s]
[0m04:30:28.133281 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:30:28.135394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:30:28.136067 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m04:30:28.136766 [info ] [MainThread]: 
[0m04:30:28.137745 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m04:30:28.138903 [debug] [MainThread]: Command end result
[0m04:30:28.167593 [info ] [MainThread]: 
[0m04:30:28.168175 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:30:28.168544 [info ] [MainThread]: 
[0m04:30:28.168975 [error] [MainThread]:   Database Error in model fact_bitcoin_price_momentum (models/input/fact_bitcoin_price_momentum.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 21 unexpected ';'.
  compiled code at target/run/crypto_currencies_elt/models/input/fact_bitcoin_price_momentum.sql
[0m04:30:28.169244 [info ] [MainThread]: 
[0m04:30:28.169503 [error] [MainThread]:   Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 74 unexpected ';'.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m04:30:28.169751 [info ] [MainThread]: 
[0m04:30:28.170044 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m04:30:28.170729 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.382485, "process_user_time": 2.693598, "process_kernel_time": 0.19369, "process_mem_max_rss": "209776", "process_out_blocks": "2862", "command_success": false, "process_in_blocks": "0"}
[0m04:30:28.171050 [debug] [MainThread]: Command `dbt run` failed at 04:30:28.170999 after 5.38 seconds
[0m04:30:28.171301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41677a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6a0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b53fbc0>]}
[0m04:30:28.171530 [debug] [MainThread]: Flushing usage events
[0m04:31:29.696975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846d98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84087ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846db770>]}


============================== 04:31:29.700536 | 51e391d4-537e-4f73-a16d-3858d89e9c67 ==============================
[0m04:31:29.700536 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:31:29.701043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:31:30.065169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60a698b0>]}
[0m04:31:30.084237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60985be0>]}
[0m04:31:30.084681 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:31:30.124494 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:31:30.175169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m04:31:30.175585 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/input/fact_bitcoin_price_momentum.sql
[0m04:31:30.175880 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/output/stg_bitcoin_daily_metrics.sql
[0m04:31:30.262572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff601b8da0>]}
[0m04:31:30.309919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff603462d0>]}
[0m04:31:30.310376 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m04:31:30.310867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60368380>]}
[0m04:31:30.311743 [info ] [MainThread]: 
[0m04:31:30.312234 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:31:30.314351 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m04:31:30.320185 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m04:31:30.320404 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m04:31:30.320599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:30.776373 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.455 seconds
[0m04:31:30.780787 [debug] [ThreadPool]: On list_dev: Close
[0m04:31:30.878490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m04:31:30.893339 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m04:31:30.894101 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m04:31:30.894561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:31:31.327030 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.432 seconds
[0m04:31:31.332581 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m04:31:31.478315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60660950>]}
[0m04:31:31.480158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:31:31.481911 [info ] [MainThread]: 
[0m04:31:31.495311 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:31:31.496169 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m04:31:31.497203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m04:31:31.497819 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:31:31.505154 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m04:31:31.506756 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:31:31.525132 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m04:31:31.526720 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m04:31:31.527002 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m04:31:31.527291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:32.138422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m04:31:32.165790 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m04:31:32.250172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bf0b050>]}
[0m04:31:32.251616 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 0.75s]
[0m04:31:32.253248 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m04:31:32.254971 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:31:32.256136 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m04:31:32.257290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m04:31:32.257930 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:31:32.261251 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m04:31:32.263103 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:31:32.265506 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m04:31:32.267641 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m04:31:32.268110 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m04:31:32.268530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:32.892645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m04:31:32.893926 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m04:31:32.983398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bb32fc0>]}
[0m04:31:32.984175 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 0.73s]
[0m04:31:32.985129 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m04:31:32.985704 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:31:32.986234 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m04:31:32.986831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m04:31:32.987207 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:31:32.989489 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m04:31:32.991639 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:31:32.993355 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m04:31:32.994608 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m04:31:32.994957 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m04:31:32.995278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:33.772834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m04:31:33.778349 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m04:31:33.869536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bb0c2f0>]}
[0m04:31:33.875599 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.88s]
[0m04:31:33.877496 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m04:31:33.879299 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m04:31:33.882642 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.fact_bitcoin_price_momentum .............. [RUN]
[0m04:31:33.885701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.fact_bitcoin_price_momentum)
[0m04:31:33.886784 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m04:31:33.894162 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m04:31:33.896452 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m04:31:33.898784 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m04:31:33.900368 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m04:31:33.900793 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_price_momentum"} */
create or replace   view dev.analytics.fact_bitcoin_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) AS price_close_14d_ago
    FROM dev.analytics.stg_bitcoin_price
)
, momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_14d_ago,
        -- Calculate the price momentum as percentage change over 14 days
        CASE 
            WHEN price_close_14d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_14d_ago) / price_close_14d_ago) * 100
        END AS price_momentum_14d
    FROM base
)
SELECT
    symbol,
    date,
    price_close,
    price_momentum_14d
FROM momentum_calc
ORDER BY symbol, date
  );
[0m04:31:33.901211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:34.590195 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m04:31:34.593529 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: Close
[0m04:31:34.707723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bb10320>]}
[0m04:31:34.709200 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.fact_bitcoin_price_momentum ......... [[32mSUCCESS 1[0m in 0.82s]
[0m04:31:34.710552 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m04:31:34.711160 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:31:34.711796 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m04:31:34.712666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_price_momentum, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m04:31:34.713171 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:31:34.717094 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m04:31:34.718348 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:31:34.734508 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m04:31:34.736427 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m04:31:34.736886 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

momentum AS (
    SELECT
        symbol,
        date,
        -- Calculate price momentum as percentage change over 14 days
        CASE 
            WHEN LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) IS NULL THEN NULL
            ELSE ((price_close - LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) / LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) * 100
        END AS price_momentum_14d
    FROM dev.analytics.stg_bitcoin_price
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    momentum.price_momentum_14d
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN momentum ON sma.symbol = momentum.symbol AND sma.date = momentum.date
        );
[0m04:31:34.737312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:31:36.720092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.982 seconds
[0m04:31:36.729228 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m04:31:36.861742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e391d4-537e-4f73-a16d-3858d89e9c67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff601d4050>]}
[0m04:31:36.864062 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 2.15s]
[0m04:31:36.867151 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m04:31:36.870099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:36.870765 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m04:31:36.871482 [info ] [MainThread]: 
[0m04:31:36.872444 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m04:31:36.874021 [debug] [MainThread]: Command end result
[0m04:31:36.912976 [info ] [MainThread]: 
[0m04:31:36.913580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:31:36.913920 [info ] [MainThread]: 
[0m04:31:36.914268 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m04:31:36.915356 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2536526, "process_user_time": 2.678493, "process_kernel_time": 0.137642, "process_mem_max_rss": "208860", "process_out_blocks": "2858", "process_in_blocks": "0"}
[0m04:31:36.915882 [debug] [MainThread]: Command `dbt run` succeeded at 04:31:36.915799 after 7.25 seconds
[0m04:31:36.916296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84087ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60d90e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83fdb2f0>]}
[0m04:31:36.916603 [debug] [MainThread]: Flushing usage events
[0m04:31:39.718305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2de7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8128a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb7df70>]}


============================== 04:31:39.721467 | 0f17be41-fc11-4ee7-8864-7ef814abcbba ==============================
[0m04:31:39.721467 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:31:39.721977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:31:40.103536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f17be41-fc11-4ee7-8864-7ef814abcbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff696e7f20>]}
[0m04:31:40.122612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f17be41-fc11-4ee7-8864-7ef814abcbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889cabd0>]}
[0m04:31:40.123136 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:31:40.162660 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:31:40.212980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:40.213296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:40.225495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f17be41-fc11-4ee7-8864-7ef814abcbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff691c7230>]}
[0m04:31:40.280003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f17be41-fc11-4ee7-8864-7ef814abcbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff690f0140>]}
[0m04:31:40.280345 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m04:31:40.280838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f17be41-fc11-4ee7-8864-7ef814abcbba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69257800>]}
[0m04:31:40.281808 [info ] [MainThread]: 
[0m04:31:40.282197 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:31:40.283265 [debug] [MainThread]: Command end result
[0m04:31:40.301233 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.61779433, "process_user_time": 2.113421, "process_kernel_time": 0.117356, "process_mem_max_rss": "207828", "process_out_blocks": "1853", "process_in_blocks": "0"}
[0m04:31:40.301610 [debug] [MainThread]: Command `dbt test` succeeded at 04:31:40.301559 after 0.62 seconds
[0m04:31:40.301851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9120aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a8c8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff690f16a0>]}
[0m04:31:40.302088 [debug] [MainThread]: Flushing usage events
[0m04:31:43.062688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5bbd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ca1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ca2420>]}


============================== 04:31:43.066029 | f15e184f-169c-480a-aedc-93fa2bb74d8d ==============================
[0m04:31:43.066029 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:31:43.066680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:31:43.103834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc9f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac0c8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc9fc50>]}


============================== 04:31:43.107474 | d53e81df-7d71-477e-8e8f-f9b02cf86e1b ==============================
[0m04:31:43.107474 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:31:43.107974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:31:43.518306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f15e184f-169c-480a-aedc-93fa2bb74d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b07b60>]}
[0m04:31:43.541454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f15e184f-169c-480a-aedc-93fa2bb74d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d084d0>]}
[0m04:31:43.542003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd53e81df-7d71-477e-8e8f-f9b02cf86e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886ebe60>]}
[0m04:31:43.542524 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:31:43.568003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd53e81df-7d71-477e-8e8f-f9b02cf86e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd5f950>]}
[0m04:31:43.568573 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:31:43.592674 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:31:43.614242 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:31:43.652441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:43.652754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:43.665478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f15e184f-169c-480a-aedc-93fa2bb74d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5303c80>]}
[0m04:31:43.681700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:43.681991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:43.694677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd53e81df-7d71-477e-8e8f-f9b02cf86e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8858e930>]}
[0m04:31:43.748011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f15e184f-169c-480a-aedc-93fa2bb74d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914d1be0>]}
[0m04:31:43.748470 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m04:31:43.748948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f15e184f-169c-480a-aedc-93fa2bb74d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89d9fd0>]}
[0m04:31:43.749781 [info ] [MainThread]: 
[0m04:31:43.750030 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:31:43.750917 [debug] [MainThread]: Command end result
[0m04:31:43.762607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd53e81df-7d71-477e-8e8f-f9b02cf86e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88570080>]}
[0m04:31:43.762979 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m04:31:43.763337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd53e81df-7d71-477e-8e8f-f9b02cf86e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabcb8ad0>]}
[0m04:31:43.764137 [info ] [MainThread]: 
[0m04:31:43.764479 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:31:43.765381 [debug] [MainThread]: Command end result
[0m04:31:43.776632 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.75300074, "process_user_time": 1.953681, "process_kernel_time": 0.135363, "process_mem_max_rss": "207832", "process_out_blocks": "1853", "process_in_blocks": "0"}
[0m04:31:43.777231 [debug] [MainThread]: Command `dbt test` succeeded at 04:31:43.777172 after 0.75 seconds
[0m04:31:43.777689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a30140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9171fa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b091c0>]}
[0m04:31:43.778084 [debug] [MainThread]: Flushing usage events
[0m04:31:43.788646 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.72582865, "process_user_time": 1.960265, "process_kernel_time": 0.131892, "process_mem_max_rss": "207860", "process_out_blocks": "1853", "process_in_blocks": "0"}
[0m04:31:43.788939 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:31:43.788897 after 0.73 seconds
[0m04:31:43.789155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac495a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884bacc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a13c80>]}
[0m04:31:43.789369 [debug] [MainThread]: Flushing usage events
[0m04:31:45.717391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad42f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad4b4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad42d580>]}


============================== 04:31:45.720610 | 3c7114cc-25bb-4569-9fbc-764c52ce99b0 ==============================
[0m04:31:45.720610 [info ] [MainThread]: Running with dbt=1.8.7
[0m04:31:45.721115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:31:46.070459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c7114cc-25bb-4569-9fbc-764c52ce99b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae427cb0>]}
[0m04:31:46.088896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c7114cc-25bb-4569-9fbc-764c52ce99b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897213d0>]}
[0m04:31:46.089342 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m04:31:46.131063 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m04:31:46.179261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:31:46.179556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:31:46.191805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c7114cc-25bb-4569-9fbc-764c52ce99b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893cf170>]}
[0m04:31:46.238279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c7114cc-25bb-4569-9fbc-764c52ce99b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8902bbf0>]}
[0m04:31:46.238578 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m04:31:46.238923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c7114cc-25bb-4569-9fbc-764c52ce99b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaccd2120>]}
[0m04:31:46.239614 [info ] [MainThread]: 
[0m04:31:46.239880 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:31:46.240685 [debug] [MainThread]: Command end result
[0m04:31:46.255136 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5723157, "process_user_time": 2.098352, "process_kernel_time": 0.104116, "process_mem_max_rss": "207832", "process_out_blocks": "1853", "process_in_blocks": "0"}
[0m04:31:46.255545 [debug] [MainThread]: Command `dbt snapshot` succeeded at 04:31:46.255468 after 0.57 seconds
[0m04:31:46.255856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb1fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5c6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f50e60>]}
[0m04:31:46.256109 [debug] [MainThread]: Flushing usage events
[0m21:04:13.504270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b019d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f553950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90610cb0>]}


============================== 21:04:13.507755 | 6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98 ==============================
[0m21:04:13.507755 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:04:13.508416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:04:13.865470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e990ce0>]}
[0m21:04:13.884567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67f6e960>]}
[0m21:04:13.885066 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:04:13.926719 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:04:13.981714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:13.982032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:13.994707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a71eb0>]}
[0m21:04:14.043137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67604d70>]}
[0m21:04:14.043436 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m21:04:14.043847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67835a30>]}
[0m21:04:14.044709 [info ] [MainThread]: 
[0m21:04:14.045131 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:04:14.047037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m21:04:14.053464 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m21:04:14.053691 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m21:04:14.053872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:14.593418 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.539 seconds
[0m21:04:14.598854 [debug] [ThreadPool]: On list_dev: Close
[0m21:04:14.783119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m21:04:14.798306 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m21:04:14.799153 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m21:04:14.799644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:15.400528 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.601 seconds
[0m21:04:15.404779 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m21:04:15.553543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef741a0>]}
[0m21:04:15.554911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:04:15.556147 [info ] [MainThread]: 
[0m21:04:15.568026 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m21:04:15.568684 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m21:04:15.569430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m21:04:15.569945 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m21:04:15.575828 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m21:04:15.578619 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m21:04:15.595264 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m21:04:15.597266 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m21:04:15.597564 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m21:04:15.597835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:16.640045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.042 seconds
[0m21:04:16.667737 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m21:04:16.815223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fa7a000>]}
[0m21:04:16.817221 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 1.24s]
[0m21:04:16.819018 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m21:04:16.820572 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m21:04:16.821447 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m21:04:16.822515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m21:04:16.823088 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m21:04:16.827559 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m21:04:16.828983 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m21:04:16.831518 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m21:04:16.833377 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m21:04:16.833947 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m21:04:16.834512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:17.852083 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.017 seconds
[0m21:04:17.857659 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m21:04:17.983727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66bc02f0>]}
[0m21:04:17.986105 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 1.16s]
[0m21:04:17.988559 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m21:04:17.989738 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m21:04:17.990902 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m21:04:17.992245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m21:04:17.993154 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m21:04:17.998676 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m21:04:18.001980 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m21:04:18.004912 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m21:04:18.007261 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m21:04:18.007827 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m21:04:18.008281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:18.800572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.792 seconds
[0m21:04:18.805618 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m21:04:18.954948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67604140>]}
[0m21:04:18.957354 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.96s]
[0m21:04:18.960067 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m21:04:18.961215 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m21:04:18.962703 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.fact_bitcoin_price_momentum .............. [RUN]
[0m21:04:18.964114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.fact_bitcoin_price_momentum)
[0m21:04:18.964864 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m21:04:18.970192 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m21:04:18.973670 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m21:04:18.976508 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m21:04:18.978656 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m21:04:18.979178 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_price_momentum"} */
create or replace   view dev.analytics.fact_bitcoin_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) AS price_close_14d_ago
    FROM dev.analytics.stg_bitcoin_price
)
, momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_14d_ago,
        -- Calculate the price momentum as percentage change over 14 days
        CASE 
            WHEN price_close_14d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_14d_ago) / price_close_14d_ago) * 100
        END AS price_momentum_14d
    FROM base
)
SELECT
    symbol,
    date,
    price_close,
    price_momentum_14d
FROM momentum_calc
ORDER BY symbol, date
  );
[0m21:04:18.979588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:19.746580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m21:04:19.749072 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: Close
[0m21:04:19.887496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66a13b90>]}
[0m21:04:19.889795 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.fact_bitcoin_price_momentum ......... [[32mSUCCESS 1[0m in 0.92s]
[0m21:04:19.892244 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m21:04:19.893650 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m21:04:19.894669 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m21:04:19.896342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_price_momentum, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m21:04:19.897075 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m21:04:19.902008 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m21:04:19.904141 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m21:04:19.921669 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m21:04:19.923767 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m21:04:19.924187 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

momentum AS (
    SELECT
        symbol,
        date,
        -- Calculate price momentum as percentage change over 14 days
        CASE 
            WHEN LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) IS NULL THEN NULL
            ELSE ((price_close - LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) / LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) * 100
        END AS price_momentum_14d
    FROM dev.analytics.stg_bitcoin_price
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    momentum.price_momentum_14d
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN momentum ON sma.symbol = momentum.symbol AND sma.date = momentum.date
        );
[0m21:04:19.924635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:21.345645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.421 seconds
[0m21:04:21.347384 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m21:04:21.470258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ab8b08b-f31c-44a0-91fd-3c9a6b2aae98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66932ae0>]}
[0m21:04:21.470865 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 1.57s]
[0m21:04:21.471590 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m21:04:21.472723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:21.472991 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m21:04:21.473244 [info ] [MainThread]: 
[0m21:04:21.473600 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.43 seconds (7.43s).
[0m21:04:21.474379 [debug] [MainThread]: Command end result
[0m21:04:21.492392 [info ] [MainThread]: 
[0m21:04:21.492739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:04:21.493084 [info ] [MainThread]: 
[0m21:04:21.493331 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:04:21.494069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.02786, "process_user_time": 2.662059, "process_kernel_time": 0.166692, "process_mem_max_rss": "208232", "process_out_blocks": "1933", "process_in_blocks": "0"}
[0m21:04:21.494410 [debug] [MainThread]: Command `dbt run` succeeded at 21:04:21.494351 after 8.03 seconds
[0m21:04:21.494632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f43a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea23e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90610cb0>]}
[0m21:04:21.494889 [debug] [MainThread]: Flushing usage events
[0m21:04:24.480316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db02330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db00d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db01d60>]}


============================== 21:04:24.483548 | 362d9910-d20d-4760-9f04-ebc0ee0a0d34 ==============================
[0m21:04:24.483548 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:04:24.484161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:24.862211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '362d9910-d20d-4760-9f04-ebc0ee0a0d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5b36b860>]}
[0m21:04:24.884798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '362d9910-d20d-4760-9f04-ebc0ee0a0d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ab223f0>]}
[0m21:04:24.885330 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:04:24.928852 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:04:24.984382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:24.984691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:24.998532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '362d9910-d20d-4760-9f04-ebc0ee0a0d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a0de180>]}
[0m21:04:25.054681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '362d9910-d20d-4760-9f04-ebc0ee0a0d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff59aadc40>]}
[0m21:04:25.054999 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m21:04:25.055353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '362d9910-d20d-4760-9f04-ebc0ee0a0d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff59d15970>]}
[0m21:04:25.056049 [info ] [MainThread]: 
[0m21:04:25.056318 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:04:25.057206 [debug] [MainThread]: Command end result
[0m21:04:25.072731 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.63069487, "process_user_time": 2.18378, "process_kernel_time": 0.099217, "process_mem_max_rss": "207864", "process_out_blocks": "1853", "process_in_blocks": "0"}
[0m21:04:25.073060 [debug] [MainThread]: Command `dbt test` succeeded at 21:04:25.073013 after 0.63 seconds
[0m21:04:25.073288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e20b080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a0dfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7da17e90>]}
[0m21:04:25.073502 [debug] [MainThread]: Flushing usage events
[0m21:04:27.888439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52a95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7de13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4f76360>]}


============================== 21:04:27.891649 | c6646ad4-15bb-4ca3-b864-fec4cea4e84a ==============================
[0m21:04:27.891649 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:04:27.892161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:28.240460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6646ad4-15bb-4ca3-b864-fec4cea4e84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa674f890>]}
[0m21:04:28.259157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6646ad4-15bb-4ca3-b864-fec4cea4e84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a4ba70>]}
[0m21:04:28.259614 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:04:28.298774 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:04:28.348332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:28.348631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:28.360994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6646ad4-15bb-4ca3-b864-fec4cea4e84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81722900>]}
[0m21:04:28.415245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6646ad4-15bb-4ca3-b864-fec4cea4e84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813840e0>]}
[0m21:04:28.415770 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m21:04:28.416427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6646ad4-15bb-4ca3-b864-fec4cea4e84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8159c410>]}
[0m21:04:28.417689 [info ] [MainThread]: 
[0m21:04:28.418135 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:04:28.419525 [debug] [MainThread]: Command end result
[0m21:04:28.448635 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.5944239, "process_user_time": 2.148427, "process_kernel_time": 0.101877, "process_mem_max_rss": "207876", "process_out_blocks": "1853", "process_in_blocks": "0"}
[0m21:04:28.449226 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:04:28.449159 after 0.60 seconds
[0m21:04:28.449541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5158e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa577ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52ab0e0>]}
[0m21:04:28.449798 [debug] [MainThread]: Flushing usage events
[0m21:16:49.123379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c83dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966b5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94029670>]}


============================== 21:16:49.126989 | b5d2c410-5e33-436c-8b1e-690c24324786 ==============================
[0m21:16:49.126989 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:16:49.127516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:16:49.529360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76380ce0>]}
[0m21:16:49.549269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff763194c0>]}
[0m21:16:49.549827 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:16:49.592734 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:16:49.682481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:16:49.682827 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:16:49.695814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bfbbef0>]}
[0m21:16:49.749279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6be38b30>]}
[0m21:16:49.749603 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m21:16:49.750002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bb507a0>]}
[0m21:16:49.750808 [info ] [MainThread]: 
[0m21:16:49.751195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:16:49.753512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m21:16:49.759964 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m21:16:49.760274 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m21:16:49.760472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:50.304381 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.544 seconds
[0m21:16:50.307967 [debug] [ThreadPool]: On list_dev: Close
[0m21:16:50.449629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m21:16:50.462580 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m21:16:50.463343 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m21:16:50.463807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:50.998894 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.535 seconds
[0m21:16:51.002486 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m21:16:51.146537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bfba4b0>]}
[0m21:16:51.149790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:51.155095 [info ] [MainThread]: 
[0m21:16:51.168589 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m21:16:51.169670 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m21:16:51.170805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m21:16:51.171257 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m21:16:51.178863 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m21:16:51.180605 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m21:16:51.198178 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m21:16:51.199989 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m21:16:51.200313 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m21:16:51.200592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:51.937740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m21:16:51.968807 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m21:16:52.097510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94029c70>]}
[0m21:16:52.099271 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 0.92s]
[0m21:16:52.101361 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m21:16:52.104199 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m21:16:52.105473 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m21:16:52.106816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m21:16:52.107477 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m21:16:52.110995 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m21:16:52.112336 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m21:16:52.113944 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m21:16:52.115616 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m21:16:52.115911 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m21:16:52.116288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:52.963824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m21:16:52.966734 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m21:16:53.129394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bc219a0>]}
[0m21:16:53.130151 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 1.02s]
[0m21:16:53.131528 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m21:16:53.132309 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m21:16:53.133087 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m21:16:53.133599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m21:16:53.134132 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m21:16:53.136604 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m21:16:53.137679 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m21:16:53.139244 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m21:16:53.140723 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m21:16:53.141108 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m21:16:53.141533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:53.984512 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m21:16:53.988978 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m21:16:54.101357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b14b230>]}
[0m21:16:54.103093 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.97s]
[0m21:16:54.104698 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m21:16:54.105570 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m21:16:54.106713 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.fact_bitcoin_price_momentum .............. [RUN]
[0m21:16:54.107969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.fact_bitcoin_price_momentum)
[0m21:16:54.108792 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m21:16:54.113982 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m21:16:54.118122 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m21:16:54.121149 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m21:16:54.123410 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m21:16:54.123992 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_price_momentum"} */
create or replace   view dev.analytics.fact_bitcoin_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) AS price_close_14d_ago
    FROM dev.analytics.stg_bitcoin_price
)
, momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_14d_ago,
        -- Calculate the price momentum as percentage change over 14 days
        CASE 
            WHEN price_close_14d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_14d_ago) / price_close_14d_ago) * 100
        END AS price_momentum_14d
    FROM base
)
SELECT
    symbol,
    date,
    price_close,
    price_momentum_14d
FROM momentum_calc
ORDER BY symbol, date
  );
[0m21:16:54.124508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.906641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m21:16:54.911944 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: Close
[0m21:16:55.076525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b00b140>]}
[0m21:16:55.077620 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.fact_bitcoin_price_momentum ......... [[32mSUCCESS 1[0m in 0.97s]
[0m21:16:55.078743 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m21:16:55.079298 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m21:16:55.079831 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m21:16:55.080449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_price_momentum, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m21:16:55.080854 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m21:16:55.084058 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m21:16:55.085904 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m21:16:55.100430 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m21:16:55.102098 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m21:16:55.102446 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

momentum AS (
    SELECT
        symbol,
        date,
        -- Calculate price momentum as percentage change over 14 days
        CASE 
            WHEN LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) IS NULL THEN NULL
            ELSE ((price_close - LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) / LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) * 100
        END AS price_momentum_14d
    FROM dev.analytics.stg_bitcoin_price
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    momentum.price_momentum_14d
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN momentum ON sma.symbol = momentum.symbol AND sma.date = momentum.date
        );
[0m21:16:55.102772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:56.682372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.579 seconds
[0m21:16:56.689534 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m21:16:56.815646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d2c410-5e33-436c-8b1e-690c24324786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6af29400>]}
[0m21:16:56.816466 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 1.73s]
[0m21:16:56.817634 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m21:16:56.818876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:56.819273 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m21:16:56.819658 [info ] [MainThread]: 
[0m21:16:56.820161 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.07 seconds (7.07s).
[0m21:16:56.821191 [debug] [MainThread]: Command end result
[0m21:16:56.846376 [info ] [MainThread]: 
[0m21:16:56.846774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:16:56.847054 [info ] [MainThread]: 
[0m21:16:56.847330 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:16:56.848129 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.76422, "process_user_time": 2.716195, "process_kernel_time": 0.223497, "process_mem_max_rss": "207856", "process_out_blocks": "1933", "process_in_blocks": "0"}
[0m21:16:56.848446 [debug] [MainThread]: Command `dbt run` succeeded at 21:16:56.848395 after 7.76 seconds
[0m21:16:56.848690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c82660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70eef9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c206e0>]}
[0m21:16:56.848901 [debug] [MainThread]: Flushing usage events
[0m21:16:59.299571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802ab140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802ab110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82de53a0>]}


============================== 21:16:59.303123 | 7f4254bc-bdc0-4d9d-9cdd-60334edba729 ==============================
[0m21:16:59.303123 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:16:59.303683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:16:59.681956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f4254bc-bdc0-4d9d-9cdd-60334edba729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff62990ce0>]}
[0m21:16:59.701868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f4254bc-bdc0-4d9d-9cdd-60334edba729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c974d70>]}
[0m21:16:59.702486 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:16:59.745565 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:16:59.796811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:16:59.797218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:16:59.810391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f4254bc-bdc0-4d9d-9cdd-60334edba729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c58ed80>]}
[0m21:16:59.886110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f4254bc-bdc0-4d9d-9cdd-60334edba729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c045400>]}
[0m21:16:59.886502 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m21:16:59.886979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f4254bc-bdc0-4d9d-9cdd-60334edba729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c59dfa0>]}
[0m21:16:59.888246 [info ] [MainThread]: 
[0m21:16:59.888658 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:16:59.889661 [debug] [MainThread]: Command end result
[0m21:16:59.912231 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.65019083, "process_user_time": 2.281215, "process_kernel_time": 0.107386, "process_mem_max_rss": "207852", "process_out_blocks": "1853", "process_in_blocks": "0"}
[0m21:16:59.912623 [debug] [MainThread]: Command `dbt test` succeeded at 21:16:59.912570 after 0.65 seconds
[0m21:16:59.912847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5cd79880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802aa420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fff87d0>]}
[0m21:16:59.913108 [debug] [MainThread]: Flushing usage events
[0m21:17:02.110364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e2b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99519a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9975fd10>]}


============================== 21:17:02.113847 | 1f1e84ee-2de8-480f-9bd2-c2fa61adaf75 ==============================
[0m21:17:02.113847 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:17:02.114393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:02.527103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f1e84ee-2de8-480f-9bd2-c2fa61adaf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999c7b00>]}
[0m21:17:02.547513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f1e84ee-2de8-480f-9bd2-c2fa61adaf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7608f2c0>]}
[0m21:17:02.548096 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:17:02.590490 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:17:02.640966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:02.641289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:02.653985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f1e84ee-2de8-480f-9bd2-c2fa61adaf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9975dac0>]}
[0m21:17:02.701587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f1e84ee-2de8-480f-9bd2-c2fa61adaf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7458b890>]}
[0m21:17:02.701865 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m21:17:02.702246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f1e84ee-2de8-480f-9bd2-c2fa61adaf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff744b2cc0>]}
[0m21:17:02.702969 [info ] [MainThread]: 
[0m21:17:02.703278 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:17:02.704104 [debug] [MainThread]: Command end result
[0m21:17:02.718775 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.64667726, "process_user_time": 2.168127, "process_kernel_time": 0.106497, "process_mem_max_rss": "207864", "process_out_blocks": "1853", "process_in_blocks": "0"}
[0m21:17:02.719293 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:17:02.719227 after 0.65 seconds
[0m21:17:02.719523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e2b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9975fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87970bc0>]}
[0m21:17:02.719722 [debug] [MainThread]: Flushing usage events
[0m22:16:42.602124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4beff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e743140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec5e210>]}


============================== 22:16:42.617267 | 4beda41c-0239-436a-9293-b49a3a5b1b32 ==============================
[0m22:16:42.617267 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:16:42.617832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:16:43.235108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a2da0c0>]}
[0m22:16:43.255082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bb28cb0>]}
[0m22:16:43.255934 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:16:43.300614 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:16:43.354048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:16:43.354513 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://models/output/crypto_price_momentum.sql
[0m22:16:43.449346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69d6f7d0>]}
[0m22:16:43.507590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69d240b0>]}
[0m22:16:43.507907 [info ] [MainThread]: Found 6 models, 2 sources, 459 macros
[0m22:16:43.508312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69d41e80>]}
[0m22:16:43.509199 [info ] [MainThread]: 
[0m22:16:43.509588 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:43.511880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:16:43.517690 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:16:43.517947 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:16:43.518118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:44.377235 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.859 seconds
[0m22:16:44.381261 [debug] [ThreadPool]: On list_dev: Close
[0m22:16:44.514417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:16:44.528974 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:16:44.529992 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:16:44.530529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:16:45.048596 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.518 seconds
[0m22:16:45.052315 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:16:45.178575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69e3b4d0>]}
[0m22:16:45.180589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:16:45.182347 [info ] [MainThread]: 
[0m22:16:45.196905 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:16:45.198073 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m22:16:45.199305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m22:16:45.199879 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:16:45.206361 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:16:45.209481 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:16:45.229188 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:16:45.231567 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:16:45.231875 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m22:16:45.232158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:45.910451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.678 seconds
[0m22:16:45.930856 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m22:16:46.082178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a7ad310>]}
[0m22:16:46.083214 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 0.88s]
[0m22:16:46.084391 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:16:46.085734 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:16:46.086330 [info ] [Thread-1 (]: 2 of 6 START sql table model analytics.crypto_price_momentum ................... [RUN]
[0m22:16:46.087153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.crypto_price_momentum)
[0m22:16:46.087694 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m22:16:46.090582 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:16:46.092255 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m22:16:46.106926 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:16:46.109183 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:16:46.109567 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace transient table dev.analytics.crypto_price_momentum
         as
        (WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) AS price_close_14d_ago
    FROM dev.analytics.stg_bitcoin_price
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_14d_ago,
        -- Calculate price momentum as percentage change over 14 days
        CASE 
            WHEN price_close_14d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_14d_ago) / price_close_14d_ago) * 100
        END AS price_momentum_14d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_14d_ago,
        price_momentum_14d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_14d > 0 THEN 'Positive'
            WHEN price_momentum_14d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with additional columns for context
SELECT
    symbol,
    date,
    price_close,
    price_close_14d_ago,
    price_momentum_14d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
        );
[0m22:16:46.109994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:47.699236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.589 seconds
[0m22:16:47.700555 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m22:16:47.819228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6953b2c0>]}
[0m22:16:47.819828 [info ] [Thread-1 (]: 2 of 6 OK created sql table model analytics.crypto_price_momentum .............. [[32mSUCCESS 1[0m in 1.73s]
[0m22:16:47.820552 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:16:47.820968 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:16:47.821430 [info ] [Thread-1 (]: 3 of 6 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m22:16:47.821984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m22:16:47.822219 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:16:47.823767 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:16:47.824649 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:16:47.825924 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:16:47.827357 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:16:47.827652 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m22:16:47.827896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:48.462724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m22:16:48.466492 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m22:16:48.608719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff695d3e60>]}
[0m22:16:48.610868 [info ] [Thread-1 (]: 3 of 6 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 0.79s]
[0m22:16:48.613031 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:16:48.614185 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:16:48.615379 [info ] [Thread-1 (]: 4 of 6 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m22:16:48.616722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m22:16:48.617591 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:16:48.621704 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:16:48.624883 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:16:48.628030 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:16:48.629968 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:16:48.630602 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m22:16:48.631142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:49.395167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m22:16:49.398315 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m22:16:49.526952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff691303e0>]}
[0m22:16:49.529289 [info ] [Thread-1 (]: 4 of 6 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.91s]
[0m22:16:49.532052 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:16:49.533151 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m22:16:49.534558 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics.fact_bitcoin_price_momentum .............. [RUN]
[0m22:16:49.536012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.fact_bitcoin_price_momentum)
[0m22:16:49.536772 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m22:16:49.543707 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m22:16:49.546580 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m22:16:49.549723 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m22:16:49.551917 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m22:16:49.552392 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_price_momentum"} */
create or replace   view dev.analytics.fact_bitcoin_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) AS price_close_14d_ago
    FROM dev.analytics.stg_bitcoin_price
)
, momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_14d_ago,
        -- Calculate the price momentum as percentage change over 14 days
        CASE 
            WHEN price_close_14d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_14d_ago) / price_close_14d_ago) * 100
        END AS price_momentum_14d
    FROM base
)
SELECT
    symbol,
    date,
    price_close,
    price_momentum_14d
FROM momentum_calc
ORDER BY symbol, date
  );
[0m22:16:49.552895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:50.321293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m22:16:50.326081 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: Close
[0m22:16:50.474414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff69141e80>]}
[0m22:16:50.476754 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics.fact_bitcoin_price_momentum ......... [[32mSUCCESS 1[0m in 0.94s]
[0m22:16:50.478803 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m22:16:50.479914 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:16:50.480870 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m22:16:50.482025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_price_momentum, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m22:16:50.482724 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:16:50.486638 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:16:50.488471 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:16:50.490762 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:16:50.492962 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:16:50.493452 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

momentum AS (
    SELECT
        symbol,
        date,
        -- Calculate price momentum as percentage change over 14 days
        CASE 
            WHEN LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) IS NULL THEN NULL
            ELSE ((price_close - LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) / LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) * 100
        END AS price_momentum_14d
    FROM dev.analytics.stg_bitcoin_price
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    momentum.price_momentum_14d
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN momentum ON sma.symbol = momentum.symbol AND sma.date = momentum.date
        );
[0m22:16:50.494037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:16:51.793689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.299 seconds
[0m22:16:51.797130 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m22:16:51.930348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4beda41c-0239-436a-9293-b49a3a5b1b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6914a3c0>]}
[0m22:16:51.932302 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 1.45s]
[0m22:16:51.935604 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:16:51.938012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:51.938522 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m22:16:51.939100 [info ] [MainThread]: 
[0m22:16:51.940098 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m22:16:51.941388 [debug] [MainThread]: Command end result
[0m22:16:51.973112 [info ] [MainThread]: 
[0m22:16:51.973766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:16:51.974039 [info ] [MainThread]: 
[0m22:16:51.974302 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:16:51.975189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.395296, "process_user_time": 3.264754, "process_kernel_time": 0.319994, "process_mem_max_rss": "217984", "process_out_blocks": "14612", "process_in_blocks": "0"}
[0m22:16:51.975585 [debug] [MainThread]: Command `dbt run` succeeded at 22:16:51.975526 after 9.40 seconds
[0m22:16:51.975880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec5e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b42240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0ccaa0>]}
[0m22:16:51.976155 [debug] [MainThread]: Flushing usage events
[0m22:16:55.505817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981f09e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949b8b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9574a600>]}


============================== 22:16:55.509398 | 89f4d188-362a-4a5a-a49f-f8328cd9d2e1 ==============================
[0m22:16:55.509398 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:16:55.510108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m22:16:55.941135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89f4d188-362a-4a5a-a49f-f8328cd9d2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e0bad0>]}
[0m22:16:55.965375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89f4d188-362a-4a5a-a49f-f8328cd9d2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947bb7a0>]}
[0m22:16:55.966020 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:16:56.025444 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:16:56.080829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:56.081145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:56.094969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89f4d188-362a-4a5a-a49f-f8328cd9d2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70ca65d0>]}
[0m22:16:56.156164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89f4d188-362a-4a5a-a49f-f8328cd9d2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70775790>]}
[0m22:16:56.156476 [info ] [MainThread]: Found 6 models, 2 sources, 459 macros
[0m22:16:56.156684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89f4d188-362a-4a5a-a49f-f8328cd9d2e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff709c19a0>]}
[0m22:16:56.157478 [info ] [MainThread]: 
[0m22:16:56.157683 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:16:56.158502 [debug] [MainThread]: Command end result
[0m22:16:56.182221 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.72814095, "process_user_time": 2.266286, "process_kernel_time": 0.131905, "process_mem_max_rss": "209228", "process_out_blocks": "1870", "process_in_blocks": "0"}
[0m22:16:56.184886 [debug] [MainThread]: Command `dbt test` succeeded at 22:16:56.184791 after 0.73 seconds
[0m22:16:56.185172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974922d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71c7e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff709e3c20>]}
[0m22:16:56.185369 [debug] [MainThread]: Flushing usage events
[0m22:16:59.329665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2b5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2b5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2b5f40>]}


============================== 22:16:59.332915 | b467cdd6-f4f6-4155-a943-9ba7dad25dc3 ==============================
[0m22:16:59.332915 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:16:59.333468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:16:59.705228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b467cdd6-f4f6-4155-a943-9ba7dad25dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf90baa0>]}
[0m22:16:59.725023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b467cdd6-f4f6-4155-a943-9ba7dad25dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e488c0>]}
[0m22:16:59.725573 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:16:59.766707 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:16:59.820090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:16:59.820441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:16:59.833712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b467cdd6-f4f6-4155-a943-9ba7dad25dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869512b0>]}
[0m22:16:59.883032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b467cdd6-f4f6-4155-a943-9ba7dad25dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86520470>]}
[0m22:16:59.883327 [info ] [MainThread]: Found 6 models, 2 sources, 459 macros
[0m22:16:59.883734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b467cdd6-f4f6-4155-a943-9ba7dad25dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8651a000>]}
[0m22:16:59.884509 [info ] [MainThread]: 
[0m22:16:59.884925 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:16:59.885730 [debug] [MainThread]: Command end result
[0m22:16:59.901634 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.60828686, "process_user_time": 2.173917, "process_kernel_time": 0.126928, "process_mem_max_rss": "209204", "process_out_blocks": "1870", "process_in_blocks": "0"}
[0m22:16:59.901960 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:16:59.901915 after 0.61 seconds
[0m22:16:59.902159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeefe240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae526ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9085c0>]}
[0m22:16:59.902342 [debug] [MainThread]: Flushing usage events
[0m22:19:58.050178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb709c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f53ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb86e9580>]}


============================== 22:19:58.054430 | 5fc866bb-352e-47a7-a5ae-9f8711367f18 ==============================
[0m22:19:58.054430 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:19:58.055056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:19:58.458105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8889e0>]}
[0m22:19:58.478318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0af4d0>]}
[0m22:19:58.478924 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:19:58.522074 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:19:58.576292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:19:58.576763 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/output/crypto_price_momentum.sql
[0m22:19:58.672882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e793530>]}
[0m22:19:58.723911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb3e180>]}
[0m22:19:58.724228 [info ] [MainThread]: Found 6 models, 2 sources, 459 macros
[0m22:19:58.724613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e773e30>]}
[0m22:19:58.725438 [info ] [MainThread]: 
[0m22:19:58.725813 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:19:58.727815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:19:58.734028 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:19:58.734420 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:19:58.734676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:59.256688 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.522 seconds
[0m22:19:59.261214 [debug] [ThreadPool]: On list_dev: Close
[0m22:19:59.377058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:19:59.383927 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:19:59.384594 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:19:59.384869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:19:59.835939 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.451 seconds
[0m22:19:59.837113 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:19:59.949864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d48d40>]}
[0m22:19:59.950774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:19:59.951500 [info ] [MainThread]: 
[0m22:19:59.959222 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:19:59.959864 [info ] [Thread-1 (]: 1 of 6 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m22:19:59.961057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m22:19:59.961446 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:19:59.966690 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:19:59.967757 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:19:59.985282 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:19:59.987518 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:19:59.987838 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m22:19:59.988073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:00.589175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m22:20:00.602045 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m22:20:00.752000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0acaa0>]}
[0m22:20:00.752584 [info ] [Thread-1 (]: 1 of 6 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 0.79s]
[0m22:20:00.753290 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:20:00.753969 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:20:00.754315 [info ] [Thread-1 (]: 2 of 6 START sql table model analytics.crypto_price_momentum ................... [RUN]
[0m22:20:00.754757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.crypto_price_momentum)
[0m22:20:00.754999 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m22:20:00.756570 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:20:00.758109 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m22:20:00.768394 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:20:00.770168 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:20:00.770483 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace transient table dev.analytics.crypto_price_momentum
         as
        (WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.stg_bitcoin_price
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        -- Calculate price momentum as percentage change over 7 days
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
        );
[0m22:20:00.770849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:01.948528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.178 seconds
[0m22:20:01.949687 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m22:20:02.090346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db23440>]}
[0m22:20:02.090810 [info ] [Thread-1 (]: 2 of 6 OK created sql table model analytics.crypto_price_momentum .............. [[32mSUCCESS 1[0m in 1.34s]
[0m22:20:02.091325 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:20:02.091579 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:20:02.091857 [info ] [Thread-1 (]: 3 of 6 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m22:20:02.092270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m22:20:02.092521 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:20:02.094216 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:20:02.095108 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:20:02.096335 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:20:02.097772 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:20:02.098068 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m22:20:02.098328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:02.768573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m22:20:02.769887 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m22:20:02.887320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db670e0>]}
[0m22:20:02.887836 [info ] [Thread-1 (]: 3 of 6 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 0.79s]
[0m22:20:02.888437 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:20:02.888769 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:20:02.889116 [info ] [Thread-1 (]: 4 of 6 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m22:20:02.889558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m22:20:02.889846 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:20:02.891436 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:20:02.892177 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:20:02.893453 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:20:02.894684 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:20:02.895048 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m22:20:02.895288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:03.594242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m22:20:03.596569 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m22:20:03.723101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db67590>]}
[0m22:20:03.725497 [info ] [Thread-1 (]: 4 of 6 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.83s]
[0m22:20:03.728131 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:20:03.729241 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m22:20:03.730752 [info ] [Thread-1 (]: 5 of 6 START sql view model analytics.fact_bitcoin_price_momentum .............. [RUN]
[0m22:20:03.732237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.fact_bitcoin_price_momentum)
[0m22:20:03.733281 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m22:20:03.737360 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m22:20:03.740308 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m22:20:03.743070 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m22:20:03.745240 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_price_momentum"
[0m22:20:03.745650 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_price_momentum"} */
create or replace   view dev.analytics.fact_bitcoin_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) AS price_close_14d_ago
    FROM dev.analytics.stg_bitcoin_price
)
, momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_14d_ago,
        -- Calculate the price momentum as percentage change over 14 days
        CASE 
            WHEN price_close_14d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_14d_ago) / price_close_14d_ago) * 100
        END AS price_momentum_14d
    FROM base
)
SELECT
    symbol,
    date,
    price_close,
    price_momentum_14d
FROM momentum_calc
ORDER BY symbol, date
  );
[0m22:20:03.746029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:04.419294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m22:20:04.424072 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_price_momentum: Close
[0m22:20:04.557500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df3e4e0>]}
[0m22:20:04.560373 [info ] [Thread-1 (]: 5 of 6 OK created sql view model analytics.fact_bitcoin_price_momentum ......... [[32mSUCCESS 1[0m in 0.82s]
[0m22:20:04.563559 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_price_momentum
[0m22:20:04.564685 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:20:04.565760 [info ] [Thread-1 (]: 6 of 6 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m22:20:04.567199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_price_momentum, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m22:20:04.568135 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:20:04.573861 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:20:04.576007 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:20:04.578866 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:20:04.581356 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:20:04.582047 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

momentum AS (
    SELECT
        symbol,
        date,
        -- Calculate price momentum as percentage change over 14 days
        CASE 
            WHEN LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) IS NULL THEN NULL
            ELSE ((price_close - LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) / LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) * 100
        END AS price_momentum_14d
    FROM dev.analytics.stg_bitcoin_price
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    momentum.price_momentum_14d
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN momentum ON sma.symbol = momentum.symbol AND sma.date = momentum.date
        );
[0m22:20:04.582573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:06.244903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.662 seconds
[0m22:20:06.250367 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m22:20:06.375645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc866bb-352e-47a7-a5ae-9f8711367f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db74e00>]}
[0m22:20:06.378251 [info ] [Thread-1 (]: 6 of 6 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 1.81s]
[0m22:20:06.380968 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:20:06.384186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:06.384767 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m22:20:06.385504 [info ] [MainThread]: 
[0m22:20:06.386783 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m22:20:06.388849 [debug] [MainThread]: Command end result
[0m22:20:06.423367 [info ] [MainThread]: 
[0m22:20:06.424229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:20:06.424753 [info ] [MainThread]: 
[0m22:20:06.425243 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:20:06.426298 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.413922, "process_user_time": 2.701557, "process_kernel_time": 0.196676, "process_mem_max_rss": "209208", "process_out_blocks": "2900", "process_in_blocks": "0"}
[0m22:20:06.426691 [debug] [MainThread]: Command `dbt run` succeeded at 22:20:06.426629 after 8.41 seconds
[0m22:20:06.427017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb709c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba61f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b32990>]}
[0m22:20:06.427292 [debug] [MainThread]: Flushing usage events
[0m22:20:09.149226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa69d3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80f9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa683a2d0>]}


============================== 22:20:09.152393 | f477fa65-26e6-4f01-8089-f49af01d3819 ==============================
[0m22:20:09.152393 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:20:09.153016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:20:09.526243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f477fa65-26e6-4f01-8089-f49af01d3819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7833d40>]}
[0m22:20:09.548115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f477fa65-26e6-4f01-8089-f49af01d3819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fd67b0>]}
[0m22:20:09.548636 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:20:09.594069 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:20:09.645443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:09.645842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:09.658832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f477fa65-26e6-4f01-8089-f49af01d3819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e3b9b0>]}
[0m22:20:09.713353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f477fa65-26e6-4f01-8089-f49af01d3819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1bdfd0>]}
[0m22:20:09.713665 [info ] [MainThread]: Found 6 models, 2 sources, 459 macros
[0m22:20:09.714055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f477fa65-26e6-4f01-8089-f49af01d3819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3fb6b0>]}
[0m22:20:09.714803 [info ] [MainThread]: 
[0m22:20:09.715049 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:20:09.715849 [debug] [MainThread]: Command end result
[0m22:20:09.731117 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.62309575, "process_user_time": 2.220941, "process_kernel_time": 0.091313, "process_mem_max_rss": "209212", "process_out_blocks": "1870", "process_in_blocks": "0"}
[0m22:20:09.731479 [debug] [MainThread]: Command `dbt test` succeeded at 22:20:09.731435 after 0.62 seconds
[0m22:20:09.731681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa658ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e89bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6492f30>]}
[0m22:20:09.731873 [debug] [MainThread]: Flushing usage events
[0m22:20:11.863202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e470950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e4928a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0992c00>]}


============================== 22:20:11.866640 | 25c7c115-9151-4c66-b558-74b94f6252d7 ==============================
[0m22:20:11.866640 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:20:11.867180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m22:20:12.244653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25c7c115-9151-4c66-b558-74b94f6252d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff777a7770>]}
[0m22:20:12.264800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25c7c115-9151-4c66-b558-74b94f6252d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76a1f3e0>]}
[0m22:20:12.265393 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:20:12.305387 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:20:12.356085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:12.356463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:12.369268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25c7c115-9151-4c66-b558-74b94f6252d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76a73fb0>]}
[0m22:20:12.420464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25c7c115-9151-4c66-b558-74b94f6252d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5e0680>]}
[0m22:20:12.420844 [info ] [MainThread]: Found 6 models, 2 sources, 459 macros
[0m22:20:12.421278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c7c115-9151-4c66-b558-74b94f6252d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff766ba930>]}
[0m22:20:12.422068 [info ] [MainThread]: 
[0m22:20:12.422379 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:20:12.423267 [debug] [MainThread]: Command end result
[0m22:20:12.439315 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.6129416, "process_user_time": 2.197755, "process_kernel_time": 0.110339, "process_mem_max_rss": "209224", "process_out_blocks": "1870", "process_in_blocks": "0"}
[0m22:20:12.439624 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:20:12.439581 after 0.61 seconds
[0m22:20:12.439816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f471460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff59a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b19730>]}
[0m22:20:12.440038 [debug] [MainThread]: Flushing usage events
[0m22:29:32.852018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36ed940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36ed9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36edee0>]}


============================== 22:29:32.856149 | 35d9b129-f407-4938-b267-00c5fbce713a ==============================
[0m22:29:32.856149 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:32.856778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:33.287555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90051460>]}
[0m22:29:33.309578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b327b0>]}
[0m22:29:33.310189 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:29:33.353584 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:29:33.412255 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 1 files changed.
[0m22:29:33.412678 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://models/input/crypto_price_momentum.sql
[0m22:29:33.412905 [debug] [MainThread]: Partial parsing: deleted file: crypto_currencies_elt://models/input/fact_bitcoin_price_momentum.sql
[0m22:29:33.413146 [debug] [MainThread]: Partial parsing: deleted file: crypto_currencies_elt://models/output/crypto_price_momentum.sql
[0m22:29:33.413422 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/output/stg_bitcoin_daily_metrics.sql
[0m22:29:33.509406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad83500>]}
[0m22:29:33.557255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1a2a80>]}
[0m22:29:33.557577 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m22:29:33.557989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0ff050>]}
[0m22:29:33.558805 [info ] [MainThread]: 
[0m22:29:33.559180 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:33.561269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:29:33.567722 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:29:33.568033 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:29:33.568246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:34.167846 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.599 seconds
[0m22:29:34.171367 [debug] [ThreadPool]: On list_dev: Close
[0m22:29:34.302187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:29:34.311231 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:29:34.312147 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:29:34.312710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:34.846746 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.534 seconds
[0m22:29:34.849457 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:29:34.976153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e17a10>]}
[0m22:29:34.979811 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:29:34.982889 [info ] [MainThread]: 
[0m22:29:34.997681 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:29:34.998733 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m22:29:34.999651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m22:29:35.000071 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:29:35.008312 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:29:35.010352 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:29:35.025419 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:29:35.027515 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:29:35.028108 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m22:29:35.028400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:35.792820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m22:29:35.821099 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m22:29:36.046778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b71c2f0>]}
[0m22:29:36.048833 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 1.05s]
[0m22:29:36.049780 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:29:36.051354 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:29:36.052066 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m22:29:36.053035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.crypto_price_momentum)
[0m22:29:36.053474 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m22:29:36.056552 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:29:36.058015 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m22:29:36.064444 [debug] [Thread-1 (]: Dropping relation "DEV"."ANALYTICS"."CRYPTO_PRICE_MOMENTUM" because it is of type table
[0m22:29:36.068683 [debug] [Thread-1 (]: Applying DROP to: "DEV"."ANALYTICS"."CRYPTO_PRICE_MOMENTUM"
[0m22:29:36.073026 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:29:36.073451 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
drop table if exists "DEV"."ANALYTICS"."CRYPTO_PRICE_MOMENTUM" cascade
[0m22:29:36.073751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:36.596794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.523 seconds
[0m22:29:36.601549 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:29:36.606949 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:29:36.608580 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.stg_bitcoin_price
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        -- Calculate price momentum as percentage change over 7 days
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m22:29:36.910499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m22:29:36.917544 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m22:29:37.072763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a52f5f0>]}
[0m22:29:37.073784 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 1.02s]
[0m22:29:37.075744 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:29:37.076139 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:29:37.077504 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m22:29:37.078845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m22:29:37.079228 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:29:37.081850 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:29:37.083480 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:29:37.089041 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:29:37.091234 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:29:37.091828 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m22:29:37.092194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:37.837372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m22:29:37.841430 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m22:29:37.964140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a144d70>]}
[0m22:29:37.964972 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 0.89s]
[0m22:29:37.965901 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:29:37.966284 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:29:37.966698 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m22:29:37.967204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m22:29:37.967495 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:29:37.970314 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:29:37.971855 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:29:37.973589 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:29:37.974841 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:29:37.975100 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m22:29:37.975331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:38.770919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m22:29:38.778172 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m22:29:38.923335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1462d0>]}
[0m22:29:38.925248 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.96s]
[0m22:29:38.927883 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:29:38.929616 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:29:38.930705 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m22:29:38.932383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m22:29:38.933291 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:29:38.940552 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:29:38.944393 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:29:38.966862 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:29:38.969681 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:29:38.970559 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

momentum AS (
    SELECT
        symbol,
        date,
        -- Calculate price momentum as percentage change over 14 days
        CASE 
            WHEN LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date) IS NULL THEN NULL
            ELSE ((price_close - LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) / LAG(price_close, 14) OVER(PARTITION BY symbol ORDER BY date)) * 100
        END AS price_momentum_14d
    FROM dev.analytics.stg_bitcoin_price
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    momentum.price_momentum_14d
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN momentum ON sma.symbol = momentum.symbol AND sma.date = momentum.date








WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

-- Combine the metrics into a final fact table
SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    price_momentum.price_momentum,
    price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date;
[0m22:29:38.971055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:39.396230 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85fe5-0004-2cf3-0002-7873000109d2
[0m22:29:39.398307 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 0 unexpected 'WITH'.
syntax error line 96 at position 12 unexpected 'sma'.
[0m22:29:39.399755 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m22:29:39.529797 [debug] [Thread-1 (]: Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 0 unexpected 'WITH'.
  syntax error line 96 at position 12 unexpected 'sma'.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m22:29:39.531486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d9b129-f407-4938-b267-00c5fbce713a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a13ce60>]}
[0m22:29:39.532922 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model analytics.stg_bitcoin_daily_metrics ...... [[31mERROR[0m in 0.60s]
[0m22:29:39.535416 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:29:39.538960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:39.539733 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m22:29:39.540361 [info ] [MainThread]: 
[0m22:29:39.541305 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m22:29:39.542885 [debug] [MainThread]: Command end result
[0m22:29:39.575197 [info ] [MainThread]: 
[0m22:29:39.576127 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:29:39.576430 [info ] [MainThread]: 
[0m22:29:39.577442 [error] [MainThread]:   Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 0 unexpected 'WITH'.
  syntax error line 96 at position 12 unexpected 'sma'.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m22:29:39.577745 [info ] [MainThread]: 
[0m22:29:39.578027 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:29:39.583732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.772849, "process_user_time": 2.868117, "process_kernel_time": 0.233698, "process_mem_max_rss": "209780", "process_out_blocks": "2891", "command_success": false, "process_in_blocks": "0"}
[0m22:29:39.584943 [debug] [MainThread]: Command `dbt run` failed at 22:29:39.584802 after 6.77 seconds
[0m22:29:39.585582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb35e4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb31aef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb31ae5d0>]}
[0m22:29:39.585850 [debug] [MainThread]: Flushing usage events
[0m22:33:02.241074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15c1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1fc1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb168fb60>]}


============================== 22:33:02.244575 | 2b3db779-cfeb-4e3e-9d04-b15752c53e3e ==============================
[0m22:33:02.244575 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:33:02.245098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:33:02.659261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23e04a0>]}
[0m22:33:02.679945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935604d0>]}
[0m22:33:02.680512 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:33:02.724450 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:33:02.782514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:33:02.783199 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/output/stg_bitcoin_daily_metrics.sql
[0m22:33:02.881652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d917410>]}
[0m22:33:02.927574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dab2600>]}
[0m22:33:02.927879 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m22:33:02.928249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93563950>]}
[0m22:33:02.929016 [info ] [MainThread]: 
[0m22:33:02.929405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:33:02.931473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:33:02.937764 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:33:02.938011 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:33:02.938186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:33:03.466403 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.528 seconds
[0m22:33:03.469508 [debug] [ThreadPool]: On list_dev: Close
[0m22:33:03.597662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:33:03.611871 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:33:03.612673 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:33:03.613201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:33:04.159594 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.546 seconds
[0m22:33:04.161020 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:33:04.285760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dccce30>]}
[0m22:33:04.286538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:33:04.287554 [info ] [MainThread]: 
[0m22:33:04.296366 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:33:04.298789 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m22:33:04.299553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m22:33:04.299914 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:33:04.305240 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:33:04.309408 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:33:04.329208 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:33:04.330688 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:33:04.331021 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m22:33:04.331301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:05.071030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m22:33:05.082573 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m22:33:05.377934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e020680>]}
[0m22:33:05.378500 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 1.08s]
[0m22:33:05.379161 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:33:05.379989 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:33:05.380330 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m22:33:05.380777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.crypto_price_momentum)
[0m22:33:05.380981 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m22:33:05.382588 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:33:05.383284 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m22:33:05.384652 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:33:05.386264 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:33:05.386598 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.stg_bitcoin_price
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        -- Calculate price momentum as percentage change over 7 days
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m22:33:05.386875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:06.098553 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.711 seconds
[0m22:33:06.103253 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m22:33:06.338906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd2d0d0>]}
[0m22:33:06.340571 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.96s]
[0m22:33:06.341489 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:33:06.342460 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:33:06.343937 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m22:33:06.344846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m22:33:06.345363 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:33:06.348676 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:33:06.350341 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:33:06.352338 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:33:06.354239 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:33:06.354612 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m22:33:06.354961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:06.990633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m22:33:06.993128 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m22:33:07.126405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd17650>]}
[0m22:33:07.127562 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 0.78s]
[0m22:33:07.129056 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:33:07.129536 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:33:07.130038 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m22:33:07.130676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m22:33:07.131003 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:33:07.135159 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:33:07.136235 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:33:07.138176 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:33:07.139377 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:33:07.139705 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m22:33:07.140006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:07.785153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m22:33:07.790331 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m22:33:07.917513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd30a40>]}
[0m22:33:07.920234 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.79s]
[0m22:33:07.922828 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:33:07.925414 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:33:07.926792 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m22:33:07.928383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m22:33:07.929373 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:33:07.934298 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:33:07.935909 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:33:07.953453 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:33:07.955441 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:33:07.955898 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    price_momentum.price_momentum,
    price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date;
[0m22:33:07.956271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:33:08.408874 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85fe9-0004-2cf5-0002-78730001294e
[0m22:33:08.410321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 29 unexpected ';'.
[0m22:33:08.411430 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m22:33:08.538470 [debug] [Thread-1 (]: Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 29 unexpected ';'.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m22:33:08.540618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3db779-cfeb-4e3e-9d04-b15752c53e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd2cf80>]}
[0m22:33:08.542083 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model analytics.stg_bitcoin_daily_metrics ...... [[31mERROR[0m in 0.61s]
[0m22:33:08.543677 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:33:08.546845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:33:08.547360 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m22:33:08.548026 [info ] [MainThread]: 
[0m22:33:08.549015 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m22:33:08.550540 [debug] [MainThread]: Command end result
[0m22:33:08.581928 [info ] [MainThread]: 
[0m22:33:08.582872 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:33:08.583271 [info ] [MainThread]: 
[0m22:33:08.583632 [error] [MainThread]:   Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 29 unexpected ';'.
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m22:33:08.583932 [info ] [MainThread]: 
[0m22:33:08.584208 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:33:08.585405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.385068, "process_user_time": 2.775698, "process_kernel_time": 0.19567, "process_mem_max_rss": "209892", "process_out_blocks": "2865", "command_success": false, "process_in_blocks": "0"}
[0m22:33:08.586039 [debug] [MainThread]: Command `dbt run` failed at 22:33:08.585941 after 6.39 seconds
[0m22:33:08.586435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2593080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8da26420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20717f0>]}
[0m22:33:08.586773 [debug] [MainThread]: Flushing usage events
[0m22:34:20.900624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9ae0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9a9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbe1df0>]}


============================== 22:34:20.904688 | 3e387983-8889-4b9e-b250-81c98dbc8b5b ==============================
[0m22:34:20.904688 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:34:20.905065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:34:21.342663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d108650>]}
[0m22:34:21.363763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b94f5c0>]}
[0m22:34:21.364371 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:34:21.408598 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:34:21.464222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:34:21.464662 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/output/stg_bitcoin_daily_metrics.sql
[0m22:34:21.558392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79076360>]}
[0m22:34:21.605644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78cb1d60>]}
[0m22:34:21.605947 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m22:34:21.606127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78b03e60>]}
[0m22:34:21.606969 [info ] [MainThread]: 
[0m22:34:21.607420 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:34:21.609740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:34:21.616496 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:34:21.616772 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:34:21.616957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:22.127847 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.511 seconds
[0m22:34:22.131607 [debug] [ThreadPool]: On list_dev: Close
[0m22:34:22.248941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:34:22.261902 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:34:22.262715 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:34:22.263263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:22.869444 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.606 seconds
[0m22:34:22.871327 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:34:23.018379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78f2b9e0>]}
[0m22:34:23.019805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:34:23.021781 [info ] [MainThread]: 
[0m22:34:23.035755 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:34:23.036701 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m22:34:23.037885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m22:34:23.038482 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:34:23.046631 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:34:23.048186 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:34:23.067032 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:34:23.068503 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:34:23.068775 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m22:34:23.069023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:23.751136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m22:34:23.769417 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m22:34:23.907816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff783137a0>]}
[0m22:34:23.908490 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 0.87s]
[0m22:34:23.909347 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:34:23.910109 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:34:23.910455 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m22:34:23.910983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.crypto_price_momentum)
[0m22:34:23.911242 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m22:34:23.913285 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:34:23.914752 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m22:34:23.916570 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:34:23.917937 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:34:23.918224 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.stg_bitcoin_price
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        -- Calculate price momentum as percentage change over 7 days
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m22:34:23.918505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:24.704397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m22:34:24.709497 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m22:34:24.825300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78bb6600>]}
[0m22:34:24.826305 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.91s]
[0m22:34:24.827564 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:34:24.828063 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:34:24.828725 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m22:34:24.829506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m22:34:24.829912 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:34:24.833117 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:34:24.834355 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:34:24.836380 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:34:24.838395 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:34:24.838757 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m22:34:24.839137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:25.489014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.649 seconds
[0m22:34:25.495223 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m22:34:25.628107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78207e30>]}
[0m22:34:25.630075 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 0.80s]
[0m22:34:25.631959 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:34:25.632936 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:34:25.633775 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m22:34:25.634780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m22:34:25.635492 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:34:25.640953 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:34:25.642589 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:34:25.644809 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:34:25.646437 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:34:25.646876 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m22:34:25.647215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:26.330876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m22:34:26.336732 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m22:34:26.489650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7820fad0>]}
[0m22:34:26.491981 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.85s]
[0m22:34:26.494429 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:34:26.497209 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:34:26.498660 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m22:34:26.500191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m22:34:26.500804 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:34:26.505199 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:34:26.507720 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:34:26.525738 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:34:26.527642 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:34:26.528042 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    price_momentum.price_momentum,
    price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m22:34:26.528411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:27.270716 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85fea-0004-2cf6-0002-787300013a0e
[0m22:34:27.271580 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 4
invalid identifier 'PRICE_MOMENTUM.PRICE_MOMENTUM'
[0m22:34:27.272289 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m22:34:27.411037 [debug] [Thread-1 (]: Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'PRICE_MOMENTUM.PRICE_MOMENTUM'
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m22:34:27.411732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e387983-8889-4b9e-b250-81c98dbc8b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78320530>]}
[0m22:34:27.412767 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model analytics.stg_bitcoin_daily_metrics ...... [[31mERROR[0m in 0.91s]
[0m22:34:27.414085 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:34:27.416401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:27.416796 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m22:34:27.417160 [info ] [MainThread]: 
[0m22:34:27.417792 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 5.81 seconds (5.81s).
[0m22:34:27.418825 [debug] [MainThread]: Command end result
[0m22:34:27.444651 [info ] [MainThread]: 
[0m22:34:27.445721 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:34:27.446039 [info ] [MainThread]: 
[0m22:34:27.446388 [error] [MainThread]:   Database Error in model stg_bitcoin_daily_metrics (models/output/stg_bitcoin_daily_metrics.sql)
  000904 (42000): SQL compilation error: error line 40 at position 4
  invalid identifier 'PRICE_MOMENTUM.PRICE_MOMENTUM'
  compiled code at target/run/crypto_currencies_elt/models/output/stg_bitcoin_daily_metrics.sql
[0m22:34:27.446886 [info ] [MainThread]: 
[0m22:34:27.447172 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:34:27.448182 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.5886307, "process_user_time": 2.93113, "process_kernel_time": 0.2928, "process_mem_max_rss": "209652", "process_out_blocks": "2865", "command_success": false, "process_in_blocks": "0"}
[0m22:34:27.448485 [debug] [MainThread]: Command `dbt run` failed at 22:34:27.448437 after 6.59 seconds
[0m22:34:27.448791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9a9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78b03a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d352b40>]}
[0m22:34:27.449066 [debug] [MainThread]: Flushing usage events
[0m22:35:44.416999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c6a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c09880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a454c0>]}


============================== 22:35:44.421050 | d19e0780-094b-4ea4-9eab-d9a4fe064649 ==============================
[0m22:35:44.421050 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:35:44.421886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:35:44.851390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6db87140>]}
[0m22:35:44.871708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ee1f020>]}
[0m22:35:44.872281 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:35:44.915175 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:35:44.971033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:35:44.971580 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/output/stg_bitcoin_daily_metrics.sql
[0m22:35:45.078785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cb833e0>]}
[0m22:35:45.124698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cf8a630>]}
[0m22:35:45.125001 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m22:35:45.125411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cee7590>]}
[0m22:35:45.126287 [info ] [MainThread]: 
[0m22:35:45.126647 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:35:45.128607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m22:35:45.135065 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m22:35:45.135365 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m22:35:45.135538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:45.650867 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.515 seconds
[0m22:35:45.652660 [debug] [ThreadPool]: On list_dev: Close
[0m22:35:45.805862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m22:35:45.814078 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m22:35:45.814898 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m22:35:45.815296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:46.420659 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.605 seconds
[0m22:35:46.422891 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m22:35:46.554292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d352450>]}
[0m22:35:46.555406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:46.556299 [info ] [MainThread]: 
[0m22:35:46.565610 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:35:46.567041 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.stg_bitcoin_price ........................ [RUN]
[0m22:35:46.567920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.stg_bitcoin_price)
[0m22:35:46.568254 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:35:46.574092 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:35:46.575654 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:35:46.589413 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:35:46.591020 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_price"
[0m22:35:46.591282 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_price"} */
create or replace   view dev.analytics.stg_bitcoin_price
  
   as (
    WITH stg_bitcoin_price AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM stg_bitcoin_price
  );
[0m22:35:46.591543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:47.224084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m22:35:47.245245 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_price: Close
[0m22:35:47.364123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d5006e0>]}
[0m22:35:47.366285 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.stg_bitcoin_price ................... [[32mSUCCESS 1[0m in 0.79s]
[0m22:35:47.368451 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_price
[0m22:35:47.370765 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:35:47.371703 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m22:35:47.372889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.stg_bitcoin_price, now model.crypto_currencies_elt.crypto_price_momentum)
[0m22:35:47.373315 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m22:35:47.376707 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:35:47.379505 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m22:35:47.381901 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:35:47.383986 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m22:35:47.384453 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.stg_bitcoin_price
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        -- Calculate price momentum as percentage change over 7 days
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m22:35:47.384904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:48.132906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m22:35:48.138641 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m22:35:48.292667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c2411f0>]}
[0m22:35:48.295223 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.92s]
[0m22:35:48.297736 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m22:35:48.298877 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:35:48.299840 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.fact_bitcoin_daily_with_rsi .............. [RUN]
[0m22:35:48.301561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi)
[0m22:35:48.302633 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:35:48.306752 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:35:48.308537 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:35:48.311302 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:35:48.313937 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"
[0m22:35:48.314467 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.stg_bitcoin_price
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m22:35:48.314951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:48.989089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m22:35:48.994448 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi: Close
[0m22:35:49.128921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c218290>]}
[0m22:35:49.131241 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_rsi ......... [[32mSUCCESS 1[0m in 0.83s]
[0m22:35:49.133379 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi
[0m22:35:49.134828 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:35:49.136046 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.fact_bitcoin_daily_with_sma .............. [RUN]
[0m22:35:49.137303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_rsi, now model.crypto_currencies_elt.fact_bitcoin_daily_with_sma)
[0m22:35:49.138194 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:35:49.144229 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:35:49.146084 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:35:49.149050 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:35:49.151134 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"
[0m22:35:49.151636 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.fact_bitcoin_daily_with_sma"} */
create or replace   view dev.analytics.fact_bitcoin_daily_with_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.stg_bitcoin_price
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m22:35:49.152047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:49.842504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m22:35:49.847624 [debug] [Thread-1 (]: On model.crypto_currencies_elt.fact_bitcoin_daily_with_sma: Close
[0m22:35:50.001015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c26bad0>]}
[0m22:35:50.002351 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.fact_bitcoin_daily_with_sma ......... [[32mSUCCESS 1[0m in 0.86s]
[0m22:35:50.003901 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.fact_bitcoin_daily_with_sma
[0m22:35:50.005086 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:35:50.006461 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.stg_bitcoin_daily_metrics ............... [RUN]
[0m22:35:50.007760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.fact_bitcoin_daily_with_sma, now model.crypto_currencies_elt.stg_bitcoin_daily_metrics)
[0m22:35:50.008302 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:35:50.011902 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:35:50.013557 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:35:50.028626 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:35:50.030322 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"
[0m22:35:50.030644 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.stg_bitcoin_daily_metrics"} */
create or replace transient table dev.analytics.stg_bitcoin_daily_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.fact_bitcoin_daily_with_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.fact_bitcoin_daily_with_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m22:35:50.031011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:35:51.815871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.784 seconds
[0m22:35:51.820335 [debug] [Thread-1 (]: On model.crypto_currencies_elt.stg_bitcoin_daily_metrics: Close
[0m22:35:51.951322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19e0780-094b-4ea4-9eab-d9a4fe064649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c337d70>]}
[0m22:35:51.953875 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.stg_bitcoin_daily_metrics .......... [[32mSUCCESS 1[0m in 1.94s]
[0m22:35:51.956854 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.stg_bitcoin_daily_metrics
[0m22:35:51.960342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:51.961183 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.stg_bitcoin_daily_metrics' was properly closed.
[0m22:35:51.962560 [info ] [MainThread]: 
[0m22:35:51.963748 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 6.84 seconds (6.84s).
[0m22:35:51.965638 [debug] [MainThread]: Command end result
[0m22:35:52.001547 [info ] [MainThread]: 
[0m22:35:52.002460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:35:52.003126 [info ] [MainThread]: 
[0m22:35:52.003800 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:35:52.005299 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6325693, "process_user_time": 2.856251, "process_kernel_time": 0.269154, "process_mem_max_rss": "209244", "process_out_blocks": "2863", "process_in_blocks": "0"}
[0m22:35:52.005695 [debug] [MainThread]: Command `dbt run` succeeded at 22:35:52.005636 after 7.63 seconds
[0m22:35:52.005953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b582c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d352420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914c67e0>]}
[0m22:35:52.006215 [debug] [MainThread]: Flushing usage events
[0m22:35:55.618808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969cf500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99521100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986f96d0>]}


============================== 22:35:55.622520 | d26f0cd9-2620-436d-aa3e-6ff450cd2280 ==============================
[0m22:35:55.622520 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:35:55.623108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:35:56.024175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd26f0cd9-2620-436d-aa3e-6ff450cd2280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7447bc20>]}
[0m22:35:56.044586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd26f0cd9-2620-436d-aa3e-6ff450cd2280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ef158b0>]}
[0m22:35:56.045231 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:35:56.086761 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:35:56.139889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:35:56.140271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:35:56.152872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd26f0cd9-2620-436d-aa3e-6ff450cd2280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970118b0>]}
[0m22:35:56.213160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd26f0cd9-2620-436d-aa3e-6ff450cd2280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e70ce00>]}
[0m22:35:56.213664 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m22:35:56.214219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd26f0cd9-2620-436d-aa3e-6ff450cd2280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e955940>]}
[0m22:35:56.215031 [info ] [MainThread]: 
[0m22:35:56.215369 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:35:56.216272 [debug] [MainThread]: Command end result
[0m22:35:56.232779 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6555081, "process_user_time": 2.213552, "process_kernel_time": 0.143104, "process_mem_max_rss": "209248", "process_out_blocks": "1854", "process_in_blocks": "0"}
[0m22:35:56.233094 [debug] [MainThread]: Command `dbt test` succeeded at 22:35:56.233049 after 0.66 seconds
[0m22:35:56.233327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9827f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9acadf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e9719a0>]}
[0m22:35:56.233536 [debug] [MainThread]: Flushing usage events
[0m22:35:59.349341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ad2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ad2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8e63f0>]}


============================== 22:35:59.352671 | b8660e44-f256-4f9a-a1a0-0bcb4cc8c0a7 ==============================
[0m22:35:59.352671 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:35:59.353282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:35:59.776400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8660e44-f256-4f9a-a1a0-0bcb4cc8c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9922fe60>]}
[0m22:35:59.825912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8660e44-f256-4f9a-a1a0-0bcb4cc8c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982b8f20>]}
[0m22:35:59.826795 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:35:59.883851 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:35:59.939524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:35:59.939949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:35:59.952900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8660e44-f256-4f9a-a1a0-0bcb4cc8c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74044a10>]}
[0m22:36:00.015408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8660e44-f256-4f9a-a1a0-0bcb4cc8c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fdf8b60>]}
[0m22:36:00.015841 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m22:36:00.016496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8660e44-f256-4f9a-a1a0-0bcb4cc8c0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6fd1cfe0>]}
[0m22:36:00.017482 [info ] [MainThread]: 
[0m22:36:00.017857 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:36:00.018877 [debug] [MainThread]: Command end result
[0m22:36:00.034733 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.723205, "process_user_time": 2.321488, "process_kernel_time": 0.13907, "process_mem_max_rss": "209236", "process_out_blocks": "1854", "process_in_blocks": "0"}
[0m22:36:00.035142 [debug] [MainThread]: Command `dbt snapshot` succeeded at 22:36:00.035077 after 0.72 seconds
[0m22:36:00.035410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97915010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9791ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74440740>]}
[0m22:36:00.035636 [debug] [MainThread]: Flushing usage events
[0m23:01:15.451490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c561790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5625a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c562ae0>]}


============================== 23:01:15.455680 | f97a6bb8-3223-46f0-8e37-6143893c0c39 ==============================
[0m23:01:15.455680 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:01:15.456409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:15.942235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75d98ce0>]}
[0m23:01:15.974313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75d77020>]}
[0m23:01:15.974920 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:01:16.021567 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:01:16.101992 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 1 files changed.
[0m23:01:16.102431 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://models/input/crypto_rsi.sql
[0m23:01:16.102741 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://models/output/crypto_abstract_metrics.sql
[0m23:01:16.102998 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://models/input/crypto_sma.sql
[0m23:01:16.103162 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://models/input/crypto_staging.sql
[0m23:01:16.103321 [debug] [MainThread]: Partial parsing: deleted file: crypto_currencies_elt://models/input/fact_bitcoin_daily_with_sma.sql
[0m23:01:16.103471 [debug] [MainThread]: Partial parsing: deleted file: crypto_currencies_elt://models/input/fact_bitcoin_daily_with_rsi.sql
[0m23:01:16.103741 [debug] [MainThread]: Partial parsing: deleted file: crypto_currencies_elt://models/input/stg_bitcoin_price.sql
[0m23:01:16.103927 [debug] [MainThread]: Partial parsing: deleted file: crypto_currencies_elt://models/output/stg_bitcoin_daily_metrics.sql
[0m23:01:16.104107 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/input/crypto_price_momentum.sql
[0m23:01:16.218893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff689a9580>]}
[0m23:01:16.279274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68a2e360>]}
[0m23:01:16.279732 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:01:16.279990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff685644a0>]}
[0m23:01:16.280852 [info ] [MainThread]: 
[0m23:01:16.281172 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:01:16.283273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:01:16.289765 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:01:16.290178 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:01:16.290412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:16.910969 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.620 seconds
[0m23:01:16.914388 [debug] [ThreadPool]: On list_dev: Close
[0m23:01:17.064454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m23:01:17.079106 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:01:17.079897 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:01:17.080430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:01:17.798726 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.718 seconds
[0m23:01:17.800978 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:01:18.089622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68c65c40>]}
[0m23:01:18.091224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:01:18.092142 [info ] [MainThread]: 
[0m23:01:18.106044 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m23:01:18.107068 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m23:01:18.107845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m23:01:18.108361 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m23:01:18.115701 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m23:01:18.118274 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m23:01:18.138976 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m23:01:18.140938 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m23:01:18.141227 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m23:01:18.141476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:18.989123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m23:01:19.015630 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m23:01:19.153432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68fa4770>]}
[0m23:01:19.156025 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 1.04s]
[0m23:01:19.158027 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m23:01:19.160219 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m23:01:19.162334 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m23:01:19.163564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m23:01:19.164320 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m23:01:19.170431 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:01:19.174133 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m23:01:19.180087 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:01:19.184542 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:01:19.185662 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m23:01:19.186312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:20.039170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.852 seconds
[0m23:01:20.050569 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m23:01:20.219499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6804c620>]}
[0m23:01:20.222073 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 1.06s]
[0m23:01:20.224451 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m23:01:20.225732 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m23:01:20.227334 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m23:01:20.229060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m23:01:20.230004 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m23:01:20.236268 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m23:01:20.238130 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m23:01:20.241752 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m23:01:20.244040 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m23:01:20.244492 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m23:01:20.244955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:20.919817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m23:01:20.924019 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m23:01:21.094957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63f62000>]}
[0m23:01:21.096153 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.87s]
[0m23:01:21.097140 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m23:01:21.097829 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m23:01:21.098596 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m23:01:21.099357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m23:01:21.100193 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m23:01:21.103579 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m23:01:21.104974 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m23:01:21.107502 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m23:01:21.108922 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m23:01:21.109234 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m23:01:21.109530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:22.011371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.902 seconds
[0m23:01:22.015408 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m23:01:22.189146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63f6c440>]}
[0m23:01:22.190589 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 1.09s]
[0m23:01:22.191585 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m23:01:22.193669 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:01:22.194562 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m23:01:22.195385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m23:01:22.195952 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:01:22.200920 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:01:22.202886 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:01:22.223346 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:01:22.225370 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:01:22.225769 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m23:01:22.226133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:01:24.412447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.186 seconds
[0m23:01:24.416773 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m23:01:24.551168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f97a6bb8-3223-46f0-8e37-6143893c0c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6806fcb0>]}
[0m23:01:24.553046 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 2.36s]
[0m23:01:24.554330 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:01:24.557080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:24.558290 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m23:01:24.559098 [info ] [MainThread]: 
[0m23:01:24.559715 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 8.28 seconds (8.28s).
[0m23:01:24.561610 [debug] [MainThread]: Command end result
[0m23:01:24.598790 [info ] [MainThread]: 
[0m23:01:24.599351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:01:24.599789 [info ] [MainThread]: 
[0m23:01:24.600276 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:01:24.601425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.198471, "process_user_time": 3.03992, "process_kernel_time": 0.242775, "process_mem_max_rss": "205308", "process_out_blocks": "2856", "process_in_blocks": "0"}
[0m23:01:24.601895 [debug] [MainThread]: Command `dbt run` succeeded at 23:01:24.601793 after 9.20 seconds
[0m23:01:24.602240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c71e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9532f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c923860>]}
[0m23:01:24.602585 [debug] [MainThread]: Flushing usage events
[0m23:01:27.357559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ab6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ab6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ab6030>]}


============================== 23:01:27.361068 | 3f6c44f4-88e7-429e-9f0f-a2d480bc0f6e ==============================
[0m23:01:27.361068 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:01:27.361802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:27.802176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f6c44f4-88e7-429e-9f0f-a2d480bc0f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986e8ec0>]}
[0m23:01:27.859639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f6c44f4-88e7-429e-9f0f-a2d480bc0f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff754278c0>]}
[0m23:01:27.860773 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:01:27.904513 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:01:27.967260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:27.967564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:27.981550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f6c44f4-88e7-429e-9f0f-a2d480bc0f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76882e70>]}
[0m23:01:28.035913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f6c44f4-88e7-429e-9f0f-a2d480bc0f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74d30260>]}
[0m23:01:28.036216 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:01:28.036661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f6c44f4-88e7-429e-9f0f-a2d480bc0f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74d5dee0>]}
[0m23:01:28.037374 [info ] [MainThread]: 
[0m23:01:28.037713 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:01:28.038630 [debug] [MainThread]: Command end result
[0m23:01:28.053228 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.73692983, "process_user_time": 2.314663, "process_kernel_time": 0.171694, "process_mem_max_rss": "205300", "process_out_blocks": "1850", "process_in_blocks": "0"}
[0m23:01:28.053580 [debug] [MainThread]: Command `dbt test` succeeded at 23:01:28.053530 after 0.74 seconds
[0m23:01:28.053784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997ebc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74ad7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce4d040>]}
[0m23:01:28.053954 [debug] [MainThread]: Flushing usage events
[0m23:01:30.336551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cccd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce1d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dec6030>]}


============================== 23:01:30.339955 | 51263c6b-f9e4-4096-a52a-191701732339 ==============================
[0m23:01:30.339955 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:01:30.340627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m23:01:30.728436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51263c6b-f9e4-4096-a52a-191701732339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff53aba7e0>]}
[0m23:01:30.749065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51263c6b-f9e4-4096-a52a-191701732339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff58681ac0>]}
[0m23:01:30.749630 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:01:30.793868 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:01:30.844485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:01:30.844836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:01:30.857887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51263c6b-f9e4-4096-a52a-191701732339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5366dc70>]}
[0m23:01:30.907690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51263c6b-f9e4-4096-a52a-191701732339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5346bc80>]}
[0m23:01:30.907990 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:01:30.908402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51263c6b-f9e4-4096-a52a-191701732339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5369a060>]}
[0m23:01:30.909165 [info ] [MainThread]: 
[0m23:01:30.909477 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:01:30.910342 [debug] [MainThread]: Command end result
[0m23:01:30.926156 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.6265551, "process_user_time": 2.203044, "process_kernel_time": 0.100276, "process_mem_max_rss": "205308", "process_out_blocks": "1850", "process_in_blocks": "0"}
[0m23:01:30.926494 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:01:30.926452 after 0.63 seconds
[0m23:01:30.926699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cccd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b033470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2fb770>]}
[0m23:01:30.926874 [debug] [MainThread]: Flushing usage events
[0m23:13:45.479070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d1e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d1e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b626f0>]}


============================== 23:13:45.484003 | 88211ad3-dfb9-4c2e-978f-e723df980d05 ==============================
[0m23:13:45.484003 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:13:45.484901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m23:13:45.947099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88211ad3-dfb9-4c2e-978f-e723df980d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99398ce0>]}
[0m23:13:45.976328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88211ad3-dfb9-4c2e-978f-e723df980d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867c8ce0>]}
[0m23:13:45.976999 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:13:46.025390 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:13:46.089560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:13:46.090060 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/schema.yml
[0m23:13:46.113168 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:13:46.113793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '88211ad3-dfb9-4c2e-978f-e723df980d05', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86372060>]}
[0m23:13:46.118490 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'analysis_crypto_currencies' in the 'models' section of file 'models/schema.yml'
[0m23:13:46.171038 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test arguments must be a dict, got <class 'list'> (value [0, 100000])
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m23:13:46.171937 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7397778, "process_user_time": 2.246459, "process_kernel_time": 0.246086, "process_mem_max_rss": "209236", "process_out_blocks": "6", "command_success": false, "process_in_blocks": "0"}
[0m23:13:46.172277 [debug] [MainThread]: Command `dbt run` failed at 23:13:46.172231 after 0.74 seconds
[0m23:13:46.172540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b626f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e1ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8634a060>]}
[0m23:13:46.172840 [debug] [MainThread]: Flushing usage events
[0m23:15:50.831886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e6a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae09760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9377a10>]}


============================== 23:15:50.836809 | c9016e9b-f775-4f68-8fdc-1aa17d98a016 ==============================
[0m23:15:50.836809 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:15:50.837450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:15:51.287145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9016e9b-f775-4f68-8fdc-1aa17d98a016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5c3890>]}
[0m23:15:51.309508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9016e9b-f775-4f68-8fdc-1aa17d98a016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6ce690>]}
[0m23:15:51.310087 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:15:51.355974 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:15:51.413515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:15:51.414013 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/schema.yml
[0m23:15:51.443416 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'analysis_crypto_currencies' in the 'models' section of file 'models/schema.yml'
[0m23:15:51.501076 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test arguments must be a dict, got <class 'list'> (value [0, 100000])
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m23:15:51.502072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7171139, "process_user_time": 2.162758, "process_kernel_time": 0.224293, "process_mem_max_rss": "209224", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:15:51.502798 [debug] [MainThread]: Command `dbt run` failed at 23:15:51.502735 after 0.72 seconds
[0m23:15:51.503068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd516a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950d8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95557170>]}
[0m23:15:51.503300 [debug] [MainThread]: Flushing usage events
[0m23:16:59.162261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950deb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955e2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e09b50>]}


============================== 23:16:59.166745 | 6f3e8a99-afe1-4a45-b960-e319f0b4fa6d ==============================
[0m23:16:59.166745 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:16:59.167139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:16:59.591797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f99340>]}
[0m23:16:59.611821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950aa270>]}
[0m23:16:59.612439 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:16:59.654304 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:16:59.707687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:16:59.708194 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/schema.yml
[0m23:16:59.733939 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'analysis_crypto_currencies' in the 'models' section of file 'models/schema.yml'
[0m23:16:59.796710 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.unique_analysis_crypto_currencies_symbol.41c2819f5c' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.797335 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_symbol.2689d6bf11' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.797619 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_date.897053daf1' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.797942 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.unique_analysis_crypto_currencies_date.3936a62c33' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.798311 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_price_close.59697cbc93' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.798648 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.relationships_analysis_crypto_currencies_price_close__price_close__ref_stg_bitcoin_price_.c64bf3bd61' (models/schema.yml) depends on a node named 'stg_bitcoin_price' in package '' which was not found
[0m23:16:59.798945 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.relationships_analysis_crypto_currencies_price_close__price_close__ref_stg_bitcoin_price_.c64bf3bd61' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.799241 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_sma_7d.ea7b3d820d' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.799514 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_rsi_14d.4850c5ff97' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.799772 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_volume_traded.58922fe50a' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.800014 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_trades_count.6bc452e87f' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.800239 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_price_momentum.52ca1233ca' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.800495 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.relationships_analysis_crypto_currencies_price_momentum__price_momentum__ref_price_momentum_.eaa77cc5d0' (models/schema.yml) depends on a node named 'price_momentum' in package '' which was not found
[0m23:16:59.800719 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.relationships_analysis_crypto_currencies_price_momentum__price_momentum__ref_price_momentum_.eaa77cc5d0' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.800934 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_momentum_direction.6eeeece60d' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.801161 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.accepted_values_analysis_crypto_currencies_momentum_direction__Positive__Negative__Neutral.4b548b5fc1' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m23:16:59.830447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff711aa9f0>]}
[0m23:16:59.875425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713d4650>]}
[0m23:16:59.875709 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:16:59.876073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956efad0>]}
[0m23:16:59.876915 [info ] [MainThread]: 
[0m23:16:59.877316 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:16:59.879628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:16:59.885629 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:16:59.885869 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:16:59.886038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:17:00.432157 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.546 seconds
[0m23:17:00.434545 [debug] [ThreadPool]: On list_dev: Close
[0m23:17:00.602812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m23:17:00.616717 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:17:00.617446 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:17:00.617831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:17:01.155337 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m23:17:01.159349 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:17:01.324625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7111b110>]}
[0m23:17:01.326455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:17:01.327533 [info ] [MainThread]: 
[0m23:17:01.342678 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m23:17:01.343696 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m23:17:01.344848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m23:17:01.345372 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m23:17:01.354595 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m23:17:01.357009 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m23:17:01.375271 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m23:17:01.377026 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m23:17:01.377325 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m23:17:01.377620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:02.270087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.892 seconds
[0m23:17:02.299032 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m23:17:02.442979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95556090>]}
[0m23:17:02.445295 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 1.10s]
[0m23:17:02.446952 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m23:17:02.449175 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m23:17:02.450488 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m23:17:02.451349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m23:17:02.452024 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m23:17:02.455699 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:17:02.457461 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m23:17:02.460153 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:17:02.462496 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:17:02.462977 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m23:17:02.463440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:03.396734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m23:17:03.398064 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m23:17:03.565106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70e63bf0>]}
[0m23:17:03.565648 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 1.11s]
[0m23:17:03.566361 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m23:17:03.567640 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m23:17:03.568182 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m23:17:03.568857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m23:17:03.569272 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m23:17:03.571366 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m23:17:03.572447 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m23:17:03.573685 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m23:17:03.574790 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m23:17:03.575025 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m23:17:03.575220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:04.301978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m23:17:04.304334 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m23:17:04.451991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7059bf20>]}
[0m23:17:04.452666 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.88s]
[0m23:17:04.453397 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m23:17:04.453825 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m23:17:04.454300 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m23:17:04.454910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m23:17:04.455244 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m23:17:04.457783 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m23:17:04.459042 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m23:17:04.460551 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m23:17:04.462582 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m23:17:04.462860 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m23:17:04.463113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:05.080695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m23:17:05.086356 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m23:17:05.258017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7044b740>]}
[0m23:17:05.258771 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.80s]
[0m23:17:05.259338 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m23:17:05.260031 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:17:05.260373 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m23:17:05.260812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m23:17:05.261066 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:17:05.263850 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:17:05.264626 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:17:05.274093 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:17:05.275283 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:17:05.275542 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m23:17:05.275858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:17:07.593318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.317 seconds
[0m23:17:07.596871 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m23:17:07.753564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f3e8a99-afe1-4a45-b960-e319f0b4fa6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70499340>]}
[0m23:17:07.755858 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 2.49s]
[0m23:17:07.757720 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:17:07.761022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:17:07.762047 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m23:17:07.762836 [info ] [MainThread]: 
[0m23:17:07.763578 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m23:17:07.766122 [debug] [MainThread]: Command end result
[0m23:17:07.803283 [info ] [MainThread]: 
[0m23:17:07.804429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:17:07.804894 [info ] [MainThread]: 
[0m23:17:07.805394 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:17:07.808294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.689823, "process_user_time": 2.822906, "process_kernel_time": 0.212992, "process_mem_max_rss": "209248", "process_out_blocks": "3056", "process_in_blocks": "0"}
[0m23:17:07.808946 [debug] [MainThread]: Command `dbt run` succeeded at 23:17:07.808870 after 8.69 seconds
[0m23:17:07.809348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959bbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7165f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b58170>]}
[0m23:17:07.809639 [debug] [MainThread]: Flushing usage events
[0m23:17:11.173948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf6f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e208ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce5cc80>]}


============================== 23:17:11.178477 | 25c8cdf5-9801-4002-a366-caca78d3fd47 ==============================
[0m23:17:11.178477 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:17:11.179082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m23:17:11.573098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25c8cdf5-9801-4002-a366-caca78d3fd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78dd2cc0>]}
[0m23:17:11.593460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25c8cdf5-9801-4002-a366-caca78d3fd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d58b380>]}
[0m23:17:11.594014 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:17:11.636115 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:17:11.689050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:17:11.689390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:17:11.706193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25c8cdf5-9801-4002-a366-caca78d3fd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78dd3c80>]}
[0m23:17:11.761365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25c8cdf5-9801-4002-a366-caca78d3fd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78734050>]}
[0m23:17:11.761871 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:17:11.762447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c8cdf5-9801-4002-a366-caca78d3fd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7870ede0>]}
[0m23:17:11.763270 [info ] [MainThread]: 
[0m23:17:11.763562 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:17:11.764393 [debug] [MainThread]: Command end result
[0m23:17:11.781891 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6494505, "process_user_time": 2.236451, "process_kernel_time": 0.135027, "process_mem_max_rss": "209248", "process_out_blocks": "2002", "process_in_blocks": "0"}
[0m23:17:11.782222 [debug] [MainThread]: Command `dbt test` succeeded at 23:17:11.782177 after 0.65 seconds
[0m23:17:11.782466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cc87080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7271d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a95e9c0>]}
[0m23:17:11.782745 [debug] [MainThread]: Flushing usage events
[0m23:17:14.729149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa200f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ae57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28c0740>]}


============================== 23:17:14.732343 | dfa83ca8-5d99-4e6b-a5dd-9b08d7ebb083 ==============================
[0m23:17:14.732343 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:17:14.733051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:17:15.132519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfa83ca8-5d99-4e6b-a5dd-9b08d7ebb083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adcaf60>]}
[0m23:17:15.166024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfa83ca8-5d99-4e6b-a5dd-9b08d7ebb083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a5872c0>]}
[0m23:17:15.166706 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:17:15.212788 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:17:15.264712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:17:15.265118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:17:15.282504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfa83ca8-5d99-4e6b-a5dd-9b08d7ebb083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6b73b0>]}
[0m23:17:15.335520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfa83ca8-5d99-4e6b-a5dd-9b08d7ebb083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79fbba10>]}
[0m23:17:15.336126 [info ] [MainThread]: Found 5 models, 2 sources, 459 macros
[0m23:17:15.336721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfa83ca8-5d99-4e6b-a5dd-9b08d7ebb083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa316dee0>]}
[0m23:17:15.337727 [info ] [MainThread]: 
[0m23:17:15.338067 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:17:15.339091 [debug] [MainThread]: Command end result
[0m23:17:15.361522 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 0.67026424, "process_user_time": 2.257163, "process_kernel_time": 0.111402, "process_mem_max_rss": "209236", "process_out_blocks": "2002", "process_in_blocks": "0"}
[0m23:17:15.361965 [debug] [MainThread]: Command `dbt snapshot` succeeded at 23:17:15.361898 after 0.67 seconds
[0m23:17:15.362225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa200d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d2a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa316dee0>]}
[0m23:17:15.362440 [debug] [MainThread]: Flushing usage events
[0m23:25:18.132587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813ab6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838924e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ab6090>]}


============================== 23:25:18.136371 | 5fa13ec0-6948-4061-9261-997cb000fef8 ==============================
[0m23:25:18.136371 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:25:18.137189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:25:18.536088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fa13ec0-6948-4061-9261-997cb000fef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a1a0ce0>]}
[0m23:25:18.555502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fa13ec0-6948-4061-9261-997cb000fef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d069c0>]}
[0m23:25:18.556091 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:25:18.598151 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:25:18.652218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:25:18.652814 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_analysis.sql
[0m23:25:18.656644 [error] [MainThread]: Encountered an error:
Compilation Error
  Reached EOF without finding a close tag for snapshot (searched from line 1)
[0m23:25:18.657404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5657131, "process_user_time": 2.23053, "process_kernel_time": 0.186048, "process_mem_max_rss": "205308", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:25:18.657699 [debug] [MainThread]: Command `dbt run` failed at 23:25:18.657656 after 0.57 seconds
[0m23:25:18.657946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80aa7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d013410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e89f770>]}
[0m23:25:18.658195 [debug] [MainThread]: Flushing usage events
[0m23:26:45.535358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828f1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84de14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82102120>]}


============================== 23:26:45.540189 | e2abe9fe-123e-4c35-a22b-c9c0ecf2b3a6 ==============================
[0m23:26:45.540189 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:26:45.540914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:26:46.004919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2abe9fe-123e-4c35-a22b-c9c0ecf2b3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5bd99820>]}
[0m23:26:46.027165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2abe9fe-123e-4c35-a22b-c9c0ecf2b3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5a8f94c0>]}
[0m23:26:46.027744 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:26:46.078880 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:26:46.137291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:26:46.137714 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_analysis.sql
[0m23:26:46.220850 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.crypto_currencies_elt.snapshot_crypto_abstract_analysis' (snapshots/snapshot_crypto_abstract_analysis.sql) depends on a node named 'crypto_abstract_analysis' which was not found
[0m23:26:46.221750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7388491, "process_user_time": 2.30216, "process_kernel_time": 0.210614, "process_mem_max_rss": "205308", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:26:46.222034 [debug] [MainThread]: Command `dbt run` failed at 23:26:46.221991 after 0.74 seconds
[0m23:26:46.222251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d41dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1a0e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8334d2e0>]}
[0m23:26:46.222493 [debug] [MainThread]: Flushing usage events
[0m23:28:00.651004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99036d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9922f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99036900>]}


============================== 23:28:00.654797 | 7c65622d-fd5e-4810-a324-750407cdaf9e ==============================
[0m23:28:00.654797 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:28:00.655182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:28:01.061017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97baf770>]}
[0m23:28:01.085138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74900cb0>]}
[0m23:28:01.085698 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:28:01.127418 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:28:01.180269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:28:01.180751 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:28:01.291990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff744f0fb0>]}
[0m23:28:01.342326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7443f140>]}
[0m23:28:01.342626 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m23:28:01.342841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74279c70>]}
[0m23:28:01.343733 [info ] [MainThread]: 
[0m23:28:01.344146 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:28:01.346198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:28:01.352451 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:28:01.352735 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:28:01.352888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:01.983867 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.631 seconds
[0m23:28:01.985323 [debug] [ThreadPool]: On list_dev: Close
[0m23:28:02.097593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m23:28:02.106224 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:28:02.106707 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:28:02.107047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:02.727221 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.620 seconds
[0m23:28:02.730759 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:28:02.857403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m23:28:02.861980 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m23:28:02.863137 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m23:28:02.864202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:03.380009 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b86020-0004-2ced-0000-00027873fa61
[0m23:28:03.381810 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m23:28:03.383234 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:28:03.384202 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:28:03.385055 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m23:28:03.560452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74152a20>]}
[0m23:28:03.562491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:28:03.564862 [info ] [MainThread]: 
[0m23:28:03.578322 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m23:28:03.579225 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m23:28:03.580233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m23:28:03.580870 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m23:28:03.587823 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m23:28:03.589535 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m23:28:03.608533 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m23:28:03.610350 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m23:28:03.610701 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m23:28:03.610999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:04.808708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.197 seconds
[0m23:28:04.835634 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m23:28:04.965405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986da060>]}
[0m23:28:04.966984 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 1.38s]
[0m23:28:04.967992 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m23:28:04.969630 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m23:28:04.970435 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m23:28:04.971172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m23:28:04.971576 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m23:28:04.974788 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:28:04.977561 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m23:28:04.980051 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:28:04.982130 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:28:04.982477 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m23:28:04.982784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:05.705309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m23:28:05.710771 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m23:28:05.846390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f52ca40>]}
[0m23:28:05.847261 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.88s]
[0m23:28:05.848172 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m23:28:05.848570 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m23:28:05.848977 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m23:28:05.849474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m23:28:05.849762 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m23:28:05.852230 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m23:28:05.853381 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m23:28:05.855668 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m23:28:05.857794 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m23:28:05.858329 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m23:28:05.858701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:06.711891 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.853 seconds
[0m23:28:06.717348 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m23:28:06.859930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f527140>]}
[0m23:28:06.862108 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 1.01s]
[0m23:28:06.863756 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m23:28:06.864961 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m23:28:06.866429 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m23:28:06.868559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m23:28:06.869748 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m23:28:06.873842 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m23:28:06.875891 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m23:28:06.878803 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m23:28:06.880732 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m23:28:06.881184 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m23:28:06.881551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:07.570041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m23:28:07.574222 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m23:28:07.687755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f52cef0>]}
[0m23:28:07.690056 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.82s]
[0m23:28:07.693020 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m23:28:07.694812 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:28:07.695572 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m23:28:07.696801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m23:28:07.697505 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:28:07.702420 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:28:07.704974 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:28:07.723459 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:28:07.725338 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:28:07.725692 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m23:28:07.726076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:09.575029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.848 seconds
[0m23:28:09.581521 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m23:28:09.817816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c65622d-fd5e-4810-a324-750407cdaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f3368a0>]}
[0m23:28:09.820059 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 2.12s]
[0m23:28:09.823520 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:28:09.826581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:09.827435 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m23:28:09.828290 [info ] [MainThread]: 
[0m23:28:09.828908 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m23:28:09.830870 [debug] [MainThread]: Command end result
[0m23:28:09.861187 [info ] [MainThread]: 
[0m23:28:09.861826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:28:09.862342 [info ] [MainThread]: 
[0m23:28:09.863910 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:28:09.865907 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.25312, "process_user_time": 2.885445, "process_kernel_time": 0.254568, "process_mem_max_rss": "205808", "process_out_blocks": "3029", "process_in_blocks": "0"}
[0m23:28:09.866981 [debug] [MainThread]: Command `dbt run` succeeded at 23:28:09.866598 after 9.25 seconds
[0m23:28:09.867843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9922f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7427aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f226f0>]}
[0m23:28:09.868349 [debug] [MainThread]: Flushing usage events
[0m23:28:12.625460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998a59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aee9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9925ee10>]}


============================== 23:28:12.628955 | 13984e62-d0b1-4eca-83b7-e9e751f0661d ==============================
[0m23:28:12.628955 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:28:12.629486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:28:13.017813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13984e62-d0b1-4eca-83b7-e9e751f0661d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2b0650>]}
[0m23:28:13.037921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13984e62-d0b1-4eca-83b7-e9e751f0661d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a703a70>]}
[0m23:28:13.038482 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:28:13.083954 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:28:13.144170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:28:13.144505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:28:13.161752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13984e62-d0b1-4eca-83b7-e9e751f0661d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75677470>]}
[0m23:28:13.222238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13984e62-d0b1-4eca-83b7-e9e751f0661d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74fc6ed0>]}
[0m23:28:13.222602 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m23:28:13.223035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13984e62-d0b1-4eca-83b7-e9e751f0661d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff754f4fe0>]}
[0m23:28:13.223897 [info ] [MainThread]: 
[0m23:28:13.224258 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:28:13.225155 [debug] [MainThread]: Command end result
[0m23:28:13.242591 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6542704, "process_user_time": 2.300623, "process_kernel_time": 0.116369, "process_mem_max_rss": "205308", "process_out_blocks": "1971", "process_in_blocks": "0"}
[0m23:28:13.242920 [debug] [MainThread]: Command `dbt test` succeeded at 23:28:13.242876 after 0.65 seconds
[0m23:28:13.243128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d60aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff75676ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff751cab40>]}
[0m23:28:13.243314 [debug] [MainThread]: Flushing usage events
[0m23:28:15.407381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa9d9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab7bd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab7bc5f0>]}


============================== 23:28:15.412021 | e17e4ea3-355d-4197-acad-183059f8ffe3 ==============================
[0m23:28:15.412021 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:28:15.412720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m23:28:15.815362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e17e4ea3-355d-4197-acad-183059f8ffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac02fb00>]}
[0m23:28:15.835206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e17e4ea3-355d-4197-acad-183059f8ffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831e30e0>]}
[0m23:28:15.835747 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:28:15.879587 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:28:15.937684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:28:15.938035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:28:15.955039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e17e4ea3-355d-4197-acad-183059f8ffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e9d850>]}
[0m23:28:16.011134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e17e4ea3-355d-4197-acad-183059f8ffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ee5970>]}
[0m23:28:16.011490 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m23:28:16.011890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e17e4ea3-355d-4197-acad-183059f8ffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82bb79e0>]}
[0m23:28:16.012740 [info ] [MainThread]: 
[0m23:28:16.013137 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:28:16.013661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:28:16.020783 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:28:16.021107 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:28:16.021278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:16.518880 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.497 seconds
[0m23:28:16.522365 [debug] [ThreadPool]: On list_dev: Close
[0m23:28:16.663968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_snapshot)
[0m23:28:16.665571 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "snapshot"
"
[0m23:28:16.673453 [debug] [ThreadPool]: Using snowflake connection "create_dev_snapshot"
[0m23:28:16.674546 [debug] [ThreadPool]: On create_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "create_dev_snapshot"} */
create schema if not exists dev.snapshot
[0m23:28:16.675011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:17.254443 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.579 seconds
[0m23:28:17.255333 [debug] [ThreadPool]: On create_dev_snapshot: Close
[0m23:28:17.378031 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_snapshot, now list_dev_snapshot)
[0m23:28:17.382348 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m23:28:17.382664 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m23:28:17.382945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:17.897879 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.515 seconds
[0m23:28:17.898828 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m23:28:18.037116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m23:28:18.039327 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:28:18.039636 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:28:18.039901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:19.559138 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.519 seconds
[0m23:28:19.561836 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:28:19.686569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e17e4ea3-355d-4197-acad-183059f8ffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7197c50>]}
[0m23:28:19.688510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:28:19.690774 [info ] [MainThread]: 
[0m23:28:19.702829 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m23:28:19.703690 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m23:28:19.704804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m23:28:19.705244 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m23:28:19.714759 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m23:28:19.756671 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m23:28:19.757302 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol, date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        





SELECT * FROM dev.analytics.crypto_abstract_metrics

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:28:19.757641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:20.334211 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86020-0004-2cec-0002-7873000190ca
[0m23:28:20.335780 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 32 unexpected ','.
syntax error line 6 at position 39 unexpected 'as'.
syntax error line 6 at position 55 unexpected ')'.
[0m23:28:20.336701 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m23:28:20.477871 [debug] [Thread-1 (]: Database Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 32 unexpected ','.
  syntax error line 6 at position 39 unexpected 'as'.
  syntax error line 6 at position 55 unexpected ')'.
[0m23:28:20.481689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e17e4ea3-355d-4197-acad-183059f8ffe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab031f10>]}
[0m23:28:20.483505 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_crypto_abstract_metrics ............ [[31mERROR[0m in 0.78s]
[0m23:28:20.485329 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m23:28:20.488149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:20.488633 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics' was properly closed.
[0m23:28:20.489100 [info ] [MainThread]: 
[0m23:28:20.489830 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m23:28:20.490676 [debug] [MainThread]: Command end result
[0m23:28:20.523617 [info ] [MainThread]: 
[0m23:28:20.524436 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:28:20.524741 [info ] [MainThread]: 
[0m23:28:20.525071 [error] [MainThread]:   Database Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 32 unexpected ','.
  syntax error line 6 at position 39 unexpected 'as'.
  syntax error line 6 at position 55 unexpected ')'.
[0m23:28:20.525356 [info ] [MainThread]: 
[0m23:28:20.525635 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:28:20.526700 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 5.1662765, "process_user_time": 2.636587, "process_kernel_time": 0.127113, "process_mem_max_rss": "205312", "process_out_blocks": "1994", "command_success": false, "process_in_blocks": "0"}
[0m23:28:20.527106 [debug] [MainThread]: Command `dbt snapshot` failed at 23:28:20.527027 after 5.17 seconds
[0m23:28:20.527464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa9d9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8823e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab30da0>]}
[0m23:28:20.527735 [debug] [MainThread]: Flushing usage events
[0m23:31:02.323907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7ac1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7ad1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7ad370>]}


============================== 23:31:02.328818 | 577aae0a-2a6c-47c3-8f94-087a15c3f084 ==============================
[0m23:31:02.328818 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:31:02.329230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:31:02.769195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '577aae0a-2a6c-47c3-8f94-087a15c3f084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f588ce0>]}
[0m23:31:02.793039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '577aae0a-2a6c-47c3-8f94-087a15c3f084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f588a70>]}
[0m23:31:02.793613 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:31:02.837020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:31:02.897968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:31:02.898460 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:31:02.965963 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['unique_key']: ['symbol, date'] is not valid under any of the given schemas
[0m23:31:02.966714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6975409, "process_user_time": 2.308511, "process_kernel_time": 0.185603, "process_mem_max_rss": "209252", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:31:02.967152 [debug] [MainThread]: Command `dbt run` failed at 23:31:02.967102 after 0.70 seconds
[0m23:31:02.967520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd7b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d7e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89145520>]}
[0m23:31:02.967787 [debug] [MainThread]: Flushing usage events
[0m23:32:26.088087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa1b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0cedb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28570b0>]}


============================== 23:32:26.092499 | 207a2014-20ca-4b29-b726-b6737f2d56c2 ==============================
[0m23:32:26.092499 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:32:26.092849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:32:26.479381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '207a2014-20ca-4b29-b726-b6737f2d56c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b08ce0>]}
[0m23:32:26.502012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '207a2014-20ca-4b29-b726-b6737f2d56c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77684d10>]}
[0m23:32:26.502670 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:32:26.544754 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:32:26.606602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:26.607037 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:32:26.656514 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  invalid syntax for function call expression
    line 5
      config(
[0m23:32:26.657407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6092414, "process_user_time": 2.310153, "process_kernel_time": 0.139674, "process_mem_max_rss": "209244", "process_in_blocks": "16", "process_out_blocks": "21", "command_success": false}
[0m23:32:26.657902 [debug] [MainThread]: Command `dbt run` failed at 23:32:26.657856 after 0.61 seconds
[0m23:32:26.658132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08db3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7729d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77a49700>]}
[0m23:32:26.658351 [debug] [MainThread]: Flushing usage events
[0m23:33:05.648225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9571e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cadf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976f9a00>]}


============================== 23:33:05.651799 | 646ffed2-96f6-4519-aca6-d84ba7ca69d8 ==============================
[0m23:33:05.651799 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:33:05.652122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:33:06.061121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73577500>]}
[0m23:33:06.081032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71f4a510>]}
[0m23:33:06.081582 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:33:06.124882 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:33:06.181942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:33:06.182316 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:33:06.283761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71869af0>]}
[0m23:33:06.335119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71bc2f90>]}
[0m23:33:06.335429 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m23:33:06.335651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71a368a0>]}
[0m23:33:06.336610 [info ] [MainThread]: 
[0m23:33:06.337050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:33:06.339051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:33:06.344653 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:33:06.344891 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:33:06.345122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:06.901879 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.557 seconds
[0m23:33:06.902890 [debug] [ThreadPool]: On list_dev: Close
[0m23:33:07.012357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m23:33:07.016674 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:33:07.017145 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:33:07.017420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:07.557914 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.540 seconds
[0m23:33:07.559243 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:33:07.684624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m23:33:07.686731 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m23:33:07.687112 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m23:33:07.687358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:08.100222 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.413 seconds
[0m23:33:08.101381 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m23:33:08.214154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71d756a0>]}
[0m23:33:08.214823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:33:08.215650 [info ] [MainThread]: 
[0m23:33:08.221126 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m23:33:08.221542 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m23:33:08.222004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m23:33:08.222301 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m23:33:08.226591 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m23:33:08.227857 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m23:33:08.241100 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m23:33:08.242365 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m23:33:08.242585 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m23:33:08.242751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:08.856234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m23:33:08.886604 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m23:33:09.027939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e7a0f0>]}
[0m23:33:09.030949 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.80s]
[0m23:33:09.032672 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m23:33:09.035219 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m23:33:09.036362 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m23:33:09.037726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m23:33:09.038099 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m23:33:09.040681 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:33:09.042500 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m23:33:09.044578 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:33:09.046548 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m23:33:09.047045 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m23:33:09.047428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:10.079563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.031 seconds
[0m23:33:10.084969 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m23:33:10.236375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71706600>]}
[0m23:33:10.239351 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 1.20s]
[0m23:33:10.242309 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m23:33:10.243608 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m23:33:10.244779 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m23:33:10.246590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m23:33:10.247293 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m23:33:10.251484 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m23:33:10.254124 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m23:33:10.256922 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m23:33:10.258889 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m23:33:10.259309 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m23:33:10.259741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:11.106872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m23:33:11.111341 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m23:33:11.230383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70d612b0>]}
[0m23:33:11.233283 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.98s]
[0m23:33:11.235909 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m23:33:11.237012 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m23:33:11.238159 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m23:33:11.239345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m23:33:11.240613 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m23:33:11.244402 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m23:33:11.247327 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m23:33:11.250246 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m23:33:11.251993 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m23:33:11.252389 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m23:33:11.252715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:11.896902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m23:33:11.902171 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m23:33:12.049918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70c5c740>]}
[0m23:33:12.052833 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m23:33:12.055573 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m23:33:12.057392 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:33:12.058891 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m23:33:12.060342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m23:33:12.061021 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:33:12.064964 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:33:12.067206 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:33:12.084440 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:33:12.086606 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m23:33:12.086912 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m23:33:12.087277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:13.590176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.503 seconds
[0m23:33:13.595460 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m23:33:13.707561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '646ffed2-96f6-4519-aca6-d84ba7ca69d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70cc62d0>]}
[0m23:33:13.708421 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.65s]
[0m23:33:13.709368 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m23:33:13.710588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:13.710902 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m23:33:13.711252 [info ] [MainThread]: 
[0m23:33:13.711519 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.37 seconds (7.37s).
[0m23:33:13.712329 [debug] [MainThread]: Command end result
[0m23:33:13.735935 [info ] [MainThread]: 
[0m23:33:13.736964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:13.737388 [info ] [MainThread]: 
[0m23:33:13.737761 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m23:33:13.738749 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.128594, "process_user_time": 2.775246, "process_kernel_time": 0.251554, "process_mem_max_rss": "209280", "process_out_blocks": "3028", "process_in_blocks": "0"}
[0m23:33:13.739082 [debug] [MainThread]: Command `dbt run` succeeded at 23:33:13.739029 after 8.13 seconds
[0m23:33:13.739329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9571e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff723e7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952d7920>]}
[0m23:33:13.739541 [debug] [MainThread]: Flushing usage events
[0m23:33:16.336160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a6a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6846180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a6a120>]}


============================== 23:33:16.339431 | f5ec6193-2060-40c5-b157-c055970eee0c ==============================
[0m23:33:16.339431 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:33:16.340003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:33:16.729548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5ec6193-2060-40c5-b157-c055970eee0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91892ae0>]}
[0m23:33:16.750419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5ec6193-2060-40c5-b157-c055970eee0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4954890>]}
[0m23:33:16.751038 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:33:16.792907 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:33:16.852671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:33:16.853071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:33:16.870985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5ec6193-2060-40c5-b157-c055970eee0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96398350>]}
[0m23:33:16.937900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5ec6193-2060-40c5-b157-c055970eee0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba46e40>]}
[0m23:33:16.938228 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m23:33:16.938643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5ec6193-2060-40c5-b157-c055970eee0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf16060>]}
[0m23:33:16.939445 [info ] [MainThread]: 
[0m23:33:16.939731 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:33:16.940590 [debug] [MainThread]: Command end result
[0m23:33:16.958055 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.66247547, "process_user_time": 2.307049, "process_kernel_time": 0.101265, "process_mem_max_rss": "209244", "process_out_blocks": "1971", "process_in_blocks": "0"}
[0m23:33:16.958405 [debug] [MainThread]: Command `dbt test` succeeded at 23:33:16.958359 after 0.66 seconds
[0m23:33:16.958636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36239b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d82210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83109b0>]}
[0m23:33:16.958867 [debug] [MainThread]: Flushing usage events
[0m23:33:19.451802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955ad0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a91430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969f18e0>]}


============================== 23:33:19.455268 | 54cbdc94-83a9-472c-8c69-c3d27b1e7838 ==============================
[0m23:33:19.455268 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:33:19.455775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:33:19.851652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54cbdc94-83a9-472c-8c69-c3d27b1e7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71604140>]}
[0m23:33:19.871761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54cbdc94-83a9-472c-8c69-c3d27b1e7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859f3950>]}
[0m23:33:19.872349 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:33:19.917614 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:33:19.974900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:33:19.975250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:33:19.992825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54cbdc94-83a9-472c-8c69-c3d27b1e7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff712c0a40>]}
[0m23:33:20.048303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54cbdc94-83a9-472c-8c69-c3d27b1e7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff712f9a30>]}
[0m23:33:20.048618 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m23:33:20.048987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54cbdc94-83a9-472c-8c69-c3d27b1e7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff712d1c70>]}
[0m23:33:20.049768 [info ] [MainThread]: 
[0m23:33:20.050125 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:33:20.050626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m23:33:20.057351 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m23:33:20.057614 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m23:33:20.057771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:20.536768 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.479 seconds
[0m23:33:20.540746 [debug] [ThreadPool]: On list_dev: Close
[0m23:33:20.687527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m23:33:20.698542 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m23:33:20.699167 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m23:33:20.699517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:21.098239 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.398 seconds
[0m23:33:21.101735 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m23:33:21.228387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m23:33:21.235116 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m23:33:21.236380 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m23:33:21.237552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:21.749920 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.512 seconds
[0m23:33:21.751289 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m23:33:21.894786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54cbdc94-83a9-472c-8c69-c3d27b1e7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9627d340>]}
[0m23:33:21.896666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:33:21.899047 [info ] [MainThread]: 
[0m23:33:21.910618 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m23:33:21.911553 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m23:33:21.912528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m23:33:21.912956 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m23:33:21.918688 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m23:33:21.958498 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m23:33:21.959103 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol,date as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        





SELECT * FROM dev.analytics.crypto_abstract_metrics

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m23:33:21.959419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:23.412564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b86025-0004-2cf3-0002-787300010a46
[0m23:33:23.413092 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 32 unexpected ','.
syntax error line 6 at position 38 unexpected 'as'.
syntax error line 6 at position 54 unexpected ')'.
[0m23:33:23.413508 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m23:33:23.546867 [debug] [Thread-1 (]: Database Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 32 unexpected ','.
  syntax error line 6 at position 38 unexpected 'as'.
  syntax error line 6 at position 54 unexpected ')'.
[0m23:33:23.548669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54cbdc94-83a9-472c-8c69-c3d27b1e7838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95411e50>]}
[0m23:33:23.549497 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_crypto_abstract_metrics ............ [[31mERROR[0m in 1.64s]
[0m23:33:23.550534 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m23:33:23.552605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:23.552993 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics' was properly closed.
[0m23:33:23.553406 [info ] [MainThread]: 
[0m23:33:23.553908 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m23:33:23.554609 [debug] [MainThread]: Command end result
[0m23:33:23.582167 [info ] [MainThread]: 
[0m23:33:23.583033 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:33:23.583344 [info ] [MainThread]: 
[0m23:33:23.583749 [error] [MainThread]:   Database Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 32 unexpected ','.
  syntax error line 6 at position 38 unexpected 'as'.
  syntax error line 6 at position 54 unexpected ')'.
[0m23:33:23.584077 [info ] [MainThread]: 
[0m23:33:23.584386 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:33:23.585290 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 4.170711, "process_user_time": 2.576967, "process_kernel_time": 0.162387, "process_mem_max_rss": "209256", "process_out_blocks": "1993", "command_success": false, "process_in_blocks": "0"}
[0m23:33:23.585656 [debug] [MainThread]: Command `dbt snapshot` failed at 23:33:23.585590 after 4.17 seconds
[0m23:33:23.585936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955ad0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7142abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a01940>]}
[0m23:33:23.586155 [debug] [MainThread]: Flushing usage events
[0m23:35:04.378045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa500c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa414a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4494f80>]}


============================== 23:35:04.382359 | eb9aa161-0ad9-404e-b8ad-e1a31322fff6 ==============================
[0m23:35:04.382359 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:35:04.383304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:35:04.798188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb9aa161-0ad9-404e-b8ad-e1a31322fff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d48710>]}
[0m23:35:04.818739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb9aa161-0ad9-404e-b8ad-e1a31322fff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804b7350>]}
[0m23:35:04.819293 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:35:04.864043 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:35:04.926065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:04.926513 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:35:04.988706 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['unique_key']: ['symbol', 'date'] is not valid under any of the given schemas
[0m23:35:04.989642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6519478, "process_user_time": 2.238357, "process_kernel_time": 0.200356, "process_mem_max_rss": "209240", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:35:04.989976 [debug] [MainThread]: Command `dbt run` failed at 23:35:04.989914 after 0.65 seconds
[0m23:35:04.990272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa451af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b99e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7954da0>]}
[0m23:35:04.990547 [debug] [MainThread]: Flushing usage events
[0m23:37:48.155910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f67290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89487260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9f1af0>]}


============================== 23:37:48.160085 | 5e497803-827a-491c-aa8a-e07b359623a3 ==============================
[0m23:37:48.160085 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:37:48.160485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:37:48.640491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e497803-827a-491c-aa8a-e07b359623a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a413bc0>]}
[0m23:37:48.662148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e497803-827a-491c-aa8a-e07b359623a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6578ac60>]}
[0m23:37:48.662952 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:37:48.707611 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:37:48.770150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:37:48.770651 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:37:48.834941 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['unique_key']: [Undefined, <dbt.clients.jinja.MacroGenerator object at 0xffff650469c0>] is not valid under any of the given schemas
[0m23:37:48.835658 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7178649, "process_user_time": 2.256999, "process_kernel_time": 0.209527, "process_mem_max_rss": "209248", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:37:48.836325 [debug] [MainThread]: Command `dbt run` failed at 23:37:48.836265 after 0.72 seconds
[0m23:37:48.836598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d36aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65046de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889d3e30>]}
[0m23:37:48.836837 [debug] [MainThread]: Flushing usage events
[0m23:42:47.943598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96bc7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96bc7140>]}


============================== 23:42:47.947487 | 350a6217-57ed-46e4-9c74-97f3e923f049 ==============================
[0m23:42:47.947487 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:42:47.948007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:42:48.341168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '350a6217-57ed-46e4-9c74-97f3e923f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e95c950>]}
[0m23:42:48.363012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '350a6217-57ed-46e4-9c74-97f3e923f049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e95e960>]}
[0m23:42:48.363539 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:42:48.413449 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:42:48.485302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:42:48.485748 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:42:48.547733 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['unique_key']: ['symbol', 'date'] is not valid under any of the given schemas
[0m23:42:48.548846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.643663, "process_user_time": 2.213254, "process_kernel_time": 0.154296, "process_mem_max_rss": "209244", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:42:48.549146 [debug] [MainThread]: Command `dbt run` failed at 23:42:48.549094 after 0.64 seconds
[0m23:42:48.549421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96223d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ee3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e512060>]}
[0m23:42:48.549683 [debug] [MainThread]: Flushing usage events
[0m23:48:00.708296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c520ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d04cd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f091220>]}


============================== 23:48:00.712435 | 31a561eb-c170-4c00-9a47-0d9bfac90860 ==============================
[0m23:48:00.712435 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:48:00.713069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:48:01.163381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31a561eb-c170-4c00-9a47-0d9bfac90860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b998ce0>]}
[0m23:48:01.185694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31a561eb-c170-4c00-9a47-0d9bfac90860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68afc890>]}
[0m23:48:01.186326 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:48:01.234760 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:48:01.316770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:48:01.317342 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:48:01.369099 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  expected token ',', got 'strategy'
    line 8
      strategy='timestamp',
[0m23:48:01.370524 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7006013, "process_user_time": 2.299261, "process_kernel_time": 0.176557, "process_mem_max_rss": "209248", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:48:01.370946 [debug] [MainThread]: Command `dbt run` failed at 23:48:01.370900 after 0.70 seconds
[0m23:48:01.371222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc5a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68aff620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68850170>]}
[0m23:48:01.371509 [debug] [MainThread]: Flushing usage events
[0m23:50:59.299343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880f9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8696e480>]}


============================== 23:50:59.303668 | 002fbaf7-d53f-412a-a06c-6e36209ef182 ==============================
[0m23:50:59.303668 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:50:59.304425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:50:59.748165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '002fbaf7-d53f-412a-a06c-6e36209ef182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f598890>]}
[0m23:50:59.771947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '002fbaf7-d53f-412a-a06c-6e36209ef182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78df3c20>]}
[0m23:50:59.772659 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:50:59.822021 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:50:59.897312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:50:59.897946 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:50:59.953131 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  expected token ',', got 'strategy'
    line 8
      strategy='ts',
[0m23:50:59.953977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7069755, "process_user_time": 2.250205, "process_kernel_time": 0.209764, "process_mem_max_rss": "209240", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:50:59.954368 [debug] [MainThread]: Command `dbt run` failed at 23:50:59.954282 after 0.71 seconds
[0m23:50:59.954675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8704f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ead2b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d13890>]}
[0m23:50:59.954964 [debug] [MainThread]: Flushing usage events
[0m23:51:30.465338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d28530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e09a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7558530>]}


============================== 23:51:30.471766 | 8ac2bed3-637e-4388-80e6-6a22dee4b2ba ==============================
[0m23:51:30.471766 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:51:30.472408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:51:30.967744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ac2bed3-637e-4388-80e6-6a22dee4b2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8557c80>]}
[0m23:51:30.988294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ac2bed3-637e-4388-80e6-6a22dee4b2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb657ee40>]}
[0m23:51:30.988884 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:51:31.035095 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:51:31.097220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:51:31.097752 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:51:31.145578 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  expected token ',', got 'strategy'
    line 8
      strategy='check',
[0m23:51:31.146455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7326361, "process_user_time": 2.294524, "process_kernel_time": 0.208593, "process_mem_max_rss": "209244", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:51:31.146800 [debug] [MainThread]: Command `dbt run` failed at 23:51:31.146738 after 0.73 seconds
[0m23:51:31.147059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb76f3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c8ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f079880>]}
[0m23:51:31.147341 [debug] [MainThread]: Flushing usage events
[0m23:54:56.425712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881abf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896b12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890aa2a0>]}


============================== 23:54:56.430016 | 7a306749-2781-444d-96c9-3812925b426c ==============================
[0m23:54:56.430016 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:54:56.430390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m23:54:56.894706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a306749-2781-444d-96c9-3812925b426c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff660d8ce0>]}
[0m23:54:56.915084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a306749-2781-444d-96c9-3812925b426c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff649cf950>]}
[0m23:54:56.915692 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:54:56.958039 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:54:57.023821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:54:57.024457 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:54:57.074960 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  expected token ',', got 'strategy'
    line 8
      strategy='check',
[0m23:54:57.075990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.70066524, "process_user_time": 2.17278, "process_kernel_time": 0.283668, "process_mem_max_rss": "209252", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:54:57.076508 [debug] [MainThread]: Command `dbt run` failed at 23:54:57.076462 after 0.70 seconds
[0m23:54:57.076756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b1412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893c6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff651d2660>]}
[0m23:54:57.077005 [debug] [MainThread]: Flushing usage events
[0m23:56:16.483513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971c5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96822180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988ed8e0>]}


============================== 23:56:16.487886 | a7418163-036c-484d-b380-c712c8ffa3a4 ==============================
[0m23:56:16.487886 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:56:16.488432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:56:16.897832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7418163-036c-484d-b380-c712c8ffa3a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6f18cd10>]}
[0m23:56:16.918172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7418163-036c-484d-b380-c712c8ffa3a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db69670>]}
[0m23:56:16.918722 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:56:16.961923 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:56:17.023114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:56:17.023606 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:56:17.072532 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  expected token ',', got 'strategy'
    line 8
      strategy='check'
[0m23:56:17.073701 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6274255, "process_user_time": 2.191014, "process_kernel_time": 0.197181, "process_mem_max_rss": "209252", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:56:17.074061 [debug] [MainThread]: Command `dbt run` failed at 23:56:17.074015 after 0.63 seconds
[0m23:56:17.074321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff978196d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eb83e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6eb59700>]}
[0m23:56:17.074595 [debug] [MainThread]: Flushing usage events
[0m23:59:50.554196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9663c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9912a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99131a0>]}


============================== 23:59:50.557950 | 66c844c9-31e3-4c90-9347-06ae1b5a8785 ==============================
[0m23:59:50.557950 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:59:50.558675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:59:50.959384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66c844c9-31e3-4c90-9347-06ae1b5a8785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f94c20>]}
[0m23:59:50.980107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66c844c9-31e3-4c90-9347-06ae1b5a8785', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff0fe00>]}
[0m23:59:50.980724 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:59:51.023726 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:59:51.084876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:59:51.085413 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m23:59:51.154376 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' (snapshots/snapshot_crypto_abstract_metrics.sql) depends on a source named 'raw.crypto_currencies' which was not found
[0m23:59:51.155207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6410497, "process_user_time": 2.206998, "process_kernel_time": 0.167021, "process_mem_max_rss": "209248", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m23:59:51.155586 [debug] [MainThread]: Command `dbt run` failed at 23:59:51.155530 after 0.64 seconds
[0m23:59:51.155897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9663c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa988650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b8c3e0>]}
[0m23:59:51.156185 [debug] [MainThread]: Flushing usage events
[0m00:01:26.631235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934a4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932d9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932d80b0>]}


============================== 00:01:26.635593 | bb6e3eaa-cab9-499f-ad30-b6dd683c752b ==============================
[0m00:01:26.635593 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:01:26.636136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:27.053663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829a8ce0>]}
[0m00:01:27.074919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6be338c0>]}
[0m00:01:27.075553 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:01:27.118816 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:01:27.180874 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m00:01:27.181293 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://snapshots/snapshot_crypto_currencies.sql
[0m00:01:27.181539 [debug] [MainThread]: Partial parsing: deleted file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m00:01:27.287967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e8bbf0>]}
[0m00:01:27.341237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b733620>]}
[0m00:01:27.341547 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:01:27.341942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b5a6c60>]}
[0m00:01:27.342777 [info ] [MainThread]: 
[0m00:01:27.343149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:27.345655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:01:27.351373 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:01:27.351591 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:01:27.351750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:27.849382 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.497 seconds
[0m00:01:27.852174 [debug] [ThreadPool]: On list_dev: Close
[0m00:01:27.979949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m00:01:27.994690 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:01:27.995540 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:01:27.996007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:28.595262 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.599 seconds
[0m00:01:28.599900 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:01:28.741772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m00:01:28.747105 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:01:28.748252 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:01:28.749102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:29.313040 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.564 seconds
[0m00:01:29.317592 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:01:29.456335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948a5130>]}
[0m00:01:29.458208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:29.460125 [info ] [MainThread]: 
[0m00:01:29.472607 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m00:01:29.473553 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m00:01:29.474748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m00:01:29.475275 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m00:01:29.482190 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m00:01:29.484109 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m00:01:29.504186 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m00:01:29.506334 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m00:01:29.506622 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m00:01:29.506901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:30.210933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m00:01:30.242513 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m00:01:30.388069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a3a330>]}
[0m00:01:30.390309 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.91s]
[0m00:01:30.392933 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m00:01:30.395521 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:01:30.396350 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m00:01:30.397659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m00:01:30.398318 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m00:01:30.401940 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:01:30.404536 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m00:01:30.407260 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:01:30.409929 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:01:30.410454 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m00:01:30.410954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:31.219945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.809 seconds
[0m00:01:31.222630 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m00:01:31.373568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a9bad80>]}
[0m00:01:31.374877 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.98s]
[0m00:01:31.376263 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:01:31.376858 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m00:01:31.377485 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m00:01:31.378264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m00:01:31.378740 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m00:01:31.381758 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:01:31.384096 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m00:01:31.386522 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:01:31.389156 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m00:01:31.389929 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m00:01:31.390401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:32.195286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m00:01:32.198188 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m00:01:32.329367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a940230>]}
[0m00:01:32.331677 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.95s]
[0m00:01:32.333715 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m00:01:32.334851 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m00:01:32.335742 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m00:01:32.337279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m00:01:32.338017 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m00:01:32.342903 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m00:01:32.345044 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m00:01:32.348532 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m00:01:32.350703 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m00:01:32.351257 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m00:01:32.351743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:33.126739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m00:01:33.130848 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m00:01:33.269515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a88e9f0>]}
[0m00:01:33.270959 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.93s]
[0m00:01:33.272106 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m00:01:33.273024 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:01:33.273613 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m00:01:33.274341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m00:01:33.275160 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:01:33.278849 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:01:33.281403 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:01:33.298037 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:01:33.299940 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:01:33.300295 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m00:01:33.300634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:34.971295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.671 seconds
[0m00:01:34.972664 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m00:01:35.093266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb6e3eaa-cab9-499f-ad30-b6dd683c752b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6a8d7bf0>]}
[0m00:01:35.094218 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.82s]
[0m00:01:35.095150 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:01:35.096549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:35.096972 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m00:01:35.097459 [info ] [MainThread]: 
[0m00:01:35.098163 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m00:01:35.099345 [debug] [MainThread]: Command end result
[0m00:01:35.128751 [info ] [MainThread]: 
[0m00:01:35.129342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:35.129579 [info ] [MainThread]: 
[0m00:01:35.129828 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:01:35.130614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.540236, "process_user_time": 2.911079, "process_kernel_time": 0.22895, "process_mem_max_rss": "209300", "process_out_blocks": "3030", "process_in_blocks": "0"}
[0m00:01:35.130993 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:35.130935 after 8.54 seconds
[0m00:01:35.131282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934a4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b55bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f111f0>]}
[0m00:01:35.131549 [debug] [MainThread]: Flushing usage events
[0m00:01:38.509827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8fb1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa0517c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7327230>]}


============================== 00:01:38.513208 | fbbd4e1a-109d-42b1-8c61-12c9f424c514 ==============================
[0m00:01:38.513208 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:01:38.513803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:38.927864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbbd4e1a-109d-42b1-8c61-12c9f424c514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f93f710>]}
[0m00:01:38.952345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbbd4e1a-109d-42b1-8c61-12c9f424c514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fad6d80>]}
[0m00:01:38.953070 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:01:39.001777 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:01:39.065717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:39.066364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:39.084187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbbd4e1a-109d-42b1-8c61-12c9f424c514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f841ac0>]}
[0m00:01:39.148329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbbd4e1a-109d-42b1-8c61-12c9f424c514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f30f350>]}
[0m00:01:39.148665 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:01:39.149280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbbd4e1a-109d-42b1-8c61-12c9f424c514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f57f0b0>]}
[0m00:01:39.150135 [info ] [MainThread]: 
[0m00:01:39.150442 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:01:39.151332 [debug] [MainThread]: Command end result
[0m00:01:39.168819 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.69656503, "process_user_time": 2.28771, "process_kernel_time": 0.114935, "process_mem_max_rss": "209256", "process_out_blocks": "1972", "process_in_blocks": "0"}
[0m00:01:39.169222 [debug] [MainThread]: Command `dbt test` succeeded at 00:01:39.169163 after 0.70 seconds
[0m00:01:39.169467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f832060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ffa8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d97230>]}
[0m00:01:39.169699 [debug] [MainThread]: Flushing usage events
[0m00:01:41.608711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5520c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c17fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b550aa0>]}


============================== 00:01:41.612626 | db757822-e306-4371-b43a-106223af992a ==============================
[0m00:01:41.612626 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:01:41.613249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m00:01:42.050103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db757822-e306-4371-b43a-106223af992a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cba3d40>]}
[0m00:01:42.071387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db757822-e306-4371-b43a-106223af992a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68211d00>]}
[0m00:01:42.071987 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:01:42.112334 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:01:42.170123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:42.170506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:42.188771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db757822-e306-4371-b43a-106223af992a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63a49e80>]}
[0m00:01:42.243807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db757822-e306-4371-b43a-106223af992a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63a7deb0>]}
[0m00:01:42.244162 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:01:42.244601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db757822-e306-4371-b43a-106223af992a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63759bb0>]}
[0m00:01:42.245678 [info ] [MainThread]: 
[0m00:01:42.246374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:42.246962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:01:42.253413 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:01:42.253648 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:01:42.253830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:42.796000 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.542 seconds
[0m00:01:42.800920 [debug] [ThreadPool]: On list_dev: Close
[0m00:01:42.955139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m00:01:42.966166 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:01:42.967074 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:01:42.967590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:43.538223 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.570 seconds
[0m00:01:43.542979 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:01:43.698725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m00:01:43.705633 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:01:43.706527 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:01:43.707309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:44.178577 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.471 seconds
[0m00:01:44.180688 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:01:44.320018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db757822-e306-4371-b43a-106223af992a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca0d250>]}
[0m00:01:44.320818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:44.321727 [info ] [MainThread]: 
[0m00:01:44.329179 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:01:44.329899 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m00:01:44.330800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m00:01:44.331101 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:01:44.337654 [debug] [Thread-1 (]: Compilation Error in snapshot snapshot_crypto_currencies (snapshots/snapshot_crypto_currencies.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:01:44.338820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db757822-e306-4371-b43a-106223af992a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bba5fd0>]}
[0m00:01:44.339314 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_crypto_currencies .................. [[31mERROR[0m in 0.01s]
[0m00:01:44.339974 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:01:44.341606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:44.341847 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m00:01:44.342087 [info ] [MainThread]: 
[0m00:01:44.342475 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m00:01:44.342959 [debug] [MainThread]: Command end result
[0m00:01:44.366449 [info ] [MainThread]: 
[0m00:01:44.367247 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:01:44.367560 [info ] [MainThread]: 
[0m00:01:44.368030 [error] [MainThread]:   Compilation Error in snapshot snapshot_crypto_currencies (snapshots/snapshot_crypto_currencies.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:01:44.368425 [info ] [MainThread]: 
[0m00:01:44.368825 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:01:44.369907 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 2.7980103, "process_user_time": 2.336203, "process_kernel_time": 0.173013, "process_mem_max_rss": "209252", "process_out_blocks": "1989", "command_success": false, "process_in_blocks": "0"}
[0m00:01:44.370616 [debug] [MainThread]: Command `dbt snapshot` failed at 00:01:44.370510 after 2.80 seconds
[0m00:01:44.371040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c17fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd3e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bd3d730>]}
[0m00:01:44.371469 [debug] [MainThread]: Flushing usage events
[0m00:04:24.405683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa602a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7809790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa660e3c0>]}
[0m00:04:24.405793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafedc800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1ef99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb07d2300>]}


============================== 00:04:24.411048 | e27c9fb7-eaad-46f6-a100-d796116c6bf6 ==============================
[0m00:04:24.411048 [info ] [MainThread]: Running with dbt=1.8.7


============================== 00:04:24.411164 | 785231d1-3c91-4f3a-af10-f7e347db262c ==============================
[0m00:04:24.411164 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:04:24.411916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:04:24.411973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:04:24.480470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '785231d1-3c91-4f3a-af10-f7e347db262c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0df6150>]}
[0m00:04:24.509438 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:04:24.517790 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:04:24.518824 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.16820891, "process_user_time": 0.959012, "process_kernel_time": 0.129406, "process_mem_max_rss": "209220", "process_in_blocks": "504", "process_out_blocks": "3"}
[0m00:04:24.520986 [debug] [MainThread]: Command `dbt deps` succeeded at 00:04:24.520804 after 0.17 seconds
[0m00:04:24.524508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb07d3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf84a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9fd3d0>]}
[0m00:04:24.535101 [debug] [MainThread]: Flushing usage events
[0m00:04:24.855826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98dd83e0>]}
[0m00:04:24.879557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa532f800>]}
[0m00:04:24.880133 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:04:24.924413 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:04:24.989134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:24.989795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:25.007761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e050d0>]}
[0m00:04:25.076531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81d41e50>]}
[0m00:04:25.076858 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:04:25.077069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1ffac90>]}
[0m00:04:25.077910 [info ] [MainThread]: 
[0m00:04:25.078246 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:04:25.080411 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:04:25.087172 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:04:25.087501 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:04:25.087772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:25.588570 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.501 seconds
[0m00:04:25.590022 [debug] [ThreadPool]: On list_dev: Close
[0m00:04:25.725124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m00:04:25.733150 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:04:25.733713 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:04:25.734074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:26.308009 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.574 seconds
[0m00:04:26.310177 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:04:26.427330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m00:04:26.428761 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:04:26.429098 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:04:26.429417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:27.001674 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.572 seconds
[0m00:04:27.002720 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:04:27.153867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e91190>]}
[0m00:04:27.154370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:04:27.154671 [info ] [MainThread]: 
[0m00:04:27.159555 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m00:04:27.159937 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m00:04:27.160240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m00:04:27.160510 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m00:04:27.163871 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m00:04:27.165744 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m00:04:27.178935 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m00:04:27.180302 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m00:04:27.180580 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m00:04:27.180843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:27.999754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m00:04:28.011594 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m00:04:28.211650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821485c0>]}
[0m00:04:28.212180 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 1.05s]
[0m00:04:28.212559 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m00:04:28.213181 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:04:28.213479 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m00:04:28.213753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m00:04:28.213983 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m00:04:28.215408 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:04:28.217294 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m00:04:28.218528 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:04:28.219590 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:04:28.219820 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m00:04:28.220068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:28.831415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m00:04:28.835477 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m00:04:28.955944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818b5280>]}
[0m00:04:28.956572 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.74s]
[0m00:04:28.957059 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:04:28.957588 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m00:04:28.958087 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m00:04:28.958616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m00:04:28.958841 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m00:04:28.960501 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:04:28.961303 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m00:04:28.962474 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:04:28.963540 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m00:04:28.963778 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m00:04:28.964021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:29.722834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m00:04:29.727398 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m00:04:29.846935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f2e660>]}
[0m00:04:29.848078 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.89s]
[0m00:04:29.849427 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m00:04:29.849832 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m00:04:29.850362 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m00:04:29.851056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m00:04:29.851392 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m00:04:29.854112 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m00:04:29.855302 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m00:04:29.858133 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m00:04:29.859148 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m00:04:29.859421 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m00:04:29.859691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:30.568740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m00:04:30.574879 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m00:04:30.724016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f2deb0>]}
[0m00:04:30.725933 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.87s]
[0m00:04:30.728012 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m00:04:30.729103 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:04:30.729896 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m00:04:30.731299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m00:04:30.732105 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:04:30.736458 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:04:30.738231 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:04:30.756102 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:04:30.757688 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:04:30.757988 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m00:04:30.758340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:04:32.287627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.529 seconds
[0m00:04:32.291564 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m00:04:32.422972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e27c9fb7-eaad-46f6-a100-d796116c6bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81922e70>]}
[0m00:04:32.425544 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.69s]
[0m00:04:32.428482 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:04:32.431629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:32.432537 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m00:04:32.433797 [info ] [MainThread]: 
[0m00:04:32.434750 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m00:04:32.436479 [debug] [MainThread]: Command end result
[0m00:04:32.472495 [info ] [MainThread]: 
[0m00:04:32.473180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:04:32.473619 [info ] [MainThread]: 
[0m00:04:32.473976 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:04:32.474766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.124242, "process_user_time": 2.712954, "process_kernel_time": 0.250708, "process_mem_max_rss": "209252", "process_out_blocks": "2053", "process_in_blocks": "0"}
[0m00:04:32.475072 [debug] [MainThread]: Command `dbt run` succeeded at 00:04:32.475020 after 8.12 seconds
[0m00:04:32.475320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa602a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6226db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82644da0>]}
[0m00:04:32.475560 [debug] [MainThread]: Flushing usage events
[0m00:04:35.003487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8ca0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb16870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8cbc20>]}


============================== 00:04:35.007188 | 0855d3bf-a172-463c-b949-3d935931b733 ==============================
[0m00:04:35.007188 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:04:35.007751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:04:35.381187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0855d3bf-a172-463c-b949-3d935931b733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f17c80>]}
[0m00:04:35.401237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0855d3bf-a172-463c-b949-3d935931b733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77e716d0>]}
[0m00:04:35.401817 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:04:35.444962 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:04:35.510390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:35.510836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:35.528569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0855d3bf-a172-463c-b949-3d935931b733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77efa4b0>]}
[0m00:04:35.590845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0855d3bf-a172-463c-b949-3d935931b733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff778a30e0>]}
[0m00:04:35.591167 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:04:35.591640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0855d3bf-a172-463c-b949-3d935931b733', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1d9700>]}
[0m00:04:35.592563 [info ] [MainThread]: 
[0m00:04:35.592926 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:04:35.593902 [debug] [MainThread]: Command end result
[0m00:04:35.610916 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6543188, "process_user_time": 2.236505, "process_kernel_time": 0.121571, "process_mem_max_rss": "209260", "process_out_blocks": "1972", "process_in_blocks": "0"}
[0m00:04:35.611252 [debug] [MainThread]: Command `dbt test` succeeded at 00:04:35.611197 after 0.65 seconds
[0m00:04:35.611509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb16870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77f1f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82171490>]}
[0m00:04:35.611718 [debug] [MainThread]: Flushing usage events
[0m00:04:39.145265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef03bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef032c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe09460>]}


============================== 00:04:39.148669 | d32ee068-e8c0-4f59-8779-a6ba6ba779a4 ==============================
[0m00:04:39.148669 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:04:39.149387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:04:39.539120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd32ee068-e8c0-4f59-8779-a6ba6ba779a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e728ce0>]}
[0m00:04:39.559268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd32ee068-e8c0-4f59-8779-a6ba6ba779a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fffdeb0>]}
[0m00:04:39.559896 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:04:39.602774 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:04:39.659957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:39.660288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:39.680699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd32ee068-e8c0-4f59-8779-a6ba6ba779a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff677a3680>]}
[0m00:04:39.738073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd32ee068-e8c0-4f59-8779-a6ba6ba779a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67623da0>]}
[0m00:04:39.738452 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:04:39.738976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32ee068-e8c0-4f59-8779-a6ba6ba779a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6760e870>]}
[0m00:04:39.739885 [info ] [MainThread]: 
[0m00:04:39.740310 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:04:39.740863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:04:39.747890 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:04:39.748212 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:04:39.748443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:40.237837 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.489 seconds
[0m00:04:40.242201 [debug] [ThreadPool]: On list_dev: Close
[0m00:04:40.413809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m00:04:40.423803 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:04:40.424414 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:04:40.424856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:40.868837 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.444 seconds
[0m00:04:40.873331 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:04:40.997373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m00:04:41.000394 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:04:41.000967 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:04:41.001483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:41.500901 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.499 seconds
[0m00:04:41.505937 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:04:41.671519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32ee068-e8c0-4f59-8779-a6ba6ba779a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9057a750>]}
[0m00:04:41.673169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:04:41.675368 [info ] [MainThread]: 
[0m00:04:41.687609 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:04:41.688605 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m00:04:41.689723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m00:04:41.690155 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:04:41.699486 [debug] [Thread-1 (]: Compilation Error in snapshot snapshot_crypto_currencies (snapshots/snapshot_crypto_currencies.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:04:41.701058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd32ee068-e8c0-4f59-8779-a6ba6ba779a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f812150>]}
[0m00:04:41.701794 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_crypto_currencies .................. [[31mERROR[0m in 0.01s]
[0m00:04:41.702610 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:04:41.704451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:41.704942 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m00:04:41.705371 [info ] [MainThread]: 
[0m00:04:41.706137 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m00:04:41.706987 [debug] [MainThread]: Command end result
[0m00:04:41.734012 [info ] [MainThread]: 
[0m00:04:41.734794 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:04:41.735088 [info ] [MainThread]: 
[0m00:04:41.735421 [error] [MainThread]:   Compilation Error in snapshot snapshot_crypto_currencies (snapshots/snapshot_crypto_currencies.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:04:41.735768 [info ] [MainThread]: 
[0m00:04:41.736102 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:04:41.736947 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 2.6303425, "process_user_time": 2.454564, "process_kernel_time": 0.1594, "process_mem_max_rss": "209244", "process_out_blocks": "1989", "command_success": false, "process_in_blocks": "0"}
[0m00:04:41.737271 [debug] [MainThread]: Command `dbt snapshot` failed at 00:04:41.737218 after 2.63 seconds
[0m00:04:41.737556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fca7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff67972630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f222f60>]}
[0m00:04:41.737800 [debug] [MainThread]: Flushing usage events
[0m00:08:27.315387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa12ba510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13a32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13a14c0>]}
[0m00:08:27.315387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2e3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a6c9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2e3b90>]}


============================== 00:08:27.320041 | 36fd403d-e203-4498-b033-396d48015f57 ==============================
[0m00:08:27.320041 [info ] [MainThread]: Running with dbt=1.8.7


============================== 00:08:27.320109 | 3e26ae94-d18f-4b4d-8eec-842404071262 ==============================
[0m00:08:27.320109 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:08:27.320465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:27.320506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:08:27.372964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e26ae94-d18f-4b4d-8eec-842404071262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2e3620>]}
[0m00:08:27.387332 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:08:27.396648 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:08:27.398278 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12910092, "process_user_time": 0.973838, "process_kernel_time": 0.09628, "process_mem_max_rss": "209260", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m00:08:27.400856 [debug] [MainThread]: Command `dbt deps` succeeded at 00:08:27.400805 after 0.13 seconds
[0m00:08:27.404172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7edb6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1b10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1ed0d0>]}
[0m00:08:27.404945 [debug] [MainThread]: Flushing usage events
[0m00:08:27.761860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2bcf8f0>]}
[0m00:08:27.781937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90be2150>]}
[0m00:08:27.782495 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:08:27.826275 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:08:27.900291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:08:27.900839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:08:27.929096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9dd1f0>]}
[0m00:08:27.996384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db3d220>]}
[0m00:08:27.996748 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:08:27.997009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d6b7a40>]}
[0m00:08:27.998013 [info ] [MainThread]: 
[0m00:08:27.998478 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:08:28.001182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:08:28.009822 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:08:28.010114 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:08:28.010271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:28.576867 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.566 seconds
[0m00:08:28.579179 [debug] [ThreadPool]: On list_dev: Close
[0m00:08:28.701803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m00:08:28.708017 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:08:28.711818 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:08:28.712281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:29.438074 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.726 seconds
[0m00:08:29.440565 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:08:29.583049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m00:08:29.589401 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:08:29.590282 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:08:29.591479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:30.105500 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.514 seconds
[0m00:08:30.109629 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:08:30.349111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f26e0c0>]}
[0m00:08:30.351359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:30.352513 [info ] [MainThread]: 
[0m00:08:30.368848 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m00:08:30.369936 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m00:08:30.371070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m00:08:30.371592 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m00:08:30.380205 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m00:08:30.386433 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m00:08:30.409560 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m00:08:30.411676 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m00:08:30.412028 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m00:08:30.412318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:31.137598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m00:08:31.169753 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m00:08:31.299664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bd2270>]}
[0m00:08:31.300637 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.93s]
[0m00:08:31.301286 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m00:08:31.302258 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:08:31.302792 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m00:08:31.303411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m00:08:31.303826 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m00:08:31.306170 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:08:31.307947 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m00:08:31.310306 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:08:31.312000 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:08:31.312328 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m00:08:31.312619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:32.051059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m00:08:32.056931 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m00:08:32.298892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9a27e0>]}
[0m00:08:32.300389 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 1.00s]
[0m00:08:32.301780 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:08:32.302513 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m00:08:32.303401 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m00:08:32.304197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m00:08:32.304689 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m00:08:32.308165 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:08:32.309665 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m00:08:32.312529 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:08:32.314964 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m00:08:32.315547 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m00:08:32.316013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:33.124249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.808 seconds
[0m00:08:33.129003 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m00:08:33.249402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb067b0>]}
[0m00:08:33.253032 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.94s]
[0m00:08:33.259800 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m00:08:33.260954 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m00:08:33.262301 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m00:08:33.265679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m00:08:33.266564 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m00:08:33.270267 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m00:08:33.272227 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m00:08:33.278898 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m00:08:33.280763 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m00:08:33.281168 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m00:08:33.281465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:34.126189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.844 seconds
[0m00:08:34.130006 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m00:08:34.269994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb04bf0>]}
[0m00:08:34.271220 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 1.00s]
[0m00:08:34.272112 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m00:08:34.273676 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:08:34.274831 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m00:08:34.275978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m00:08:34.276483 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:08:34.279785 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:08:34.281513 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:08:34.299996 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:08:34.301969 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:08:34.302316 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m00:08:34.302602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:35.926129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.623 seconds
[0m00:08:35.930559 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m00:08:36.208072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36fd403d-e203-4498-b033-396d48015f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d563c50>]}
[0m00:08:36.210857 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.93s]
[0m00:08:36.213348 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:08:36.218285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:36.219232 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m00:08:36.220033 [info ] [MainThread]: 
[0m00:08:36.220659 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m00:08:36.222551 [debug] [MainThread]: Command end result
[0m00:08:36.262550 [info ] [MainThread]: 
[0m00:08:36.263400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:08:36.263792 [info ] [MainThread]: 
[0m00:08:36.264161 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:08:36.265091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.995854, "process_user_time": 2.871142, "process_kernel_time": 0.243197, "process_mem_max_rss": "209220", "process_out_blocks": "2053", "process_in_blocks": "0"}
[0m00:08:36.265482 [debug] [MainThread]: Command `dbt run` succeeded at 00:08:36.265418 after 9.00 seconds
[0m00:08:36.265813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c1c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa12c36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13c6030>]}
[0m00:08:36.266133 [debug] [MainThread]: Flushing usage events
[0m00:08:38.969309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8cae0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8caf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd10d1c0>]}


============================== 00:08:38.972547 | de08168f-6809-4623-9241-d8852adfd0d3 ==============================
[0m00:08:38.972547 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:08:38.973127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:39.391340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de08168f-6809-4623-9241-d8852adfd0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff953cf860>]}
[0m00:08:39.411474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de08168f-6809-4623-9241-d8852adfd0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95bd2c90>]}
[0m00:08:39.412032 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:08:39.456190 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:08:39.517483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:08:39.517841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:08:39.535156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de08168f-6809-4623-9241-d8852adfd0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952d5dc0>]}
[0m00:08:39.598374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de08168f-6809-4623-9241-d8852adfd0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95afba40>]}
[0m00:08:39.598712 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:08:39.599174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de08168f-6809-4623-9241-d8852adfd0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9505dee0>]}
[0m00:08:39.599981 [info ] [MainThread]: 
[0m00:08:39.600286 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:08:39.601201 [debug] [MainThread]: Command end result
[0m00:08:39.619203 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6880306, "process_user_time": 2.32004, "process_kernel_time": 0.117986, "process_mem_max_rss": "209252", "process_out_blocks": "1972", "process_in_blocks": "0"}
[0m00:08:39.619587 [debug] [MainThread]: Command `dbt test` succeeded at 00:08:39.619537 after 0.69 seconds
[0m00:08:39.619804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9253860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d242c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952d5d90>]}
[0m00:08:39.620018 [debug] [MainThread]: Flushing usage events
[0m00:08:42.001853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7ce540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7cd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7cc950>]}


============================== 00:08:42.005018 | 651499c9-a91b-4d47-bf2d-9fe5388db3ec ==============================
[0m00:08:42.005018 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:08:42.005577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:42.384240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '651499c9-a91b-4d47-bf2d-9fe5388db3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed80ce0>]}
[0m00:08:42.404497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '651499c9-a91b-4d47-bf2d-9fe5388db3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed08a70>]}
[0m00:08:42.405125 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:08:42.447201 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:08:42.506864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:08:42.507267 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:08:42.524670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '651499c9-a91b-4d47-bf2d-9fe5388db3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89670200>]}
[0m00:08:42.580041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '651499c9-a91b-4d47-bf2d-9fe5388db3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894effb0>]}
[0m00:08:42.580364 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:08:42.580754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '651499c9-a91b-4d47-bf2d-9fe5388db3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894cccb0>]}
[0m00:08:42.581595 [info ] [MainThread]: 
[0m00:08:42.582141 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:08:42.582697 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:08:42.589384 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:08:42.589657 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:08:42.589871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:43.081387 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.491 seconds
[0m00:08:43.082891 [debug] [ThreadPool]: On list_dev: Close
[0m00:08:43.194930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m00:08:43.200515 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:08:43.200905 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:08:43.201188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:43.719036 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.518 seconds
[0m00:08:43.723884 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:08:43.852912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m00:08:43.855001 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:08:43.855316 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:08:43.855565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:08:44.347006 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.491 seconds
[0m00:08:44.351238 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:08:44.482794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '651499c9-a91b-4d47-bf2d-9fe5388db3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed810a0>]}
[0m00:08:44.484913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:44.486569 [info ] [MainThread]: 
[0m00:08:44.499430 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:08:44.500494 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m00:08:44.501591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m00:08:44.502114 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:08:44.511094 [debug] [Thread-1 (]: Compilation Error in snapshot snapshot_crypto_currencies (snapshots/snapshot_crypto_currencies.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:08:44.512548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '651499c9-a91b-4d47-bf2d-9fe5388db3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad631f10>]}
[0m00:08:44.513436 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_crypto_currencies .................. [[31mERROR[0m in 0.01s]
[0m00:08:44.514557 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:08:44.516322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:44.516688 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m00:08:44.517025 [info ] [MainThread]: 
[0m00:08:44.517510 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m00:08:44.518183 [debug] [MainThread]: Command end result
[0m00:08:44.543194 [info ] [MainThread]: 
[0m00:08:44.543794 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:08:44.544050 [info ] [MainThread]: 
[0m00:08:44.544341 [error] [MainThread]:   Compilation Error in snapshot snapshot_crypto_currencies (snapshots/snapshot_crypto_currencies.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:08:44.544606 [info ] [MainThread]: 
[0m00:08:44.544893 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:08:44.545563 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 2.5810606, "process_user_time": 2.401693, "process_kernel_time": 0.14233, "process_mem_max_rss": "209252", "process_out_blocks": "1989", "command_success": false, "process_in_blocks": "0"}
[0m00:08:44.545982 [debug] [MainThread]: Command `dbt snapshot` failed at 00:08:44.545913 after 2.58 seconds
[0m00:08:44.546315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacbefe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891def60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad01e480>]}
[0m00:08:44.546574 [debug] [MainThread]: Flushing usage events
[0m00:11:03.554879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0046a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0044860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa054cdd0>]}
[0m00:11:03.554879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948390a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fc4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9483bb60>]}


============================== 00:11:03.560490 | 1708678c-ce02-41cd-8a21-3dca5ce89728 ==============================
[0m00:11:03.560490 [info ] [MainThread]: Running with dbt=1.8.7


============================== 00:11:03.560535 | 8973cca1-9859-4627-979e-d9b9b9e71cb6 ==============================
[0m00:11:03.560535 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:11:03.560906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:03.561012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:11:03.606242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1708678c-ce02-41cd-8a21-3dca5ce89728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb9d7c0>]}
[0m00:11:03.618589 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:11:03.634794 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:11:03.636508 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12370913, "process_user_time": 0.931412, "process_kernel_time": 0.099, "process_mem_max_rss": "209212", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m00:11:03.645066 [debug] [MainThread]: Command `dbt deps` succeeded at 00:11:03.644879 after 0.13 seconds
[0m00:11:03.648988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f0fa690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebefbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eccbe30>]}
[0m00:11:03.677553 [debug] [MainThread]: Flushing usage events
[0m00:11:04.009524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d723da0>]}
[0m00:11:04.033078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff706ead80>]}
[0m00:11:04.034252 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:11:04.081031 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:11:04.144988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:04.145699 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:04.176855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70798140>]}
[0m00:11:04.259263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70615bb0>]}
[0m00:11:04.259740 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:11:04.260048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d743c20>]}
[0m00:11:04.261125 [info ] [MainThread]: 
[0m00:11:04.261623 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:11:04.263832 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:11:04.273072 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:11:04.273759 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:11:04.274080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:04.797510 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.523 seconds
[0m00:11:04.799213 [debug] [ThreadPool]: On list_dev: Close
[0m00:11:04.931604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m00:11:04.944257 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:11:04.945035 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:11:04.945554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:06.111320 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.165 seconds
[0m00:11:06.114952 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:11:06.311282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m00:11:06.317102 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:11:06.318346 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:11:06.319103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:06.785829 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.466 seconds
[0m00:11:06.791219 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:11:06.927194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff702efb60>]}
[0m00:11:06.928159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:06.928986 [info ] [MainThread]: 
[0m00:11:06.940490 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m00:11:06.942817 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m00:11:06.943700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m00:11:06.944996 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m00:11:06.951810 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m00:11:06.953354 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m00:11:06.973954 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m00:11:06.975720 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m00:11:06.976011 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m00:11:06.976288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:07.939176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.962 seconds
[0m00:11:07.964034 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m00:11:08.082505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94839fa0>]}
[0m00:11:08.087051 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 1.14s]
[0m00:11:08.089629 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m00:11:08.090406 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:11:08.090802 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m00:11:08.091121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m00:11:08.091364 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m00:11:08.092907 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:11:08.094483 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m00:11:08.095636 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:11:08.096655 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:11:08.096861 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m00:11:08.097073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:08.777710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m00:11:08.779954 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m00:11:08.892513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70108110>]}
[0m00:11:08.893547 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.80s]
[0m00:11:08.894255 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:11:08.894801 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m00:11:08.895425 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m00:11:08.896095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m00:11:08.896545 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m00:11:08.899890 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:11:08.901574 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m00:11:08.903557 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:11:08.905399 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m00:11:08.905748 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m00:11:08.906065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:09.566528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m00:11:09.572499 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m00:11:09.728887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701b3110>]}
[0m00:11:09.731110 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.83s]
[0m00:11:09.733029 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m00:11:09.734247 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m00:11:09.735275 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m00:11:09.736358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m00:11:09.737142 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m00:11:09.741868 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m00:11:09.743581 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m00:11:09.748078 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m00:11:09.749724 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m00:11:09.750095 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m00:11:09.750476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:10.507968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m00:11:10.512251 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m00:11:10.658988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bf108f0>]}
[0m00:11:10.661619 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.92s]
[0m00:11:10.663069 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m00:11:10.665772 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:11:10.666680 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m00:11:10.667732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m00:11:10.668850 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:11:10.675397 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:11:10.678657 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:11:10.695812 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:11:10.697679 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:11:10.698045 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m00:11:10.698429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:12.056322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.358 seconds
[0m00:11:12.060201 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m00:11:12.371217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8973cca1-9859-4627-979e-d9b9b9e71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701b0380>]}
[0m00:11:12.373541 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.70s]
[0m00:11:12.375182 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:11:12.377752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:12.378540 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m00:11:12.379239 [info ] [MainThread]: 
[0m00:11:12.379903 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 8.12 seconds (8.12s).
[0m00:11:12.382053 [debug] [MainThread]: Command end result
[0m00:11:12.416484 [info ] [MainThread]: 
[0m00:11:12.416854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:11:12.417280 [info ] [MainThread]: 
[0m00:11:12.417650 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:11:12.418502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.905345, "process_user_time": 2.848065, "process_kernel_time": 0.251268, "process_mem_max_rss": "209244", "process_out_blocks": "2053", "process_in_blocks": "0"}
[0m00:11:12.418811 [debug] [MainThread]: Command `dbt run` succeeded at 00:11:12.418759 after 8.91 seconds
[0m00:11:12.419055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d0c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71439fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ef1310>]}
[0m00:11:12.419309 [debug] [MainThread]: Flushing usage events
[0m00:11:15.391813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87faed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86fd6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ee99a0>]}


============================== 00:11:15.395241 | 345dac3e-2d65-4bc2-8417-7c546aeb6e66 ==============================
[0m00:11:15.395241 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:11:15.396038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:15.809317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '345dac3e-2d65-4bc2-8417-7c546aeb6e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68d08ce0>]}
[0m00:11:15.829314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '345dac3e-2d65-4bc2-8417-7c546aeb6e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff645667e0>]}
[0m00:11:15.829867 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:11:15.871534 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:11:15.930116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:15.930490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:15.947373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '345dac3e-2d65-4bc2-8417-7c546aeb6e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64354ce0>]}
[0m00:11:16.007892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '345dac3e-2d65-4bc2-8417-7c546aeb6e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f02b260>]}
[0m00:11:16.008225 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:11:16.008671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '345dac3e-2d65-4bc2-8417-7c546aeb6e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f243c50>]}
[0m00:11:16.009401 [info ] [MainThread]: 
[0m00:11:16.009737 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:11:16.010604 [debug] [MainThread]: Command end result
[0m00:11:16.028250 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.67637944, "process_user_time": 2.280687, "process_kernel_time": 0.106907, "process_mem_max_rss": "209244", "process_out_blocks": "1972", "process_in_blocks": "0"}
[0m00:11:16.028607 [debug] [MainThread]: Command `dbt test` succeeded at 00:11:16.028549 after 0.68 seconds
[0m00:11:16.028853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87faed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d620c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5fab24e0>]}
[0m00:11:16.029077 [debug] [MainThread]: Flushing usage events
[0m00:11:18.322937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f23410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03fa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8ed940>]}


============================== 00:11:18.326274 | 45f77831-397d-49dc-a08c-b729701c59d2 ==============================
[0m00:11:18.326274 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:11:18.326801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:11:18.701477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45f77831-397d-49dc-a08c-b729701c59d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876d5520>]}
[0m00:11:18.721430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45f77831-397d-49dc-a08c-b729701c59d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05fb5f0>]}
[0m00:11:18.722011 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:11:18.763145 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:11:18.821104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:11:18.821491 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:11:18.839538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45f77831-397d-49dc-a08c-b729701c59d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf101f70>]}
[0m00:11:18.896864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45f77831-397d-49dc-a08c-b729701c59d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875ddc40>]}
[0m00:11:18.897196 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:11:18.897578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f77831-397d-49dc-a08c-b729701c59d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf754d70>]}
[0m00:11:18.898350 [info ] [MainThread]: 
[0m00:11:18.898704 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:11:18.899237 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:11:18.905934 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:11:18.906177 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:11:18.906370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:19.520127 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.613 seconds
[0m00:11:19.523415 [debug] [ThreadPool]: On list_dev: Close
[0m00:11:19.782475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m00:11:19.795486 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:11:19.796319 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:11:19.796783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:20.294032 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.497 seconds
[0m00:11:20.298140 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:11:20.423419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m00:11:20.426705 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:11:20.427395 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:11:20.427948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:21.298542 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.870 seconds
[0m00:11:21.303018 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:11:21.462188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45f77831-397d-49dc-a08c-b729701c59d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872f7620>]}
[0m00:11:21.464125 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:21.466478 [info ] [MainThread]: 
[0m00:11:21.479315 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:11:21.480121 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m00:11:21.480992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m00:11:21.481410 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:11:21.490293 [debug] [Thread-1 (]: Compilation Error in snapshot snapshot_crypto_currencies (snapshots/snapshot_crypto_currencies.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:11:21.491841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45f77831-397d-49dc-a08c-b729701c59d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c149fa0>]}
[0m00:11:21.492555 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshot.snapshot_crypto_currencies .................. [[31mERROR[0m in 0.01s]
[0m00:11:21.493349 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:11:21.494833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:21.495228 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m00:11:21.495564 [info ] [MainThread]: 
[0m00:11:21.496049 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m00:11:21.496707 [debug] [MainThread]: Command end result
[0m00:11:21.522820 [info ] [MainThread]: 
[0m00:11:21.523338 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:11:21.523560 [info ] [MainThread]: 
[0m00:11:21.523814 [error] [MainThread]:   Compilation Error in snapshot snapshot_crypto_currencies (snapshots/snapshot_crypto_currencies.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:11:21.524025 [info ] [MainThread]: 
[0m00:11:21.524228 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:11:21.524760 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 3.2401266, "process_user_time": 2.480795, "process_kernel_time": 0.12289, "process_mem_max_rss": "209208", "process_out_blocks": "1989", "command_success": false, "process_in_blocks": "0"}
[0m00:11:21.525067 [debug] [MainThread]: Command `dbt snapshot` failed at 00:11:21.525012 after 3.24 seconds
[0m00:11:21.525331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f23410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3aedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3ae4e0>]}
[0m00:11:21.525573 [debug] [MainThread]: Flushing usage events
[0m16:15:59.340005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bfb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d69e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d69bb0>]}


============================== 16:15:59.341763 | 326a1f4d-2415-4d02-b384-61eb144c60e2 ==============================
[0m16:15:59.341763 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:15:59.342055 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'profiles_dir': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': '/Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None'}
[0m16:15:59.454481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '326a1f4d-2415-4d02-b384-61eb144c60e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d947a0>]}
[0m16:15:59.466317 [debug] [MainThread]: Set downloads directory='/var/folders/km/ncbhtx2x3yd5jf9pqlktgz4r0000gn/T/dbt-downloads-z56htqa3'
[0m16:15:59.466566 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:15:59.581243 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:15:59.582040 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:15:59.639209 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:15:59.650342 [info ] [MainThread]: Updating lock file in file path: /Users/sadhvisingh/sjsu-data226/week8/airflow/crypto_currencies_elt/package-lock.yml
[0m16:15:59.652499 [debug] [MainThread]: Set downloads directory='/var/folders/km/ncbhtx2x3yd5jf9pqlktgz4r0000gn/T/dbt-downloads-xrxd_ja7'
[0m16:15:59.654815 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:16:00.214531 [info ] [MainThread]: Installed from version 1.3.0
[0m16:16:00.214984 [info ] [MainThread]: Up to date!
[0m16:16:00.215278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '326a1f4d-2415-4d02-b384-61eb144c60e2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7dac0>]}
[0m16:16:00.217582 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9258951, "process_user_time": 0.633567, "process_kernel_time": 0.215082, "process_mem_max_rss": "107315200", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:16:00.218035 [debug] [MainThread]: Command `dbt deps` succeeded at 16:16:00.217971 after 0.93 seconds
[0m16:16:00.218243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c2ae0>]}
[0m16:16:00.218432 [debug] [MainThread]: Flushing usage events
[0m00:16:14.244417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb73087a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb730a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a43d70>]}
[0m00:16:14.244417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3d1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbe08df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbaf9ca0>]}


============================== 00:16:14.248685 | e7fe90ee-20be-47d3-aa13-e457067ad440 ==============================
[0m00:16:14.248685 [info ] [MainThread]: Running with dbt=1.8.7


============================== 00:16:14.248857 | 4b52f6f0-081f-48dd-af7e-25e0d1883b35 ==============================
[0m00:16:14.248857 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:16:14.249427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:16:14.249473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:16:14.302024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7fe90ee-20be-47d3-aa13-e457067ad440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb752b920>]}
[0m00:16:14.423012 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_4pc0cvi'
[0m00:16:14.423366 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:16:14.526861 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:16:14.527964 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:16:14.601088 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:16:14.603651 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:16:14.714381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b52f6f0-081f-48dd-af7e-25e0d1883b35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96117710>]}
[0m00:16:14.736238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b52f6f0-081f-48dd-af7e-25e0d1883b35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa11d8620>]}
[0m00:16:14.736790 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:16:14.780432 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m00:16:14.781303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.581127, "process_user_time": 2.142907, "process_kernel_time": 0.217003, "process_mem_max_rss": "209236", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m00:16:14.781834 [debug] [MainThread]: Command `dbt run` failed at 00:16:14.781716 after 0.58 seconds
[0m00:16:14.782245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3d1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96007080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96607ef0>]}
[0m00:16:14.782569 [debug] [MainThread]: Flushing usage events
[0m00:16:15.201985 [info ] [MainThread]: Installed from version 1.3.0
[0m00:16:15.202884 [info ] [MainThread]: Up to date!
[0m00:16:15.203603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e7fe90ee-20be-47d3-aa13-e457067ad440', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75508f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb67993d0>]}
[0m00:16:15.204567 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0040473, "process_user_time": 1.021777, "process_kernel_time": 0.161438, "process_mem_max_rss": "209252", "process_out_blocks": "733", "process_in_blocks": "0"}
[0m00:16:15.204937 [debug] [MainThread]: Command `dbt deps` succeeded at 00:16:15.204874 after 1.00 seconds
[0m00:16:15.205163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68e4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c2dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6799cd0>]}
[0m00:16:15.205364 [debug] [MainThread]: Flushing usage events
[0m00:17:11.375702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ef9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb863b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb863b860>]}
[0m00:17:11.375711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96119d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa985ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9613f50>]}


============================== 00:17:11.380621 | a8f324fe-2b39-4bd4-93e0-f5df669d7e08 ==============================
[0m00:17:11.380621 [info ] [MainThread]: Running with dbt=1.8.7


============================== 00:17:11.380571 | 85688e55-2aa9-48a4-850f-b6b3a64dac69 ==============================
[0m00:17:11.380571 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:17:11.381122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m00:17:11.381072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:17:11.433518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8f324fe-2b39-4bd4-93e0-f5df669d7e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa60bb00>]}
[0m00:17:11.457021 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:17:11.546170 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vn5qsgor'
[0m00:17:11.546519 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:17:11.629964 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:17:11.631068 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:17:11.699763 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:17:11.702585 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:17:11.826462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1520ce0>]}
[0m00:17:11.846362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9480e510>]}
[0m00:17:11.846909 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:17:11.889124 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:17:11.950532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:17:11.950848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:17:11.968145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb86594c0>]}
[0m00:17:12.025635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94360a40>]}
[0m00:17:12.025939 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 459 macros
[0m00:17:12.026151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94419130>]}
[0m00:17:12.026979 [info ] [MainThread]: 
[0m00:17:12.027304 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:12.029276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:17:12.035681 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:17:12.035966 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:17:12.036125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:12.312795 [info ] [MainThread]: Installed from version 1.3.0
[0m00:17:12.313198 [info ] [MainThread]: Up to date!
[0m00:17:12.313535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a8f324fe-2b39-4bd4-93e0-f5df669d7e08', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa897bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8adc0e0>]}
[0m00:17:12.314242 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.98125464, "process_user_time": 1.025974, "process_kernel_time": 0.123076, "process_mem_max_rss": "209240", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m00:17:12.314602 [debug] [MainThread]: Command `dbt deps` succeeded at 00:17:12.314533 after 0.98 seconds
[0m00:17:12.314853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa985ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93abec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad56aa50>]}
[0m00:17:12.315100 [debug] [MainThread]: Flushing usage events
[0m00:17:12.496188 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.460 seconds
[0m00:17:12.497942 [debug] [ThreadPool]: On list_dev: Close
[0m00:17:12.619472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m00:17:12.630055 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:17:12.630796 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:17:12.631193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:13.109161 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.478 seconds
[0m00:17:13.112373 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:17:13.264799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m00:17:13.279069 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:17:13.280309 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:17:13.281304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:13.727614 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.446 seconds
[0m00:17:13.731286 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:17:13.868685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb947d520>]}
[0m00:17:13.869367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:17:13.869813 [info ] [MainThread]: 
[0m00:17:13.878648 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m00:17:13.879513 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m00:17:13.880138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m00:17:13.880502 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m00:17:13.885615 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m00:17:13.887766 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m00:17:13.906968 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m00:17:13.910332 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m00:17:13.910733 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m00:17:13.911045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:14.605291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m00:17:14.634715 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m00:17:14.774127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947482c0>]}
[0m00:17:14.776538 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.89s]
[0m00:17:14.778233 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m00:17:14.780415 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:17:14.781752 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m00:17:14.782427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m00:17:14.782930 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m00:17:14.785987 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:17:14.789283 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m00:17:14.791979 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:17:14.794320 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:17:14.794894 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m00:17:14.795247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:15.421255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m00:17:15.423909 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m00:17:15.541074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f57fdd0>]}
[0m00:17:15.543129 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.76s]
[0m00:17:15.544761 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:17:15.545724 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m00:17:15.546559 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m00:17:15.547400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m00:17:15.548257 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m00:17:15.551893 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:17:15.553836 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m00:17:15.556743 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:17:15.559137 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m00:17:15.559720 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m00:17:15.560229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:16.184836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m00:17:16.191401 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m00:17:16.316282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f57fa40>]}
[0m00:17:16.318410 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.77s]
[0m00:17:16.320195 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m00:17:16.321539 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m00:17:16.322558 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m00:17:16.323714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m00:17:16.324309 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m00:17:16.328902 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m00:17:16.330668 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m00:17:16.335559 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m00:17:16.337574 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m00:17:16.338038 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m00:17:16.338416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:16.927272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m00:17:16.930317 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m00:17:17.048813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f450a10>]}
[0m00:17:17.051175 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m00:17:17.053000 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m00:17:17.055350 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:17:17.056714 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m00:17:17.058553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m00:17:17.059540 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:17:17.064368 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:17:17.066594 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:17:17.086313 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:17:17.088251 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:17:17.088598 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m00:17:17.088920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:18.960333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.871 seconds
[0m00:17:18.964663 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m00:17:19.093887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85688e55-2aa9-48a4-850f-b6b3a64dac69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f43d340>]}
[0m00:17:19.095865 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 2.03s]
[0m00:17:19.097194 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:17:19.099298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:19.099996 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m00:17:19.100647 [info ] [MainThread]: 
[0m00:17:19.101226 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.07 seconds (7.07s).
[0m00:17:19.103133 [debug] [MainThread]: Command end result
[0m00:17:19.138296 [info ] [MainThread]: 
[0m00:17:19.138763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:17:19.139242 [info ] [MainThread]: 
[0m00:17:19.139617 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:17:19.140455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.807028, "process_user_time": 2.755281, "process_kernel_time": 0.278964, "process_mem_max_rss": "209224", "process_out_blocks": "2053", "process_in_blocks": "0"}
[0m00:17:19.140827 [debug] [MainThread]: Command `dbt run` succeeded at 00:17:19.140765 after 7.81 seconds
[0m00:17:19.141077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ef9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bf9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9444f290>]}
[0m00:17:19.141318 [debug] [MainThread]: Flushing usage events
[0m00:17:21.956919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0e0d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef58d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efffb90>]}


============================== 00:17:21.960200 | b0afd554-4424-4d60-a5ce-882ad2e5a315 ==============================
[0m00:17:21.960200 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:17:21.960718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:17:22.343272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0afd554-4424-4d60-a5ce-882ad2e5a315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77940740>]}
[0m00:17:22.363611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0afd554-4424-4d60-a5ce-882ad2e5a315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77b19dc0>]}
[0m00:17:22.364197 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:17:22.409653 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:17:22.454011 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m00:17:22.454553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b0afd554-4424-4d60-a5ce-882ad2e5a315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77186690>]}
[0m00:17:22.957255 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'analysis_crypto_currencies' in the 'models' section of file 'models/schema.yml'
[0m00:17:23.076612 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.unique_analysis_crypto_currencies_symbol.41c2819f5c' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.077204 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_symbol.2689d6bf11' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.077556 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_date.897053daf1' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.077904 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.unique_analysis_crypto_currencies_date.3936a62c33' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.078241 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_price_close.59697cbc93' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.078540 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.relationships_analysis_crypto_currencies_price_close__price_close__ref_stg_bitcoin_price_.c64bf3bd61' (models/schema.yml) depends on a node named 'stg_bitcoin_price' in package '' which was not found
[0m00:17:23.078826 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.relationships_analysis_crypto_currencies_price_close__price_close__ref_stg_bitcoin_price_.c64bf3bd61' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.079078 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_sma_7d.ea7b3d820d' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.079337 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_rsi_14d.4850c5ff97' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.079604 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_volume_traded.58922fe50a' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.079845 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_trades_count.6bc452e87f' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.080080 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_price_momentum.52ca1233ca' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.080320 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.relationships_analysis_crypto_currencies_price_momentum__price_momentum__ref_price_momentum_.eaa77cc5d0' (models/schema.yml) depends on a node named 'price_momentum' in package '' which was not found
[0m00:17:23.080576 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.relationships_analysis_crypto_currencies_price_momentum__price_momentum__ref_price_momentum_.eaa77cc5d0' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.080858 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.not_null_analysis_crypto_currencies_momentum_direction.6eeeece60d' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.081281 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.crypto_currencies_elt.accepted_values_analysis_crypto_currencies_momentum_direction__Positive__Negative__Neutral.4b548b5fc1' (models/schema.yml) depends on a node named 'analysis_crypto_currencies' in package '' which was not found
[0m00:17:23.122368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0afd554-4424-4d60-a5ce-882ad2e5a315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff769088f0>]}
[0m00:17:23.180691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0afd554-4424-4d60-a5ce-882ad2e5a315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01fbaa0>]}
[0m00:17:23.181001 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 575 macros
[0m00:17:23.181403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0afd554-4424-4d60-a5ce-882ad2e5a315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff771ea720>]}
[0m00:17:23.182180 [info ] [MainThread]: 
[0m00:17:23.182450 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:17:23.182758 [debug] [MainThread]: Command end result
[0m00:17:23.201113 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.2814113, "process_user_time": 2.869132, "process_kernel_time": 0.125685, "process_mem_max_rss": "209264", "process_out_blocks": "3749", "process_in_blocks": "0"}
[0m00:17:23.201410 [debug] [MainThread]: Command `dbt test` succeeded at 00:17:23.201368 after 1.28 seconds
[0m00:17:23.201591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76df15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76df3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea512e0>]}
[0m00:17:23.201779 [debug] [MainThread]: Flushing usage events
[0m00:17:26.376552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ed2e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7cc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e150440>]}


============================== 00:17:26.380191 | c6a346e2-5360-4149-8bf5-881beda6e6c7 ==============================
[0m00:17:26.380191 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:17:26.380744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:17:26.805787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6a346e2-5360-4149-8bf5-881beda6e6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71b50ce0>]}
[0m00:17:26.828357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6a346e2-5360-4149-8bf5-881beda6e6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57238320>]}
[0m00:17:26.828864 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:17:26.882874 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:17:26.958945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:17:26.959255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:17:26.982492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6a346e2-5360-4149-8bf5-881beda6e6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56a25670>]}
[0m00:17:27.043487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6a346e2-5360-4149-8bf5-881beda6e6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56a59e20>]}
[0m00:17:27.043944 [info ] [MainThread]: Found 5 models, 1 snapshot, 2 sources, 575 macros
[0m00:17:27.044437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a346e2-5360-4149-8bf5-881beda6e6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56797d40>]}
[0m00:17:27.045435 [info ] [MainThread]: 
[0m00:17:27.045909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:27.046454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:17:27.053690 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:17:27.054136 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:17:27.054620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:27.496810 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.442 seconds
[0m00:17:27.499404 [debug] [ThreadPool]: On list_dev: Close
[0m00:17:27.656864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m00:17:27.668259 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:17:27.669076 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:17:27.669516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:28.148227 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.479 seconds
[0m00:17:28.151983 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:17:28.281592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m00:17:28.282931 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:17:28.283188 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:17:28.283479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:29.784012 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.500 seconds
[0m00:17:29.785080 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:17:29.937699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a346e2-5360-4149-8bf5-881beda6e6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56985af0>]}
[0m00:17:29.938145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:17:29.938554 [info ] [MainThread]: 
[0m00:17:29.943652 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:17:29.944054 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m00:17:29.944556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m00:17:29.944834 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:17:29.953207 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:17:29.985293 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:17:29.985714 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:17:29.985973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:30.566253 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.580 seconds
[0m00:17:30.569732 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:17:30.570193 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:17:30.656391 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m00:17:30.657014 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:17:30.658542 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:17:30.658889 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace transient table dev.snapshot.snapshot_crypto_currencies
         as
        (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data

    ) sbq



        );
[0m00:17:31.455998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.797 seconds
[0m00:17:31.466708 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m00:17:31.585583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a346e2-5360-4149-8bf5-881beda6e6c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56d88470>]}
[0m00:17:31.586550 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 1[0m in 1.64s]
[0m00:17:31.587397 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:17:31.588573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:31.588903 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m00:17:31.589234 [info ] [MainThread]: 
[0m00:17:31.589704 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m00:17:31.590382 [debug] [MainThread]: Command end result
[0m00:17:31.619313 [info ] [MainThread]: 
[0m00:17:31.619821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:17:31.620061 [info ] [MainThread]: 
[0m00:17:31.620355 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:17:31.621029 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.2829366, "process_user_time": 2.412302, "process_kernel_time": 0.126855, "process_mem_max_rss": "209252", "process_out_blocks": "2539", "process_in_blocks": "0"}
[0m00:17:31.621365 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:17:31.621310 after 5.28 seconds
[0m00:17:31.621592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c0a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e51f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f58b3b0>]}
[0m00:17:31.621798 [debug] [MainThread]: Flushing usage events
[0m00:23:41.724925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c68b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c0ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c69b80>]}
[0m00:23:41.725802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cbf650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cbf8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cbd940>]}


============================== 00:23:41.729565 | 6d3c8a50-cfa4-4816-b66f-3ba1444547e8 ==============================
[0m00:23:41.729565 [info ] [MainThread]: Running with dbt=1.8.7


============================== 00:23:41.729731 | 2c009822-5ad6-42ac-a038-df10169cf63e ==============================
[0m00:23:41.729731 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:23:41.729982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:41.730165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:41.778406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c009822-5ad6-42ac-a038-df10169cf63e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93471820>]}
[0m00:23:41.791549 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:23:41.893571 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-k3on05nd'
[0m00:23:41.893930 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:23:42.057960 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:23:42.059335 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:23:42.137136 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:23:42.139818 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:23:42.181023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d3c8a50-cfa4-4816-b66f-3ba1444547e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e5ab710>]}
[0m00:23:42.201095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d3c8a50-cfa4-4816-b66f-3ba1444547e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3872f0>]}
[0m00:23:42.201785 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:23:42.250387 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:23:42.332519 [debug] [MainThread]: Partial parsing enabled: 51 files deleted, 1 files added, 0 files changed.
[0m00:23:42.333110 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m00:23:42.333517 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m00:23:42.333754 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m00:23:42.334041 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/surrogate_key.sql
[0m00:23:42.334363 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/groupby.sql
[0m00:23:42.334592 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equality.sql
[0m00:23:42.334883 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m00:23:42.335086 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/recency.sql
[0m00:23:42.335253 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/date_spine.sql
[0m00:23:42.335414 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m00:23:42.335571 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_column_values.sql
[0m00:23:42.335719 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m00:23:42.335855 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_subtract.sql
[0m00:23:42.335992 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/deduplicate.sql
[0m00:23:42.336180 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m00:23:42.336330 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m00:23:42.336468 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m00:23:42.336606 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/pivot.sql
[0m00:23:42.336742 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_constant.sql
[0m00:23:42.336895 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m00:23:42.337085 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_parameter.sql
[0m00:23:42.337259 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_divide.sql
[0m00:23:42.337406 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m00:23:42.337558 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m00:23:42.337698 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m00:23:42.337833 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m00:23:42.337972 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m00:23:42.338107 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m00:23:42.338253 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m00:23:42.338386 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m00:23:42.338530 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck_table.sql
[0m00:23:42.338662 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_single_value.sql
[0m00:23:42.338795 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/width_bucket.sql
[0m00:23:42.338970 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m00:23:42.339212 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m00:23:42.339398 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m00:23:42.339600 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_host.sql
[0m00:23:42.339827 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_series.sql
[0m00:23:42.340067 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/star.sql
[0m00:23:42.340283 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_add.sql
[0m00:23:42.340541 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m00:23:42.340778 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/unpivot.sql
[0m00:23:42.341011 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/haversine_distance.sql
[0m00:23:42.341240 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/union.sql
[0m00:23:42.341537 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m00:23:42.341842 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m00:23:42.342047 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_path.sql
[0m00:23:42.342236 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck.sql
[0m00:23:42.342425 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m00:23:42.342664 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m00:23:42.342896 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m00:23:42.343120 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m00:23:42.347283 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected EOF, expected string, got ", crypto_abstract_metrics') }}
  )
  
  SELECT * FROM source_data
  
  {% endsnapshot %}"
[0m00:23:42.347931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6699264, "process_user_time": 2.179716, "process_kernel_time": 0.200988, "process_mem_max_rss": "205312", "process_out_blocks": "17", "command_success": false, "process_in_blocks": "0"}
[0m00:23:42.348279 [debug] [MainThread]: Command `dbt run` failed at 00:23:42.348223 after 0.67 seconds
[0m00:23:42.348544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918981d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e1d0e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6e97c9b0>]}
[0m00:23:42.348784 [debug] [MainThread]: Flushing usage events
[0m00:23:43.037980 [info ] [MainThread]: Installed from version 1.3.0
[0m00:23:43.038724 [info ] [MainThread]: Up to date!
[0m00:23:43.039106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2c009822-5ad6-42ac-a038-df10169cf63e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ec8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fe38f0>]}
[0m00:23:43.039974 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3619652, "process_user_time": 1.055797, "process_kernel_time": 0.137623, "process_mem_max_rss": "205296", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m00:23:43.040292 [debug] [MainThread]: Command `dbt deps` succeeded at 00:23:43.040243 after 1.36 seconds
[0m00:23:43.040587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932952b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff938601a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9218da00>]}
[0m00:23:43.040881 [debug] [MainThread]: Flushing usage events
[0m00:25:41.223699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847c2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866fd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847bd400>]}
[0m00:25:41.223700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8607bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8607bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8607bce0>]}


============================== 00:25:41.227895 | 991ebfd4-0c1d-4224-be57-143a769ba7a3 ==============================
[0m00:25:41.227895 [info ] [MainThread]: Running with dbt=1.8.7


============================== 00:25:41.227953 | 1e0fdb3f-be73-4057-aacd-bd4611d29f00 ==============================
[0m00:25:41.227953 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:25:41.228342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:41.228445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:41.292509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '991ebfd4-0c1d-4224-be57-143a769ba7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847c2c30>]}
[0m00:25:41.330835 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:25:41.403104 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-gpnfaef8'
[0m00:25:41.403585 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:25:41.538491 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:25:41.539651 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:25:41.611127 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:25:41.613634 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:25:41.664082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e0fdb3f-be73-4057-aacd-bd4611d29f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ee468a0>]}
[0m00:25:41.684779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e0fdb3f-be73-4057-aacd-bd4611d29f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6418f560>]}
[0m00:25:41.685705 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:25:41.730289 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:25:41.802172 [debug] [MainThread]: Partial parsing enabled: 51 files deleted, 1 files added, 0 files changed.
[0m00:25:41.802578 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m00:25:41.802801 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equality.sql
[0m00:25:41.803009 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_constant.sql
[0m00:25:41.803255 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m00:25:41.803445 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m00:25:41.803628 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m00:25:41.803822 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m00:25:41.804028 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m00:25:41.804245 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/recency.sql
[0m00:25:41.804427 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/surrogate_key.sql
[0m00:25:41.804615 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck.sql
[0m00:25:41.804797 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m00:25:41.804983 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m00:25:41.805179 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/haversine_distance.sql
[0m00:25:41.805350 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m00:25:41.805528 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_series.sql
[0m00:25:41.805706 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m00:25:41.805886 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m00:25:41.806058 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_path.sql
[0m00:25:41.806281 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/union.sql
[0m00:25:41.806499 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m00:25:41.806685 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m00:25:41.806887 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m00:25:41.807069 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m00:25:41.807245 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m00:25:41.807478 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_add.sql
[0m00:25:41.807660 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m00:25:41.807851 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m00:25:41.808051 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m00:25:41.808266 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_subtract.sql
[0m00:25:41.808476 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/groupby.sql
[0m00:25:41.808707 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m00:25:41.808932 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/unpivot.sql
[0m00:25:41.809151 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m00:25:41.809380 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/date_spine.sql
[0m00:25:41.809572 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m00:25:41.809898 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_parameter.sql
[0m00:25:41.810106 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/deduplicate.sql
[0m00:25:41.810378 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/width_bucket.sql
[0m00:25:41.810563 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m00:25:41.810862 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck_table.sql
[0m00:25:41.811069 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_single_value.sql
[0m00:25:41.811305 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/pivot.sql
[0m00:25:41.811497 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_divide.sql
[0m00:25:41.811817 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m00:25:41.812036 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/star.sql
[0m00:25:41.812320 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m00:25:41.812539 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m00:25:41.813029 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m00:25:41.813240 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m00:25:41.813437 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_host.sql
[0m00:25:41.813622 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_column_values.sql
[0m00:25:41.885475 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics' (snapshots/snapshot_crypto_abstract_metrics.sql) depends on a source named 'analytics.crypto_abstract_metrics' which was not found
[0m00:25:41.887191 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.707022, "process_user_time": 2.269177, "process_kernel_time": 0.223678, "process_mem_max_rss": "205300", "process_out_blocks": "17", "command_success": false, "process_in_blocks": "0"}
[0m00:25:41.887552 [debug] [MainThread]: Command `dbt run` failed at 00:25:41.887502 after 0.71 seconds
[0m00:25:41.887808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b33a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87aba060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862a96d0>]}
[0m00:25:41.888108 [debug] [MainThread]: Flushing usage events
[0m00:25:42.237901 [info ] [MainThread]: Installed from version 1.3.0
[0m00:25:42.238493 [info ] [MainThread]: Up to date!
[0m00:25:42.238971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '991ebfd4-0c1d-4224-be57-143a769ba7a3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856da300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856d9370>]}
[0m00:25:42.239706 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0595797, "process_user_time": 1.060093, "process_kernel_time": 0.158708, "process_mem_max_rss": "205276", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m00:25:42.240015 [debug] [MainThread]: Command `dbt deps` succeeded at 00:25:42.239960 after 1.06 seconds
[0m00:25:42.240236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843f0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847c2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841483e0>]}
[0m00:25:42.240448 [debug] [MainThread]: Flushing usage events
[0m00:27:51.108181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e4c140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b17e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b166c0>]}
[0m00:27:51.108155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb8effb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd1e55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb09c980>]}


============================== 00:27:51.112410 | 25d967ad-36b9-4a3f-884e-9381b87d6fee ==============================
[0m00:27:51.112410 [info ] [MainThread]: Running with dbt=1.8.7


============================== 00:27:51.112498 | 1041b681-3888-46b7-b77e-f2191a3fada6 ==============================
[0m00:27:51.112498 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:27:51.113215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:27:51.113264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m00:27:51.164580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1041b681-3888-46b7-b77e-f2191a3fada6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba346840>]}
[0m00:27:51.193091 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:27:51.277578 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r46hik32'
[0m00:27:51.277914 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m00:27:51.541030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917c0170>]}
[0m00:27:51.561296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e73560>]}
[0m00:27:51.561840 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:27:51.571566 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m00:27:51.572638 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m00:27:51.604967 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:27:51.669018 [debug] [MainThread]: Partial parsing enabled: 51 files deleted, 1 files added, 0 files changed.
[0m00:27:51.669460 [debug] [MainThread]: Partial parsing: added file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m00:27:51.669689 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/groupby.sql
[0m00:27:51.669927 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m00:27:51.670156 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_constant.sql
[0m00:27:51.670354 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/date_spine.sql
[0m00:27:51.670547 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/unpivot.sql
[0m00:27:51.670746 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/star.sql
[0m00:27:51.670985 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m00:27:51.671205 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m00:27:51.671412 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m00:27:51.671598 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_host.sql
[0m00:27:51.671778 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/surrogate_key.sql
[0m00:27:51.671976 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m00:27:51.672149 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_subtract.sql
[0m00:27:51.672337 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck_table.sql
[0m00:27:51.672540 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m00:27:51.672725 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/haversine_distance.sql
[0m00:27:51.672967 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m00:27:51.673157 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_single_value.sql
[0m00:27:51.673340 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m00:27:51.673513 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m00:27:51.673709 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/deduplicate.sql
[0m00:27:51.673910 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck.sql
[0m00:27:51.674112 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m00:27:51.674303 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_parameter.sql
[0m00:27:51.674494 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m00:27:51.674677 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m00:27:51.674874 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m00:27:51.675086 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_series.sql
[0m00:27:51.675267 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m00:27:51.675459 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equality.sql
[0m00:27:51.675652 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m00:27:51.675834 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m00:27:51.676020 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m00:27:51.676224 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m00:27:51.676410 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_divide.sql
[0m00:27:51.676636 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/width_bucket.sql
[0m00:27:51.676849 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_path.sql
[0m00:27:51.677070 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m00:27:51.677277 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m00:27:51.677471 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/recency.sql
[0m00:27:51.677650 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m00:27:51.677840 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/union.sql
[0m00:27:51.678027 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m00:27:51.678211 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_add.sql
[0m00:27:51.678387 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m00:27:51.678574 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m00:27:51.678762 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m00:27:51.678962 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m00:27:51.679142 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_column_values.sql
[0m00:27:51.679379 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/pivot.sql
[0m00:27:51.679561 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m00:27:51.703850 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m00:27:51.706392 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m00:27:51.786989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff711875c0>]}
[0m00:27:51.838544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7120ed50>]}
[0m00:27:51.838846 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 459 macros
[0m00:27:51.839286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7111a900>]}
[0m00:27:51.840137 [info ] [MainThread]: 
[0m00:27:51.840536 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:27:51.842498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:27:51.848950 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:27:51.849251 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:27:51.849425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:52.394770 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.545 seconds
[0m00:27:52.396743 [debug] [ThreadPool]: On list_dev: Close
[0m00:27:52.561436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m00:27:52.575704 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:27:52.576537 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:27:52.577022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:27:53.137075 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.560 seconds
[0m00:27:53.141993 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:27:53.306488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m00:27:53.312257 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:27:53.313327 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:27:53.313803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:27:53.858031 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.544 seconds
[0m00:27:53.859503 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:27:53.978855 [info ] [MainThread]: Installed from version 1.3.0
[0m00:27:53.979321 [info ] [MainThread]: Up to date!
[0m00:27:53.979687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1041b681-3888-46b7-b77e-f2191a3fada6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba7316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e6d220>]}
[0m00:27:53.980530 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.9172566, "process_user_time": 1.056209, "process_kernel_time": 0.158783, "process_mem_max_rss": "205292", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m00:27:53.980961 [debug] [MainThread]: Command `dbt deps` succeeded at 00:27:53.980863 after 2.92 seconds
[0m00:27:53.981277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb142f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba346840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb30ca40>]}
[0m00:27:53.981537 [debug] [MainThread]: Flushing usage events
[0m00:27:53.998670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71634260>]}
[0m00:27:53.999123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:27:53.999732 [info ] [MainThread]: 
[0m00:27:54.006461 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m00:27:54.006904 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m00:27:54.007207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m00:27:54.007407 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m00:27:54.010655 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m00:27:54.011726 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m00:27:54.026052 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m00:27:54.027413 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m00:27:54.027660 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m00:27:54.027908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:27:54.600325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m00:27:54.614718 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m00:27:54.724855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956ba090>]}
[0m00:27:54.727144 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.72s]
[0m00:27:54.727830 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m00:27:54.731629 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:27:54.732011 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m00:27:54.732347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m00:27:54.732983 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m00:27:54.734950 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:27:54.736475 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m00:27:54.738991 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:27:54.740496 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m00:27:54.740795 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m00:27:54.741092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:27:55.393418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m00:27:55.394705 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m00:27:55.525064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f0e8a0>]}
[0m00:27:55.525620 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.79s]
[0m00:27:55.526006 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m00:27:55.526335 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m00:27:55.526686 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m00:27:55.527117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m00:27:55.527377 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m00:27:55.529253 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:27:55.530082 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m00:27:55.531139 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m00:27:55.532131 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m00:27:55.532353 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m00:27:55.532616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:27:56.155530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m00:27:56.156700 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m00:27:56.299177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff705842c0>]}
[0m00:27:56.299679 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.77s]
[0m00:27:56.300265 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m00:27:56.300564 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m00:27:56.300890 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m00:27:56.301338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m00:27:56.301577 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m00:27:56.303013 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m00:27:56.303832 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m00:27:56.304937 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m00:27:56.305742 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m00:27:56.306070 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m00:27:56.306316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:27:57.025115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m00:27:57.026607 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m00:27:57.157021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff705a5760>]}
[0m00:27:57.157683 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.86s]
[0m00:27:57.158628 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m00:27:57.159450 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:27:57.160133 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m00:27:57.160819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m00:27:57.161185 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:27:57.163527 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:27:57.164586 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:27:57.176841 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:27:57.178398 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m00:27:57.178652 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m00:27:57.178900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:27:58.616975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.438 seconds
[0m00:27:58.622937 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m00:27:58.783028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d967ad-36b9-4a3f-884e-9381b87d6fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710893a0>]}
[0m00:27:58.784389 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.62s]
[0m00:27:58.786698 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m00:27:58.788669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:27:58.789270 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m00:27:58.789857 [info ] [MainThread]: 
[0m00:27:58.790332 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 6.95 seconds (6.95s).
[0m00:27:58.791763 [debug] [MainThread]: Command end result
[0m00:27:58.821576 [info ] [MainThread]: 
[0m00:27:58.822262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:27:58.822634 [info ] [MainThread]: 
[0m00:27:58.823021 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m00:27:58.823876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.7605596, "process_user_time": 2.699992, "process_kernel_time": 0.259287, "process_mem_max_rss": "205320", "process_out_blocks": "3043", "process_in_blocks": "0"}
[0m00:27:58.824330 [debug] [MainThread]: Command `dbt run` succeeded at 00:27:58.824263 after 7.76 seconds
[0m00:27:58.824665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95731be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b88290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9960aa20>]}
[0m00:27:58.824900 [debug] [MainThread]: Flushing usage events
[0m00:28:01.820545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d06bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa91580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d06ab40>]}


============================== 00:28:01.823939 | 1aa48a5f-3950-482a-9f35-7bf3fcc0c4c8 ==============================
[0m00:28:01.823939 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:28:01.824462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:28:02.209370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aa48a5f-3950-482a-9f35-7bf3fcc0c4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79433020>]}
[0m00:28:02.229506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aa48a5f-3950-482a-9f35-7bf3fcc0c4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9f06b0>]}
[0m00:28:02.230084 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:28:02.273705 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:28:02.350052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m00:28:02.350454 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m00:28:02.350717 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m00:28:02.350987 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m00:28:02.351202 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m00:28:02.351419 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m00:28:02.351645 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m00:28:02.351851 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m00:28:02.352049 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m00:28:02.352246 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m00:28:02.352477 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m00:28:02.352669 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m00:28:02.352848 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m00:28:02.353048 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m00:28:02.353248 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m00:28:02.353439 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m00:28:02.353632 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m00:28:02.353844 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m00:28:02.354077 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m00:28:02.354326 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m00:28:02.354542 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m00:28:02.354738 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m00:28:02.354928 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m00:28:02.355139 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m00:28:02.355337 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m00:28:02.355524 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m00:28:02.355724 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m00:28:02.355921 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m00:28:02.356119 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m00:28:02.356302 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m00:28:02.356483 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m00:28:02.356661 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m00:28:02.356839 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m00:28:02.357038 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m00:28:02.357231 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m00:28:02.357427 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m00:28:02.357623 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m00:28:02.357811 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m00:28:02.358000 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m00:28:02.358182 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m00:28:02.358367 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m00:28:02.358552 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m00:28:02.358767 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m00:28:02.358957 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m00:28:02.359135 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m00:28:02.359347 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m00:28:02.359536 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m00:28:02.359729 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m00:28:02.359934 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m00:28:02.360129 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m00:28:02.360311 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m00:28:02.360508 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m00:28:02.481209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aa48a5f-3950-482a-9f35-7bf3fcc0c4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78fbebd0>]}
[0m00:28:02.550144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aa48a5f-3950-482a-9f35-7bf3fcc0c4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78fdeff0>]}
[0m00:28:02.550499 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m00:28:02.550907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa48a5f-3950-482a-9f35-7bf3fcc0c4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78ef84d0>]}
[0m00:28:02.551766 [info ] [MainThread]: 
[0m00:28:02.552144 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:28:02.553111 [debug] [MainThread]: Command end result
[0m00:28:02.572819 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7896914, "process_user_time": 2.362823, "process_kernel_time": 0.12772, "process_mem_max_rss": "205312", "process_out_blocks": "3738", "process_in_blocks": "0"}
[0m00:28:02.573215 [debug] [MainThread]: Command `dbt test` succeeded at 00:28:02.573145 after 0.79 seconds
[0m00:28:02.573453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e0af9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d06b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79432300>]}
[0m00:28:02.573653 [debug] [MainThread]: Flushing usage events
[0m00:28:05.717166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab5ef8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9879670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa59c080>]}


============================== 00:28:05.720380 | 8425ffb2-2710-4608-af30-2ec20b26c82f ==============================
[0m00:28:05.720380 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:28:05.720941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:28:06.100283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8425ffb2-2710-4608-af30-2ec20b26c82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866c6660>]}
[0m00:28:06.120876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8425ffb2-2710-4608-af30-2ec20b26c82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8648fc80>]}
[0m00:28:06.121471 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:28:06.165475 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:28:06.237305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:28:06.240128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:28:06.257153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8425ffb2-2710-4608-af30-2ec20b26c82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c52090>]}
[0m00:28:06.316057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8425ffb2-2710-4608-af30-2ec20b26c82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c84560>]}
[0m00:28:06.316358 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m00:28:06.316733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8425ffb2-2710-4608-af30-2ec20b26c82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f7cb00>]}
[0m00:28:06.317563 [info ] [MainThread]: 
[0m00:28:06.317973 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:28:06.320172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m00:28:06.327248 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m00:28:06.327529 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m00:28:06.327689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:06.933221 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.605 seconds
[0m00:28:06.934270 [debug] [ThreadPool]: On list_dev: Close
[0m00:28:07.087984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m00:28:07.095842 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m00:28:07.096364 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m00:28:07.096698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:07.571964 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.475 seconds
[0m00:28:07.573477 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m00:28:07.723893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m00:28:07.729583 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m00:28:07.730364 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m00:28:07.730801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:08.201231 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.470 seconds
[0m00:28:08.205734 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m00:28:08.332660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8425ffb2-2710-4608-af30-2ec20b26c82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d208c0>]}
[0m00:28:08.333744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:28:08.334737 [info ] [MainThread]: 
[0m00:28:08.344306 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m00:28:08.345073 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m00:28:08.345784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m00:28:08.346161 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m00:28:08.359136 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m00:28:08.394761 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m00:28:08.395247 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_14d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m00:28:08.395507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:08.958237 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.562 seconds
[0m00:28:08.969480 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m00:28:08.970993 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:28:09.056121 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m00:28:09.057845 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m00:28:09.062893 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m00:28:09.063557 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
create or replace transient table dev.snapshot.snapshot_crypto_abstract_metrics
         as
        (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id,
        date as dbt_updated_at,
        date as dbt_valid_from,
        
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to

    from (
        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_14d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data

    ) sbq



        );
[0m00:28:10.111542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.047 seconds
[0m00:28:10.124380 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m00:28:10.254986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8425ffb2-2710-4608-af30-2ec20b26c82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e11e80>]}
[0m00:28:10.255641 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_crypto_abstract_metrics ................ [[32mSUCCESS 1[0m in 1.91s]
[0m00:28:10.256467 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m00:28:10.256743 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:28:10.257035 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m00:28:10.257439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m00:28:10.257685 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:28:10.260205 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:28:10.264932 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:10.265224 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m00:28:10.265415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:10.784242 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.519 seconds
[0m00:28:10.799299 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:10.799637 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m00:28:11.669208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.869 seconds
[0m00:28:11.678440 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:11.680104 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m00:28:11.769291 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.088 seconds
[0m00:28:11.777870 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:11.779388 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m00:28:11.862925 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.082 seconds
[0m00:28:11.876331 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:11.877371 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m00:28:12.010641 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.132 seconds
[0m00:28:12.022532 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:12.023468 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m00:28:12.101064 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.077 seconds
[0m00:28:12.106992 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:12.107511 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m00:28:12.244868 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.137 seconds
[0m00:28:12.258398 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:12.259222 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m00:28:12.433929 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.174 seconds
[0m00:28:12.437571 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:12.439161 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m00:28:12.562444 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.122 seconds
[0m00:28:12.564757 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:12.570169 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:12.571426 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
BEGIN
[0m00:28:12.714277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m00:28:12.715871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:12.716934 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m00:28:13.274370 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.556 seconds
[0m00:28:13.276646 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m00:28:13.278242 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
COMMIT
[0m00:28:13.541937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.263 seconds
[0m00:28:13.547436 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m00:28:13.657246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8425ffb2-2710-4608-af30-2ec20b26c82f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84dbd880>]}
[0m00:28:13.660838 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 0[0m in 3.40s]
[0m00:28:13.663403 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m00:28:13.665215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:13.666094 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m00:28:13.666714 [info ] [MainThread]: 
[0m00:28:13.667356 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 7.35 seconds (7.35s).
[0m00:28:13.668070 [debug] [MainThread]: Command end result
[0m00:28:13.698459 [info ] [MainThread]: 
[0m00:28:13.699102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:28:13.699392 [info ] [MainThread]: 
[0m00:28:13.699685 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:28:13.700423 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 8.024102, "process_user_time": 2.729275, "process_kernel_time": 0.142431, "process_mem_max_rss": "205320", "process_out_blocks": "2546", "process_in_blocks": "0"}
[0m00:28:13.700770 [debug] [MainThread]: Command `dbt snapshot` succeeded at 00:28:13.700704 after 8.02 seconds
[0m00:28:13.701059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9814e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85986d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859870b0>]}
[0m00:28:13.701280 [debug] [MainThread]: Flushing usage events
[0m01:23:08.002456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9571b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97de62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97009a90>]}
[0m01:23:08.002446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940ce060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96009c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942d6360>]}


============================== 01:23:08.006062 | 806767f6-8dfc-430c-9c74-2e09930b69cd ==============================
[0m01:23:08.006062 [info ] [MainThread]: Running with dbt=1.8.7


============================== 01:23:08.006126 | 1aa40840-d220-429f-8375-8c1da480d0db ==============================
[0m01:23:08.006126 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:23:08.006512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:23:08.006618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:23:08.052739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aa40840-d220-429f-8375-8c1da480d0db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fe2030>]}
[0m01:23:08.068240 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:23:08.173436 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8o0j916v'
[0m01:23:08.173933 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:23:08.317700 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:23:08.319156 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:23:08.386101 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:23:08.388652 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:23:08.434480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77988aa0>]}
[0m01:23:08.456172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71a018e0>]}
[0m01:23:08.456754 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:23:08.497631 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:23:08.560443 [debug] [MainThread]: Partial parsing enabled: 51 files deleted, 0 files added, 0 files changed.
[0m01:23:08.560794 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/deduplicate.sql
[0m01:23:08.561000 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:23:08.561270 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/unpivot.sql
[0m01:23:08.561503 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/surrogate_key.sql
[0m01:23:08.561687 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:23:08.561873 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_constant.sql
[0m01:23:08.562017 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m01:23:08.562158 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m01:23:08.562309 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m01:23:08.562453 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/groupby.sql
[0m01:23:08.562623 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m01:23:08.562859 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m01:23:08.563079 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_host.sql
[0m01:23:08.563261 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m01:23:08.563459 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_series.sql
[0m01:23:08.563610 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m01:23:08.563766 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m01:23:08.563903 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/union.sql
[0m01:23:08.564047 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m01:23:08.564185 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m01:23:08.564344 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m01:23:08.564529 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:23:08.564765 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_single_value.sql
[0m01:23:08.564958 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m01:23:08.565108 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m01:23:08.565248 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/recency.sql
[0m01:23:08.565387 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m01:23:08.565537 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/date_spine.sql
[0m01:23:08.565670 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_parameter.sql
[0m01:23:08.565806 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/haversine_distance.sql
[0m01:23:08.565946 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m01:23:08.566078 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m01:23:08.566214 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m01:23:08.566356 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/width_bucket.sql
[0m01:23:08.566487 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/pivot.sql
[0m01:23:08.566617 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/star.sql
[0m01:23:08.566751 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck.sql
[0m01:23:08.566882 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_divide.sql
[0m01:23:08.567015 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m01:23:08.567177 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_add.sql
[0m01:23:08.567309 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equality.sql
[0m01:23:08.567458 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:23:08.567587 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck_table.sql
[0m01:23:08.567715 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m01:23:08.567853 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_column_values.sql
[0m01:23:08.567988 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m01:23:08.568115 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m01:23:08.568240 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m01:23:08.568376 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m01:23:08.568504 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_path.sql
[0m01:23:08.568633 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m01:23:08.605883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7160da30>]}
[0m01:23:08.655730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff712e3140>]}
[0m01:23:08.656040 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 459 macros
[0m01:23:08.656230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713c0e00>]}
[0m01:23:08.657109 [info ] [MainThread]: 
[0m01:23:08.657456 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:23:08.659565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m01:23:08.666229 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m01:23:08.666443 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m01:23:08.666606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:08.993473 [info ] [MainThread]: Installed from version 1.3.0
[0m01:23:08.994004 [info ] [MainThread]: Up to date!
[0m01:23:08.994325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1aa40840-d220-429f-8375-8c1da480d0db', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d031d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b2c650>]}
[0m01:23:08.995063 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0324882, "process_user_time": 0.995163, "process_kernel_time": 0.111578, "process_mem_max_rss": "209700", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m01:23:08.995405 [debug] [MainThread]: Command `dbt deps` succeeded at 01:23:08.995335 after 1.03 seconds
[0m01:23:08.995628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940ce060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c2f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f13c50>]}
[0m01:23:08.995849 [debug] [MainThread]: Flushing usage events
[0m01:23:09.191867 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.525 seconds
[0m01:23:09.193743 [debug] [ThreadPool]: On list_dev: Close
[0m01:23:09.308832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m01:23:09.321950 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m01:23:09.322681 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m01:23:09.323204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:09.750096 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.427 seconds
[0m01:23:09.751693 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m01:23:09.903349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m01:23:09.908116 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m01:23:09.908995 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m01:23:09.909526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:10.481756 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.572 seconds
[0m01:23:10.485205 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m01:23:10.619745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965bd280>]}
[0m01:23:10.621844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:23:10.623501 [info ] [MainThread]: 
[0m01:23:10.638076 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m01:23:10.639113 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m01:23:10.639945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m01:23:10.640594 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m01:23:10.647254 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m01:23:10.649590 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m01:23:10.668803 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m01:23:10.670214 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m01:23:10.670530 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m01:23:10.670751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:11.448169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m01:23:11.477860 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m01:23:11.605204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95756210>]}
[0m01:23:11.607087 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.96s]
[0m01:23:11.608731 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m01:23:11.610053 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m01:23:11.610715 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m01:23:11.612038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m01:23:11.612685 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m01:23:11.616090 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m01:23:11.619630 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m01:23:11.622355 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m01:23:11.624481 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m01:23:11.624831 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m01:23:11.625138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:12.195168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m01:23:12.199403 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m01:23:12.331432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710cc050>]}
[0m01:23:12.333778 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.72s]
[0m01:23:12.335504 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m01:23:12.336444 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m01:23:12.337419 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m01:23:12.338667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m01:23:12.339349 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m01:23:12.344539 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m01:23:12.347513 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m01:23:12.350483 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m01:23:12.352704 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m01:23:12.353144 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m01:23:12.353508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:13.226736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.873 seconds
[0m01:23:13.231506 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m01:23:13.343027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710ccb90>]}
[0m01:23:13.345872 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 1.00s]
[0m01:23:13.347904 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m01:23:13.349169 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m01:23:13.350347 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m01:23:13.351795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m01:23:13.352785 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m01:23:13.357145 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m01:23:13.359132 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m01:23:13.362838 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m01:23:13.364977 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m01:23:13.365433 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m01:23:13.365827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:14.088537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.723 seconds
[0m01:23:14.090020 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m01:23:14.204745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7074be90>]}
[0m01:23:14.205332 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.85s]
[0m01:23:14.206387 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m01:23:14.206940 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:23:14.207395 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m01:23:14.208108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m01:23:14.208468 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:23:14.211228 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m01:23:14.212331 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:23:14.222657 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m01:23:14.224530 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m01:23:14.224852 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m01:23:14.225157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:15.629858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.404 seconds
[0m01:23:15.634746 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m01:23:15.761242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806767f6-8dfc-430c-9c74-2e09930b69cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff710c3140>]}
[0m01:23:15.762094 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.55s]
[0m01:23:15.763526 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:23:15.764748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:15.765109 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m01:23:15.765492 [info ] [MainThread]: 
[0m01:23:15.765819 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.11 seconds (7.11s).
[0m01:23:15.766812 [debug] [MainThread]: Command end result
[0m01:23:15.788862 [info ] [MainThread]: 
[0m01:23:15.789536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:15.789879 [info ] [MainThread]: 
[0m01:23:15.790247 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:23:15.791118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.8305416, "process_user_time": 2.741601, "process_kernel_time": 0.242083, "process_mem_max_rss": "209228", "process_out_blocks": "3043", "process_in_blocks": "0"}
[0m01:23:15.791449 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:15.791392 after 7.83 seconds
[0m01:23:15.791693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9571b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff716339e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff715f8bc0>]}
[0m01:23:15.791880 [debug] [MainThread]: Flushing usage events
[0m01:23:21.354262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e418e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e2c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e2e060>]}


============================== 01:23:21.357602 | 76ea94e8-2110-4feb-80fd-61a4cd73212b ==============================
[0m01:23:21.357602 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:23:21.358122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:23:21.750872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76ea94e8-2110-4feb-80fd-61a4cd73212b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9087acc0>]}
[0m01:23:21.770154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76ea94e8-2110-4feb-80fd-61a4cd73212b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a4af60>]}
[0m01:23:21.770629 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:23:21.813397 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:23:21.886574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m01:23:21.886970 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:23:21.887210 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m01:23:21.887444 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m01:23:21.887659 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m01:23:21.887861 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m01:23:21.888057 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m01:23:21.888279 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m01:23:21.888506 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m01:23:21.888698 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:23:21.888878 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m01:23:21.889057 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m01:23:21.889237 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m01:23:21.889420 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m01:23:21.889637 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m01:23:21.889852 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:23:21.890039 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m01:23:21.890229 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:23:21.890414 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m01:23:21.890611 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m01:23:21.890800 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m01:23:21.891000 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m01:23:21.891196 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m01:23:21.891385 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m01:23:21.891584 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m01:23:21.891771 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m01:23:21.891952 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m01:23:21.892142 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m01:23:21.892332 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m01:23:21.892521 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m01:23:21.892711 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m01:23:21.892889 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m01:23:21.893065 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m01:23:21.893239 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m01:23:21.893413 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m01:23:21.893595 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m01:23:21.893826 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m01:23:21.894011 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m01:23:21.894192 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m01:23:21.894375 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m01:23:21.894570 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m01:23:21.894752 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m01:23:21.894957 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m01:23:21.895143 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m01:23:21.895323 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m01:23:21.895509 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m01:23:21.895700 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m01:23:21.895885 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m01:23:21.896070 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m01:23:21.896256 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m01:23:21.896443 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m01:23:21.896640 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m01:23:22.013747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76ea94e8-2110-4feb-80fd-61a4cd73212b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90410fe0>]}
[0m01:23:22.073881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76ea94e8-2110-4feb-80fd-61a4cd73212b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9024d430>]}
[0m01:23:22.074229 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m01:23:22.074659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76ea94e8-2110-4feb-80fd-61a4cd73212b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90466ab0>]}
[0m01:23:22.075522 [info ] [MainThread]: 
[0m01:23:22.075877 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:23:22.076889 [debug] [MainThread]: Command end result
[0m01:23:22.097139 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7765255, "process_user_time": 2.281995, "process_kernel_time": 0.184809, "process_mem_max_rss": "209344", "process_out_blocks": "3738", "process_in_blocks": "0"}
[0m01:23:22.097475 [debug] [MainThread]: Command `dbt test` succeeded at 01:23:22.097420 after 0.78 seconds
[0m01:23:22.097720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4457f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9205a300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916ba840>]}
[0m01:23:22.097915 [debug] [MainThread]: Flushing usage events
[0m01:23:24.831709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cf1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92198e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9219b8f0>]}


============================== 01:23:24.836340 | 6d5932bd-c5e0-4983-964a-8d8b7c130b0b ==============================
[0m01:23:24.836340 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:23:24.837385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:23:25.283361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d5932bd-c5e0-4983-964a-8d8b7c130b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b57ad0>]}
[0m01:23:25.304278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d5932bd-c5e0-4983-964a-8d8b7c130b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dec2510>]}
[0m01:23:25.304868 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:23:25.349873 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:23:25.425517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:23:25.425899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:23:25.443109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d5932bd-c5e0-4983-964a-8d8b7c130b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91130f50>]}
[0m01:23:25.502020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d5932bd-c5e0-4983-964a-8d8b7c130b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d781e80>]}
[0m01:23:25.502337 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m01:23:25.502819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5932bd-c5e0-4983-964a-8d8b7c130b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d77ba40>]}
[0m01:23:25.503763 [info ] [MainThread]: 
[0m01:23:25.504265 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:23:25.506695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m01:23:25.513202 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m01:23:25.513504 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m01:23:25.513733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:25.999293 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.485 seconds
[0m01:23:26.001043 [debug] [ThreadPool]: On list_dev: Close
[0m01:23:26.139089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m01:23:26.154068 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m01:23:26.154734 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m01:23:26.155266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:26.613871 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.458 seconds
[0m01:23:26.616402 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m01:23:26.764021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m01:23:26.770171 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m01:23:26.771259 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m01:23:26.771849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:23:27.306115 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.534 seconds
[0m01:23:27.311382 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m01:23:27.454203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5932bd-c5e0-4983-964a-8d8b7c130b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6db6fb00>]}
[0m01:23:27.455915 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:23:27.457631 [info ] [MainThread]: 
[0m01:23:27.472045 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:23:27.473131 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m01:23:27.474433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m01:23:27.474934 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:23:27.489902 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:23:27.520743 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:27.521305 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m01:23:27.521581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:27.936411 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.414 seconds
[0m01:23:27.981666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:27.982406 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_14d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:23:29.049489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.066 seconds
[0m01:23:29.055975 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:29.056964 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m01:23:29.161083 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.103 seconds
[0m01:23:29.168675 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:29.169748 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m01:23:29.276239 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.106 seconds
[0m01:23:29.283421 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:29.284541 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m01:23:29.404396 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.118 seconds
[0m01:23:29.412063 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:29.413093 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m01:23:29.505765 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.091 seconds
[0m01:23:29.518642 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:29.519993 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m01:23:29.817543 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.296 seconds
[0m01:23:29.847081 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:29.847953 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_14d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:23:30.188188 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.339 seconds
[0m01:23:30.194068 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:30.195302 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:23:30.271749 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.075 seconds
[0m01:23:30.273626 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:30.278647 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:30.279656 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
BEGIN
[0m01:23:30.453651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m01:23:30.454815 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:30.455716 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_14D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_14D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:23:31.105791 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.649 seconds
[0m01:23:31.107296 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:23:31.108159 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
COMMIT
[0m01:23:31.449957 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.341 seconds
[0m01:23:31.475006 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m01:23:31.602662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5932bd-c5e0-4983-964a-8d8b7c130b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6dd3c230>]}
[0m01:23:31.605195 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_crypto_abstract_metrics ................ [[32mSUCCESS 20[0m in 4.13s]
[0m01:23:31.607394 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:23:31.608291 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:23:31.609296 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m01:23:31.610317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m01:23:31.610877 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:23:31.618466 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:23:31.622729 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:31.623236 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m01:23:31.623652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:32.090029 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.466 seconds
[0m01:23:32.096597 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:32.097169 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:23:33.082115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.984 seconds
[0m01:23:33.086574 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:33.087153 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m01:23:33.188436 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.101 seconds
[0m01:23:33.191694 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:33.192040 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m01:23:33.283430 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.091 seconds
[0m01:23:33.287776 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:33.288300 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m01:23:33.397532 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.108 seconds
[0m01:23:33.406051 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:33.407319 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m01:23:33.526348 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.118 seconds
[0m01:23:33.536727 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:33.537869 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m01:23:33.640114 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.102 seconds
[0m01:23:33.643992 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:33.644529 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:23:33.978335 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.333 seconds
[0m01:23:33.979951 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:33.980681 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:23:34.077285 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.096 seconds
[0m01:23:34.079339 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:34.085203 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:34.086817 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
BEGIN
[0m01:23:34.195819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m01:23:34.197213 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:34.198059 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:23:34.836634 [debug] [Thread-1 (]: SQL status: SUCCESS 20 in 0.637 seconds
[0m01:23:34.838134 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:23:34.838938 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
COMMIT
[0m01:23:35.226696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m01:23:35.229526 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m01:23:35.358316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5932bd-c5e0-4983-964a-8d8b7c130b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6cbdbf50>]}
[0m01:23:35.360859 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 20[0m in 3.75s]
[0m01:23:35.364146 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:23:35.367327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:35.368297 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m01:23:35.368888 [info ] [MainThread]: 
[0m01:23:35.370625 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 9.86 seconds (9.86s).
[0m01:23:35.372730 [debug] [MainThread]: Command end result
[0m01:23:35.422722 [info ] [MainThread]: 
[0m01:23:35.429657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:35.432690 [info ] [MainThread]: 
[0m01:23:35.433328 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:23:35.435730 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.651963, "process_user_time": 2.988601, "process_kernel_time": 0.228792, "process_mem_max_rss": "209344", "process_out_blocks": "2569", "process_in_blocks": "0"}
[0m01:23:35.436373 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:23:35.436281 after 10.65 seconds
[0m01:23:35.436892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91482300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91130e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911301d0>]}
[0m01:23:35.437240 [debug] [MainThread]: Flushing usage events
[0m01:39:04.508541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfe5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfe4a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cf12e0>]}
[0m01:39:04.508635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb73c18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb77fb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c71af0>]}


============================== 01:39:04.512352 | 6a909f5f-96c1-47cc-b319-36a62804d3f0 ==============================
[0m01:39:04.512352 [info ] [MainThread]: Running with dbt=1.8.7


============================== 01:39:04.512688 | 83413d4f-7b10-4637-9e3d-082275337138 ==============================
[0m01:39:04.512688 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:39:04.512770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m01:39:04.513213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:39:04.655277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83413d4f-7b10-4637-9e3d-082275337138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ff7590>]}
[0m01:39:04.663504 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:39:04.704566 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wc81xxas'
[0m01:39:04.704851 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:39:04.846305 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:39:04.847447 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:39:04.919618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff667ef860>]}
[0m01:39:04.920493 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:39:04.922976 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:39:04.947422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829058b0>]}
[0m01:39:04.948100 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:39:05.010114 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:39:05.112769 [debug] [MainThread]: Partial parsing enabled: 51 files deleted, 0 files added, 0 files changed.
[0m01:39:05.113173 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_add.sql
[0m01:39:05.113417 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_series.sql
[0m01:39:05.113826 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/union.sql
[0m01:39:05.114148 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m01:39:05.114528 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m01:39:05.114721 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:39:05.115033 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/pivot.sql
[0m01:39:05.115339 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m01:39:05.115549 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:39:05.119147 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m01:39:05.119335 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m01:39:05.119518 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m01:39:05.119691 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:39:05.119845 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m01:39:05.120179 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equality.sql
[0m01:39:05.120347 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m01:39:05.120498 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_host.sql
[0m01:39:05.120752 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m01:39:05.120891 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_constant.sql
[0m01:39:05.121031 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/groupby.sql
[0m01:39:05.121444 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_parameter.sql
[0m01:39:05.121725 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/web/get_url_path.sql
[0m01:39:05.121905 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m01:39:05.122146 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m01:39:05.122329 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m01:39:05.122554 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/unpivot.sql
[0m01:39:05.122721 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/safe_divide.sql
[0m01:39:05.122878 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m01:39:05.123031 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m01:39:05.123206 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m01:39:05.123352 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck_table.sql
[0m01:39:05.123654 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m01:39:05.123871 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/nullcheck.sql
[0m01:39:05.124039 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m01:39:05.124186 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/deduplicate.sql
[0m01:39:05.124333 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m01:39:05.124473 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/width_bucket.sql
[0m01:39:05.124608 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_column_values.sql
[0m01:39:05.124777 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/recency.sql
[0m01:39:05.125547 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m01:39:05.125767 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m01:39:05.125944 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m01:39:05.126130 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m01:39:05.126298 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/get_single_value.sql
[0m01:39:05.126448 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/surrogate_key.sql
[0m01:39:05.126609 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/star.sql
[0m01:39:05.126759 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m01:39:05.126910 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:39:05.127095 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/haversine_distance.sql
[0m01:39:05.127237 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m01:39:05.127428 [debug] [MainThread]: Partial parsing: deleted file: dbt_utils://macros/sql/date_spine.sql
[0m01:39:05.171442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6651d9a0>]}
[0m01:39:05.225084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66464800>]}
[0m01:39:05.225389 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 459 macros
[0m01:39:05.225839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66254b30>]}
[0m01:39:05.226686 [info ] [MainThread]: 
[0m01:39:05.227062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:39:05.229174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m01:39:05.235851 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m01:39:05.236185 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m01:39:05.236369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:05.654823 [info ] [MainThread]: Installed from version 1.3.0
[0m01:39:05.655399 [info ] [MainThread]: Up to date!
[0m01:39:05.655711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '83413d4f-7b10-4637-9e3d-082275337138', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a4a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78c4200>]}
[0m01:39:05.656368 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.18964, "process_user_time": 1.047385, "process_kernel_time": 0.154203, "process_mem_max_rss": "209352", "process_in_blocks": "1376", "process_out_blocks": "734"}
[0m01:39:05.656700 [debug] [MainThread]: Command `dbt deps` succeeded at 01:39:05.656630 after 1.19 seconds
[0m01:39:05.656943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb73c18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7311be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78c4200>]}
[0m01:39:05.657197 [debug] [MainThread]: Flushing usage events
[0m01:39:06.749432 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.513 seconds
[0m01:39:06.750632 [debug] [ThreadPool]: On list_dev: Close
[0m01:39:06.865870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m01:39:06.872030 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m01:39:06.872350 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m01:39:06.872656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:07.449895 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.577 seconds
[0m01:39:07.453919 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m01:39:07.592862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m01:39:07.595748 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m01:39:07.596120 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m01:39:07.596428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:08.088426 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.492 seconds
[0m01:39:08.091212 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m01:39:08.243571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f4a8fe0>]}
[0m01:39:08.244364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:39:08.244866 [info ] [MainThread]: 
[0m01:39:08.253557 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m01:39:08.254213 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m01:39:08.254921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m01:39:08.255266 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m01:39:08.260179 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m01:39:08.262494 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m01:39:08.279838 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m01:39:08.281454 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m01:39:08.281721 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m01:39:08.281978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:08.959896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m01:39:08.989957 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m01:39:09.126440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e639e20>]}
[0m01:39:09.127988 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.87s]
[0m01:39:09.129170 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m01:39:09.130973 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m01:39:09.131808 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m01:39:09.132828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m01:39:09.133344 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m01:39:09.136562 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m01:39:09.138510 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m01:39:09.140915 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m01:39:09.142660 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m01:39:09.143050 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m01:39:09.143448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:10.119477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.976 seconds
[0m01:39:10.124097 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m01:39:10.284817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff660f8110>]}
[0m01:39:10.287273 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 1.15s]
[0m01:39:10.290051 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m01:39:10.291459 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m01:39:10.292610 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m01:39:10.294096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m01:39:10.294929 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m01:39:10.299613 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m01:39:10.302044 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m01:39:10.304787 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m01:39:10.306745 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m01:39:10.307160 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m01:39:10.307615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:11.130394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m01:39:11.134777 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m01:39:11.279570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65777fb0>]}
[0m01:39:11.281663 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.98s]
[0m01:39:11.284569 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m01:39:11.285616 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m01:39:11.286579 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m01:39:11.287928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m01:39:11.288838 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m01:39:11.294272 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m01:39:11.296720 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m01:39:11.299255 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m01:39:11.300707 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m01:39:11.301145 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m01:39:11.301730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:12.121511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m01:39:12.124596 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m01:39:12.266489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6563d670>]}
[0m01:39:12.271454 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.98s]
[0m01:39:12.276865 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m01:39:12.279240 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:39:12.281672 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m01:39:12.285485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m01:39:12.286546 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:39:12.291772 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m01:39:12.294203 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:39:12.312563 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m01:39:12.314798 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m01:39:12.315113 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m01:39:12.315418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:13.900111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.584 seconds
[0m01:39:13.904912 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m01:39:14.058765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a909f5f-96c1-47cc-b319-36a62804d3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dd1100>]}
[0m01:39:14.060830 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.77s]
[0m01:39:14.065617 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:39:14.072145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:39:14.073504 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m01:39:14.074058 [info ] [MainThread]: 
[0m01:39:14.074730 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 8.85 seconds (8.85s).
[0m01:39:14.075980 [debug] [MainThread]: Command end result
[0m01:39:14.114162 [info ] [MainThread]: 
[0m01:39:14.114792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:39:14.115233 [info ] [MainThread]: 
[0m01:39:14.115671 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:39:14.120135 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.653177, "process_user_time": 2.873412, "process_kernel_time": 0.220335, "process_mem_max_rss": "209232", "process_in_blocks": "1640", "process_out_blocks": "3043"}
[0m01:39:14.120774 [debug] [MainThread]: Command `dbt run` succeeded at 01:39:14.120702 after 9.65 seconds
[0m01:39:14.121338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7d78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cf12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e292420>]}
[0m01:39:14.121690 [debug] [MainThread]: Flushing usage events
[0m01:39:16.845225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbfe3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba0fdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba0fd670>]}


============================== 01:39:16.848608 | f3ecf2a1-0d63-4fc8-b29b-2590d8bbe065 ==============================
[0m01:39:16.848608 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:39:16.849726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m01:39:17.273609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3ecf2a1-0d63-4fc8-b29b-2590d8bbe065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928a88f0>]}
[0m01:39:17.293166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3ecf2a1-0d63-4fc8-b29b-2590d8bbe065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928f9640>]}
[0m01:39:17.293619 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:39:17.342716 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:39:17.424535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m01:39:17.424943 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m01:39:17.425246 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m01:39:17.425482 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m01:39:17.425725 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m01:39:17.425950 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m01:39:17.426163 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m01:39:17.426364 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m01:39:17.426557 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m01:39:17.426760 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m01:39:17.426966 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m01:39:17.427175 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m01:39:17.427380 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m01:39:17.427574 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m01:39:17.427769 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m01:39:17.427956 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m01:39:17.428155 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m01:39:17.428333 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m01:39:17.428526 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m01:39:17.428715 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m01:39:17.428904 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m01:39:17.429109 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m01:39:17.429312 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m01:39:17.429511 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m01:39:17.429704 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m01:39:17.429896 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m01:39:17.430089 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m01:39:17.430286 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m01:39:17.430483 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m01:39:17.430672 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m01:39:17.430861 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m01:39:17.431062 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m01:39:17.431249 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m01:39:17.431438 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m01:39:17.431625 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m01:39:17.431813 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m01:39:17.431998 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m01:39:17.432224 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m01:39:17.432404 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m01:39:17.432585 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m01:39:17.432764 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m01:39:17.432952 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m01:39:17.433215 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m01:39:17.433410 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m01:39:17.433600 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m01:39:17.433791 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m01:39:17.433984 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m01:39:17.434178 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m01:39:17.434374 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m01:39:17.434568 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m01:39:17.434751 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m01:39:17.434946 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m01:39:17.555383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3ecf2a1-0d63-4fc8-b29b-2590d8bbe065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922dd1f0>]}
[0m01:39:17.617746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3ecf2a1-0d63-4fc8-b29b-2590d8bbe065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9212f680>]}
[0m01:39:17.618134 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m01:39:17.618659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3ecf2a1-0d63-4fc8-b29b-2590d8bbe065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff925fce00>]}
[0m01:39:17.619633 [info ] [MainThread]: 
[0m01:39:17.620054 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:39:17.621233 [debug] [MainThread]: Command end result
[0m01:39:17.643572 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8425684, "process_user_time": 2.395184, "process_kernel_time": 0.233186, "process_mem_max_rss": "209340", "process_out_blocks": "3738", "process_in_blocks": "0"}
[0m01:39:17.643937 [debug] [MainThread]: Command `dbt test` succeeded at 01:39:17.643873 after 0.84 seconds
[0m01:39:17.644172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbfe3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f469c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922ef7a0>]}
[0m01:39:17.644376 [debug] [MainThread]: Flushing usage events
[0m01:39:20.573169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4a5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f722c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e9b22a0>]}


============================== 01:39:20.576441 | db1b5dcd-2633-497a-ab43-ee01fb9e00c2 ==============================
[0m01:39:20.576441 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:39:20.576769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:39:20.933501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db1b5dcd-2633-497a-ab43-ee01fb9e00c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e538ce0>]}
[0m01:39:20.952554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db1b5dcd-2633-497a-ab43-ee01fb9e00c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff784fd0d0>]}
[0m01:39:20.952958 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:39:20.996229 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:39:21.060454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:39:21.060727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:39:21.077034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db1b5dcd-2633-497a-ab43-ee01fb9e00c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7822cd10>]}
[0m01:39:21.129832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db1b5dcd-2633-497a-ab43-ee01fb9e00c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73ed72c0>]}
[0m01:39:21.130101 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m01:39:21.130280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db1b5dcd-2633-497a-ab43-ee01fb9e00c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c696d20>]}
[0m01:39:21.131122 [info ] [MainThread]: 
[0m01:39:21.131434 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:39:21.133479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m01:39:21.139921 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m01:39:21.140141 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m01:39:21.140296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:39:21.605258 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.465 seconds
[0m01:39:21.609508 [debug] [ThreadPool]: On list_dev: Close
[0m01:39:21.741715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m01:39:21.756625 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m01:39:21.757755 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m01:39:21.758253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:22.296286 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.538 seconds
[0m01:39:22.301360 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m01:39:22.431956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m01:39:22.438182 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m01:39:22.439014 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m01:39:22.439656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:39:22.936215 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.496 seconds
[0m01:39:22.940013 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m01:39:23.067289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db1b5dcd-2633-497a-ab43-ee01fb9e00c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d178fe0>]}
[0m01:39:23.067866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:39:23.068205 [info ] [MainThread]: 
[0m01:39:23.074712 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:39:23.075202 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m01:39:23.075627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m01:39:23.075942 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:39:23.086575 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:39:23.113282 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:23.113651 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m01:39:23.113881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:23.587470 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.473 seconds
[0m01:39:23.632315 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:23.632862 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_14d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:39:24.723716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.090 seconds
[0m01:39:24.725526 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:24.725814 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m01:39:24.837758 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.112 seconds
[0m01:39:24.840111 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:24.840551 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m01:39:24.915581 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.075 seconds
[0m01:39:24.917613 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:24.917871 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m01:39:25.035097 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.117 seconds
[0m01:39:25.037239 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:25.037546 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m01:39:25.117685 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.080 seconds
[0m01:39:25.121843 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:25.122188 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m01:39:25.271581 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.149 seconds
[0m01:39:25.281691 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:25.282046 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_14d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:39:25.560278 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.278 seconds
[0m01:39:25.563869 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:25.564260 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:39:25.671839 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.107 seconds
[0m01:39:25.672375 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:25.674719 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:25.674964 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
BEGIN
[0m01:39:25.883173 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m01:39:25.883523 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:25.883756 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_14D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_14D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:39:26.604018 [debug] [Thread-1 (]: SQL status: SUCCESS 200 in 0.720 seconds
[0m01:39:26.605374 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:39:26.605891 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
COMMIT
[0m01:39:26.934398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m01:39:26.948975 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m01:39:27.073530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db1b5dcd-2633-497a-ab43-ee01fb9e00c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7855c9b0>]}
[0m01:39:27.106923 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_crypto_abstract_metrics ................ [[32mSUCCESS 200[0m in 3.99s]
[0m01:39:27.109908 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:39:27.114768 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:39:27.118800 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m01:39:27.124777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m01:39:27.126641 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:39:27.132759 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:39:27.135874 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:27.136257 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m01:39:27.136521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:39:27.512404 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.375 seconds
[0m01:39:27.522825 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:27.524116 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:39:28.459334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.934 seconds
[0m01:39:28.466106 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:28.467126 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m01:39:28.634544 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.166 seconds
[0m01:39:28.641258 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:28.642460 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m01:39:28.741571 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.098 seconds
[0m01:39:28.749985 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:28.751684 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m01:39:28.853712 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.100 seconds
[0m01:39:28.864288 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:28.865785 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m01:39:28.993689 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.126 seconds
[0m01:39:29.002290 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:29.003256 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m01:39:29.135178 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.131 seconds
[0m01:39:29.148138 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:29.149296 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:39:29.592909 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.443 seconds
[0m01:39:29.596374 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:29.597674 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:39:29.730359 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.132 seconds
[0m01:39:29.731852 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:29.734852 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:29.735427 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
BEGIN
[0m01:39:29.864723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m01:39:29.865543 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:29.866149 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:39:30.415787 [debug] [Thread-1 (]: SQL status: SUCCESS 200 in 0.549 seconds
[0m01:39:30.417371 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:39:30.418786 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
COMMIT
[0m01:39:30.806945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m01:39:30.810457 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m01:39:30.922735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db1b5dcd-2633-497a-ab43-ee01fb9e00c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff732c8290>]}
[0m01:39:30.923731 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 200[0m in 3.80s]
[0m01:39:30.924433 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:39:30.926258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:39:30.926752 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m01:39:30.927129 [info ] [MainThread]: 
[0m01:39:30.927403 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m01:39:30.928242 [debug] [MainThread]: Command end result
[0m01:39:30.979798 [info ] [MainThread]: 
[0m01:39:30.980504 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:39:30.981247 [info ] [MainThread]: 
[0m01:39:30.981758 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:39:30.983889 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.445642, "process_user_time": 2.739372, "process_kernel_time": 0.168207, "process_mem_max_rss": "209344", "process_out_blocks": "2569", "process_in_blocks": "0"}
[0m01:39:30.984461 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:39:30.984339 after 10.45 seconds
[0m01:39:30.984863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4a5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c30da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7953e210>]}
[0m01:39:30.985235 [debug] [MainThread]: Flushing usage events
[0m01:52:08.604996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b0e85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98497da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98494380>]}


============================== 01:52:08.608999 | b29c8ddd-58f5-4485-8b5a-e4e8dce47ce3 ==============================
[0m01:52:08.608999 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:52:08.609316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:52:08.649446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b29c8ddd-58f5-4485-8b5a-e4e8dce47ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e92270>]}
[0m01:52:08.654690 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:52:08.694915 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8zdhqr_5'
[0m01:52:08.695180 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:52:08.825634 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:52:08.826962 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:52:08.915400 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:52:08.919502 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:52:09.578670 [info ] [MainThread]: Installed from version 1.3.0
[0m01:52:09.579448 [info ] [MainThread]: Up to date!
[0m01:52:09.580467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b29c8ddd-58f5-4485-8b5a-e4e8dce47ce3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a9d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97bd7ef0>]}
[0m01:52:09.582190 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0146667, "process_user_time": 0.978767, "process_kernel_time": 0.130568, "process_mem_max_rss": "205404", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m01:52:09.582615 [debug] [MainThread]: Command `dbt deps` succeeded at 01:52:09.582531 after 1.02 seconds
[0m01:52:09.582880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4b8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a103b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f23c20>]}
[0m01:52:09.583106 [debug] [MainThread]: Flushing usage events
[0m01:52:12.728215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bee5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bfc5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d6ed820>]}


============================== 01:52:12.731651 | d94f8eb9-56f6-4294-9a33-f98e926214f9 ==============================
[0m01:52:12.731651 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:52:12.732763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:52:13.239608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ce2f5f0>]}
[0m01:52:13.259074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5849fb30>]}
[0m01:52:13.259599 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:52:13.313163 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:52:13.419171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:52:13.419752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:52:13.441471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff58a30d70>]}
[0m01:52:13.510568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff53c72c90>]}
[0m01:52:13.510982 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m01:52:13.511745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff539ad6a0>]}
[0m01:52:13.512951 [info ] [MainThread]: 
[0m01:52:13.513811 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:52:13.517059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m01:52:13.525337 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m01:52:13.525776 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m01:52:13.526064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:13.970528 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.444 seconds
[0m01:52:13.972715 [debug] [ThreadPool]: On list_dev: Close
[0m01:52:14.110969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m01:52:14.121231 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m01:52:14.121760 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m01:52:14.122186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:52:14.706796 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.584 seconds
[0m01:52:14.710749 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m01:52:14.838875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m01:52:14.844717 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m01:52:14.845906 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m01:52:14.846719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:52:15.299448 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.453 seconds
[0m01:52:15.300897 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m01:52:15.414155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff539f27e0>]}
[0m01:52:15.414958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:52:15.415975 [info ] [MainThread]: 
[0m01:52:15.424746 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m01:52:15.425362 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m01:52:15.426068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m01:52:15.426426 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m01:52:15.431639 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m01:52:15.433914 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m01:52:15.448781 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m01:52:15.450112 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m01:52:15.450416 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m01:52:15.450690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:16.062647 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m01:52:16.088874 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m01:52:16.227707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff53ecc320>]}
[0m01:52:16.229962 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.80s]
[0m01:52:16.232486 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m01:52:16.234687 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m01:52:16.235693 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m01:52:16.237175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m01:52:16.238213 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m01:52:16.243767 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m01:52:16.246428 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m01:52:16.248976 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m01:52:16.251111 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m01:52:16.251625 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        CASE 
            WHEN price_close_7d_ago IS NULL THEN NULL
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    price_close_7d_ago,
    price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m01:52:16.252149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:16.897135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m01:52:16.902198 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m01:52:17.079364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff537557c0>]}
[0m01:52:17.080848 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.84s]
[0m01:52:17.082390 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m01:52:17.082827 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m01:52:17.083348 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m01:52:17.084283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m01:52:17.084789 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m01:52:17.087091 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m01:52:17.088252 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m01:52:17.090011 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m01:52:17.091327 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m01:52:17.091611 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_gain_14d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW) AS avg_loss_14d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_14d,
    avg_loss_14d,
    CASE WHEN avg_loss_14d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_14d / avg_loss_14d))) 
    END AS rsi_14d
FROM avg_gain_loss
  );
[0m01:52:17.092103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:17.726106 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m01:52:17.728238 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m01:52:17.839599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff52d3f410>]}
[0m01:52:17.843095 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.76s]
[0m01:52:17.843597 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m01:52:17.843939 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m01:52:17.844265 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m01:52:17.844672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m01:52:17.844945 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m01:52:17.846550 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m01:52:17.847413 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m01:52:17.848784 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m01:52:17.849760 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m01:52:17.850025 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m01:52:17.850250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:18.654362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m01:52:18.659320 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m01:52:18.786403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff52d3f230>]}
[0m01:52:18.787184 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.94s]
[0m01:52:18.788230 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m01:52:18.789139 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:52:18.789588 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m01:52:18.790129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m01:52:18.790399 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:52:18.792921 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m01:52:18.794688 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:52:18.807435 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m01:52:18.808875 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m01:52:18.809221 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_14d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7D, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_14d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7D,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m01:52:18.809500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:20.645114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.836 seconds
[0m01:52:20.646295 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m01:52:20.748171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd94f8eb9-56f6-4294-9a33-f98e926214f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff52de49e0>]}
[0m01:52:20.748646 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.96s]
[0m01:52:20.748993 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m01:52:20.749826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:20.750054 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m01:52:20.750324 [info ] [MainThread]: 
[0m01:52:20.750687 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.24 seconds (7.24s).
[0m01:52:20.751366 [debug] [MainThread]: Command end result
[0m01:52:20.773033 [info ] [MainThread]: 
[0m01:52:20.774404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:52:20.774967 [info ] [MainThread]: 
[0m01:52:20.775359 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:52:20.777623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.087573, "process_user_time": 3.087183, "process_kernel_time": 0.301586, "process_mem_max_rss": "207356", "process_out_blocks": "2563", "process_in_blocks": "0"}
[0m01:52:20.778136 [debug] [MainThread]: Command `dbt run` succeeded at 01:52:20.778083 after 8.09 seconds
[0m01:52:20.778424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bee5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b64a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbc7f50>]}
[0m01:52:20.778634 [debug] [MainThread]: Flushing usage events
[0m01:52:23.276382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80adc530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80adf620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80adfd70>]}


============================== 01:52:23.279809 | db5f7357-965a-4d65-a29e-15f207f614a6 ==============================
[0m01:52:23.279809 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:52:23.280239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m01:52:23.689775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db5f7357-965a-4d65-a29e-15f207f614a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6213f500>]}
[0m01:52:23.709137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db5f7357-965a-4d65-a29e-15f207f614a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d16d880>]}
[0m01:52:23.709570 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:52:23.754500 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:52:23.819160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:52:23.819426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:52:23.837527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db5f7357-965a-4d65-a29e-15f207f614a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5cb16c30>]}
[0m01:52:23.896935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db5f7357-965a-4d65-a29e-15f207f614a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c4ae330>]}
[0m01:52:23.897243 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m01:52:23.897666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5f7357-965a-4d65-a29e-15f207f614a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5c478260>]}
[0m01:52:23.898408 [info ] [MainThread]: 
[0m01:52:23.898690 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:52:23.899546 [debug] [MainThread]: Command end result
[0m01:52:23.916434 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6769871, "process_user_time": 2.263554, "process_kernel_time": 0.177798, "process_mem_max_rss": "207240", "process_out_blocks": "2481", "process_in_blocks": "0"}
[0m01:52:23.916749 [debug] [MainThread]: Command `dbt test` succeeded at 01:52:23.916686 after 0.68 seconds
[0m01:52:23.916979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800b8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80377f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804862a0>]}
[0m01:52:23.917186 [debug] [MainThread]: Flushing usage events
[0m01:52:27.224957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bc7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff846c3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874e5070>]}


============================== 01:52:27.228589 | 2d4bf6a1-933e-4748-97fc-d815b942c29f ==============================
[0m01:52:27.228589 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:52:27.229511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:52:27.665199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d4bf6a1-933e-4748-97fc-d815b942c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff624725a0>]}
[0m01:52:27.684826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d4bf6a1-933e-4748-97fc-d815b942c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61a894c0>]}
[0m01:52:27.685290 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:52:27.733187 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:52:27.806445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:52:27.806772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:52:27.823423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d4bf6a1-933e-4748-97fc-d815b942c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff61472000>]}
[0m01:52:27.882184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d4bf6a1-933e-4748-97fc-d815b942c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60bc2900>]}
[0m01:52:27.882540 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m01:52:27.883036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d4bf6a1-933e-4748-97fc-d815b942c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60a1f470>]}
[0m01:52:27.883897 [info ] [MainThread]: 
[0m01:52:27.884348 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:52:27.886432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m01:52:27.892982 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m01:52:27.893209 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m01:52:27.893423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:52:28.349520 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.456 seconds
[0m01:52:28.356071 [debug] [ThreadPool]: On list_dev: Close
[0m01:52:28.478667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m01:52:28.485747 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m01:52:28.486105 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m01:52:28.486447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:52:28.947325 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.460 seconds
[0m01:52:28.955811 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m01:52:29.084983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m01:52:29.092722 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m01:52:29.093588 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m01:52:29.094103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:52:29.615624 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.521 seconds
[0m01:52:29.617945 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m01:52:29.736130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d4bf6a1-933e-4748-97fc-d815b942c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff609d8cb0>]}
[0m01:52:29.738097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:52:29.740919 [info ] [MainThread]: 
[0m01:52:29.756463 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:52:29.757471 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m01:52:29.758535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m01:52:29.759114 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:52:29.773928 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:52:29.801625 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:29.802036 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m01:52:29.802291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:30.546820 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.744 seconds
[0m01:52:30.576501 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:30.577099 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_14d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:52:31.657211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.079 seconds
[0m01:52:31.663528 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:31.664463 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m01:52:31.759348 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.094 seconds
[0m01:52:31.764689 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:31.765307 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m01:52:31.845209 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.079 seconds
[0m01:52:31.853512 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:31.854724 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m01:52:31.937902 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.081 seconds
[0m01:52:31.947030 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:31.948302 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m01:52:32.031662 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.082 seconds
[0m01:52:32.044437 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:32.045569 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m01:52:32.148352 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.102 seconds
[0m01:52:32.182593 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:32.183278 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_14d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:52:32.326334 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.142 seconds
[0m01:52:32.333235 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:32.334694 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:52:32.417019 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.081 seconds
[0m01:52:32.419278 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:32.425271 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:32.426404 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
BEGIN
[0m01:52:32.544416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m01:52:32.546773 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:32.547916 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_14D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_14D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:52:33.242614 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.693 seconds
[0m01:52:33.244453 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m01:52:33.245806 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
COMMIT
[0m01:52:33.535545 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m01:52:33.569515 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m01:52:33.687583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d4bf6a1-933e-4748-97fc-d815b942c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60c59a90>]}
[0m01:52:33.689032 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_crypto_abstract_metrics ................ [[32mSUCCESS 0[0m in 3.93s]
[0m01:52:33.690008 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m01:52:33.690383 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:52:33.690935 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m01:52:33.691620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m01:52:33.692026 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:52:33.697305 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:52:33.700326 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:33.700767 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m01:52:33.701072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:52:34.176939 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.476 seconds
[0m01:52:34.186581 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:34.187497 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m01:52:35.077864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.889 seconds
[0m01:52:35.085871 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:35.086788 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m01:52:35.213355 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.125 seconds
[0m01:52:35.220925 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:35.221968 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m01:52:35.319902 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.097 seconds
[0m01:52:35.323867 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:35.324310 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m01:52:35.398259 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.073 seconds
[0m01:52:35.400694 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:35.400997 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m01:52:35.498246 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.097 seconds
[0m01:52:35.501312 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:35.501750 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m01:52:35.574852 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.072 seconds
[0m01:52:35.581141 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:35.581949 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m01:52:35.794812 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.212 seconds
[0m01:52:35.797619 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:35.799137 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m01:52:35.881855 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.081 seconds
[0m01:52:35.884171 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:35.889980 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:35.891068 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
BEGIN
[0m01:52:36.048258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m01:52:36.049816 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:36.050557 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m01:52:36.744779 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.693 seconds
[0m01:52:36.745379 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m01:52:36.745709 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
COMMIT
[0m01:52:36.996938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m01:52:36.999369 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m01:52:37.114104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d4bf6a1-933e-4748-97fc-d815b942c29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff606da420>]}
[0m01:52:37.115158 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 0[0m in 3.42s]
[0m01:52:37.116380 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m01:52:37.117809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:52:37.118127 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m01:52:37.118439 [info ] [MainThread]: 
[0m01:52:37.118869 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 9.23 seconds (9.23s).
[0m01:52:37.119547 [debug] [MainThread]: Command end result
[0m01:52:37.146505 [info ] [MainThread]: 
[0m01:52:37.147070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:52:37.147417 [info ] [MainThread]: 
[0m01:52:37.147694 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:52:37.148686 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.967226, "process_user_time": 2.936984, "process_kernel_time": 0.244998, "process_mem_max_rss": "205396", "process_out_blocks": "2569", "process_in_blocks": "0"}
[0m01:52:37.149108 [debug] [MainThread]: Command `dbt snapshot` succeeded at 01:52:37.149039 after 9.97 seconds
[0m01:52:37.149421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bc7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c077a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6173f9b0>]}
[0m01:52:37.149639 [debug] [MainThread]: Flushing usage events
[0m05:46:38.397335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926b5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9251c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9251c920>]}
[0m05:46:38.397333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a19efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8998f230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b830b0>]}


============================== 05:46:38.401082 | 3e23a148-7bf6-4466-81b1-ee8136b4bac2 ==============================
[0m05:46:38.401082 [info ] [MainThread]: Running with dbt=1.8.7


============================== 05:46:38.401150 | be48819c-de53-4d0a-aa41-bafb21a640cb ==============================
[0m05:46:38.401150 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:46:38.401451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:46:38.401488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:46:38.445624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be48819c-de53-4d0a-aa41-bafb21a640cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8966f4a0>]}
[0m05:46:38.445625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e23a148-7bf6-4466-81b1-ee8136b4bac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91d6ac30>]}
[0m05:46:38.451240 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:46:38.451240 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:46:38.453250 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'run_functional_test.sh'
[0m05:46:38.455523 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/deps.py", line 233, in run
    system.rmtree(self.project.packages_install_path)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 715, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 785, in rmtree
    _rmtree_safe_fd(fd, path, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 686, in _rmtree_safe_fd
    _rmtree_safe_fd(dirfd, fullname, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 717, in _rmtree_safe_fd
    onexc(os.unlink, fullname, err)
  File "/usr/local/lib/python3.12/shutil.py", line 764, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 715, in _rmtree_safe_fd
    os.unlink(entry.name, dir_fd=topfd)
FileNotFoundError: [Errno 2] No such file or directory: 'run_functional_test.sh'

[0m05:46:38.456208 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.10249696, "process_user_time": 0.865254, "process_kernel_time": 0.074021, "process_mem_max_rss": "209308", "process_out_blocks": "7", "command_success": false, "process_in_blocks": "0"}
[0m05:46:38.456538 [debug] [MainThread]: Command `dbt deps` failed at 05:46:38.456487 after 0.10 seconds
[0m05:46:38.456900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964c6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bc6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918f2210>]}
[0m05:46:38.457177 [debug] [MainThread]: Flushing usage events
[0m05:46:38.496602 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_21vom5w'
[0m05:46:38.496932 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:46:38.642574 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:46:38.643911 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:46:38.743134 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:46:38.746778 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:46:39.392484 [info ] [MainThread]: Installed from version 1.3.0
[0m05:46:39.392877 [info ] [MainThread]: Up to date!
[0m05:46:39.393490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'be48819c-de53-4d0a-aa41-bafb21a640cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a35130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff893fbda0>]}
[0m05:46:39.394333 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0406048, "process_user_time": 0.962167, "process_kernel_time": 0.115539, "process_mem_max_rss": "209336", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m05:46:39.394634 [debug] [MainThread]: Command `dbt deps` succeeded at 05:46:39.394575 after 1.04 seconds
[0m05:46:39.394852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c815370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa4b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7465a0>]}
[0m05:46:39.395052 [debug] [MainThread]: Flushing usage events
[0m05:46:42.136963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4eb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f2351f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa23c94c0>]}


============================== 05:46:42.140135 | d541cfdb-8642-4f09-8bdb-81f38ef94ca3 ==============================
[0m05:46:42.140135 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:46:42.140643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:46:42.502034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e930ce0>]}
[0m05:46:42.520242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77aa32f0>]}
[0m05:46:42.520665 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:46:42.573459 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:46:42.671380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m05:46:42.671814 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/input/crypto_rsi.sql
[0m05:46:42.672070 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/output/crypto_abstract_metrics.sql
[0m05:46:42.672329 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/input/crypto_price_momentum.sql
[0m05:46:42.767262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77303680>]}
[0m05:46:42.819310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff776cb1d0>]}
[0m05:46:42.819608 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m05:46:42.820035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff775e8d10>]}
[0m05:46:42.820835 [info ] [MainThread]: 
[0m05:46:42.821208 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:46:42.823240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:46:42.829089 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:46:42.829296 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:46:42.829457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:46:43.403954 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.574 seconds
[0m05:46:43.407578 [debug] [ThreadPool]: On list_dev: Close
[0m05:46:43.539541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m05:46:43.548792 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:46:43.549280 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:46:43.549666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:46:43.971428 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.421 seconds
[0m05:46:43.976350 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:46:44.134368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:46:44.140091 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:46:44.140962 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:46:44.141844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:46:44.610156 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.468 seconds
[0m05:46:44.612318 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:46:44.721552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff773f3a70>]}
[0m05:46:44.722250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:46:44.722931 [info ] [MainThread]: 
[0m05:46:44.731274 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m05:46:44.731824 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m05:46:44.732393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m05:46:44.732755 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m05:46:44.737850 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m05:46:44.740731 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m05:46:44.756112 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m05:46:44.757574 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m05:46:44.757884 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m05:46:44.758168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:45.358911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m05:46:45.380180 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m05:46:45.490840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77aa0920>]}
[0m05:46:45.492081 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.76s]
[0m05:46:45.493462 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m05:46:45.494726 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m05:46:45.495431 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m05:46:45.496273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m05:46:45.496784 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m05:46:45.500015 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m05:46:45.502350 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m05:46:45.504704 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m05:46:45.506775 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m05:46:45.507260 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        COALESCE(LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date),0) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        
        CASE 
            WHEN price_close_7d_ago = 0 THEN 0
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    COALESCE(price_close_7d_ago, 0) as price_close_7d_ago,
    COALESCE(price_momentum_7d, 0) as price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m05:46:45.507669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:46.263836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m05:46:46.268333 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m05:46:46.401650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76792e70>]}
[0m05:46:46.403289 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.90s]
[0m05:46:46.404775 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m05:46:46.405481 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m05:46:46.406378 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m05:46:46.407304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m05:46:46.407843 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m05:46:46.413255 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m05:46:46.415681 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m05:46:46.417769 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m05:46:46.419582 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m05:46:46.420001 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_gain_7d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_loss_7d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_7d,
    avg_loss_7d,
    CASE WHEN avg_loss_7d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_7d / avg_loss_7d))) 
    END AS rsi_7d
FROM avg_gain_loss
  );
[0m05:46:46.420446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:47.166323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m05:46:47.172126 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m05:46:47.289411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff767e9e50>]}
[0m05:46:47.291451 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.88s]
[0m05:46:47.293742 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m05:46:47.294811 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m05:46:47.295805 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m05:46:47.297023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m05:46:47.297713 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m05:46:47.302437 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m05:46:47.304870 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m05:46:47.308366 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m05:46:47.310241 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m05:46:47.310777 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m05:46:47.311233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:48.042671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m05:46:48.047143 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m05:46:48.163462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff76bb9280>]}
[0m05:46:48.165269 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.87s]
[0m05:46:48.167084 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m05:46:48.169033 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:46:48.170219 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m05:46:48.171521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m05:46:48.172181 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:46:48.176364 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m05:46:48.178523 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:46:48.194923 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m05:46:48.196796 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m05:46:48.197208 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_7d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7d, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_7d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7d,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m05:46:48.197552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:49.619631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.422 seconds
[0m05:46:49.624542 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m05:46:49.740730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd541cfdb-8642-4f09-8bdb-81f38ef94ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff767c8c50>]}
[0m05:46:49.742824 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.57s]
[0m05:46:49.744509 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:46:49.746741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:46:49.747324 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m05:46:49.747967 [info ] [MainThread]: 
[0m05:46:49.748740 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 6.93 seconds (6.93s).
[0m05:46:49.750145 [debug] [MainThread]: Command end result
[0m05:46:49.784282 [info ] [MainThread]: 
[0m05:46:49.784779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:46:49.785073 [info ] [MainThread]: 
[0m05:46:49.785355 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:46:49.786116 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.683336, "process_user_time": 2.747897, "process_kernel_time": 0.186349, "process_mem_max_rss": "210268", "process_out_blocks": "3809", "process_in_blocks": "0"}
[0m05:46:49.786488 [debug] [MainThread]: Command `dbt run` succeeded at 05:46:49.786427 after 7.68 seconds
[0m05:46:49.786737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbf5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38f7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77aa0620>]}
[0m05:46:49.787011 [debug] [MainThread]: Flushing usage events
[0m05:46:53.214679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2838590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27b6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa372b410>]}


============================== 05:46:53.217855 | 976df11c-39ec-4a1c-8cd1-c24872e27cd7 ==============================
[0m05:46:53.217855 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:46:53.218389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:46:53.568419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '976df11c-39ec-4a1c-8cd1-c24872e27cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0403e0>]}
[0m05:46:53.586379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '976df11c-39ec-4a1c-8cd1-c24872e27cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85170860>]}
[0m05:46:53.586785 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:46:53.630517 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:46:53.697898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:46:53.698194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:46:53.713709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '976df11c-39ec-4a1c-8cd1-c24872e27cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a88d70>]}
[0m05:46:53.773748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '976df11c-39ec-4a1c-8cd1-c24872e27cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a8b1be0>]}
[0m05:46:53.774034 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m05:46:53.774392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '976df11c-39ec-4a1c-8cd1-c24872e27cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ad95d30>]}
[0m05:46:53.775141 [info ] [MainThread]: 
[0m05:46:53.775455 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:46:53.776327 [debug] [MainThread]: Command end result
[0m05:46:53.795352 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.61474454, "process_user_time": 2.090331, "process_kernel_time": 0.115678, "process_mem_max_rss": "209352", "process_out_blocks": "2482", "process_in_blocks": "0"}
[0m05:46:53.795679 [debug] [MainThread]: Command `dbt test` succeeded at 05:46:53.795634 after 0.62 seconds
[0m05:46:53.795882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3137e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab0b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b21c680>]}
[0m05:46:53.796070 [debug] [MainThread]: Flushing usage events
[0m05:46:56.209188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87af9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87999d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86a440b0>]}


============================== 05:46:56.212318 | 7b1dc4f0-0487-4998-ba87-916f0485663e ==============================
[0m05:46:56.212318 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:46:56.212861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m05:46:56.573579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b1dc4f0-0487-4998-ba87-916f0485663e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68518ce0>]}
[0m05:46:56.591821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b1dc4f0-0487-4998-ba87-916f0485663e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6229a840>]}
[0m05:46:56.592268 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:46:56.634829 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:46:56.703160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:46:56.703454 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:46:56.718890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b1dc4f0-0487-4998-ba87-916f0485663e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff621757f0>]}
[0m05:46:56.772073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b1dc4f0-0487-4998-ba87-916f0485663e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff621d7140>]}
[0m05:46:56.772360 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m05:46:56.772721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b1dc4f0-0487-4998-ba87-916f0485663e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68519dc0>]}
[0m05:46:56.773520 [info ] [MainThread]: 
[0m05:46:56.773913 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:46:56.775909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:46:56.782081 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:46:56.782346 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:46:56.782505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:46:57.272252 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.489 seconds
[0m05:46:57.276543 [debug] [ThreadPool]: On list_dev: Close
[0m05:46:57.605230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m05:46:57.619100 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:46:57.620132 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:46:57.620765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:46:58.129159 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.508 seconds
[0m05:46:58.132738 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:46:58.263711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:46:58.269451 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:46:58.270641 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:46:58.272348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:46:58.696699 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.424 seconds
[0m05:46:58.700412 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:46:58.839250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b1dc4f0-0487-4998-ba87-916f0485663e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87125190>]}
[0m05:46:58.840339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:46:58.841428 [info ] [MainThread]: 
[0m05:46:58.852139 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:46:58.852856 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m05:46:58.853638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m05:46:58.854070 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:46:58.867597 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:46:58.894618 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:46:58.894951 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m05:46:58.895238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:46:59.367822 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.472 seconds
[0m05:46:59.412987 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:46:59.413738 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_14d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:46:59.569138 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8619a-0004-2ceb-0002-787300011e36
[0m05:46:59.569837 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 8
invalid identifier 'RSI_14D'
[0m05:46:59.570357 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m05:46:59.709185 [debug] [Thread-1 (]: Database Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'RSI_14D'
[0m05:46:59.712164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1dc4f0-0487-4998-ba87-916f0485663e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862ba210>]}
[0m05:46:59.714101 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting snapshot.snapshot_crypto_abstract_metrics ............ [[31mERROR[0m in 0.86s]
[0m05:46:59.715836 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:46:59.716571 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:46:59.718080 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m05:46:59.719069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m05:46:59.719587 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:46:59.724221 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:46:59.727893 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:46:59.728334 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m05:46:59.728739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:47:00.108330 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.379 seconds
[0m05:47:00.117509 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:00.118142 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:47:00.979504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m05:47:00.984903 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:00.985789 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m05:47:01.084205 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.098 seconds
[0m05:47:01.088387 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:01.088904 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m05:47:01.162019 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.072 seconds
[0m05:47:01.171462 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:01.172233 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m05:47:01.262277 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.089 seconds
[0m05:47:01.271597 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:01.272657 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m05:47:01.397844 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.124 seconds
[0m05:47:01.410808 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:01.411569 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m05:47:01.572893 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.160 seconds
[0m05:47:01.597812 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:01.598422 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:47:01.955267 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.356 seconds
[0m05:47:01.959557 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:01.960101 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:47:02.050724 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.090 seconds
[0m05:47:02.051302 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:02.052890 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:02.053250 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
BEGIN
[0m05:47:02.206143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m05:47:02.206633 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:02.210799 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:47:02.781546 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.570 seconds
[0m05:47:02.782464 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:47:02.782760 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
COMMIT
[0m05:47:03.124142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.341 seconds
[0m05:47:03.136713 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m05:47:03.251216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b1dc4f0-0487-4998-ba87-916f0485663e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff624cc440>]}
[0m05:47:03.251931 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 0[0m in 3.53s]
[0m05:47:03.253559 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:47:03.254665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:47:03.254939 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m05:47:03.255217 [info ] [MainThread]: 
[0m05:47:03.255650 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 6.48 seconds (6.48s).
[0m05:47:03.256177 [debug] [MainThread]: Command end result
[0m05:47:03.282901 [info ] [MainThread]: 
[0m05:47:03.283504 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:47:03.283981 [info ] [MainThread]: 
[0m05:47:03.284263 [error] [MainThread]:   Database Error in snapshot snapshot_crypto_abstract_metrics (snapshots/snapshot_crypto_abstract_metrics.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'RSI_14D'
[0m05:47:03.284492 [info ] [MainThread]: 
[0m05:47:03.284748 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m05:47:03.285615 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 7.1111646, "process_user_time": 2.677768, "process_kernel_time": 0.137321, "process_mem_max_rss": "209348", "process_in_blocks": "272", "process_out_blocks": "2548", "command_success": false}
[0m05:47:03.286004 [debug] [MainThread]: Command `dbt snapshot` failed at 05:47:03.285942 after 7.11 seconds
[0m05:47:03.286303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87af9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6218e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff63a8a840>]}
[0m05:47:03.286531 [debug] [MainThread]: Flushing usage events
[0m05:50:41.754394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9d16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3d6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0c6360>]}


============================== 05:50:41.758840 | cbaf6ce4-e83b-49d6-9339-67718f145d98 ==============================
[0m05:50:41.758840 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:50:41.759472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:50:41.819807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbaf6ce4-e83b-49d6-9339-67718f145d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bec5430>]}
[0m05:50:41.829906 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:50:41.888452 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-bvyhdyk4'
[0m05:50:41.888872 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:50:42.035470 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:50:42.036639 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:50:42.110568 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:50:42.113364 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:50:42.743860 [info ] [MainThread]: Installed from version 1.3.0
[0m05:50:42.744484 [info ] [MainThread]: Up to date!
[0m05:50:42.745140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cbaf6ce4-e83b-49d6-9339-67718f145d98', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b86bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b86a9c0>]}
[0m05:50:42.746202 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0391575, "process_user_time": 1.055465, "process_kernel_time": 0.131679, "process_mem_max_rss": "209340", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m05:50:42.746588 [debug] [MainThread]: Command `dbt deps` succeeded at 05:50:42.746537 after 1.04 seconds
[0m05:50:42.746853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebc65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b9b1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b836d20>]}
[0m05:50:42.747139 [debug] [MainThread]: Flushing usage events
[0m05:50:45.398894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848661e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87541550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84866120>]}


============================== 05:50:45.402128 | b6754f96-de6d-47ca-8804-9c7c988321e4 ==============================
[0m05:50:45.402128 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:50:45.402951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:50:45.776683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85eb3b60>]}
[0m05:50:45.794988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83eff950>]}
[0m05:50:45.795492 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:50:45.839604 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:50:45.911132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:50:45.911498 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_abstract_metrics.sql
[0m05:50:46.009557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff609f3da0>]}
[0m05:50:46.060694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff608864b0>]}
[0m05:50:46.061002 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m05:50:46.061449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60cccfe0>]}
[0m05:50:46.062277 [info ] [MainThread]: 
[0m05:50:46.062690 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:50:46.064612 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:50:46.071129 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:50:46.071342 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:50:46.071490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:50:46.675630 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.604 seconds
[0m05:50:46.677919 [debug] [ThreadPool]: On list_dev: Close
[0m05:50:46.801688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:50:46.809144 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:50:46.809557 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:50:46.809900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:47.479524 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.669 seconds
[0m05:50:47.485359 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:50:47.627424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:50:47.634845 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:50:47.635805 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:50:47.636605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:50:48.163504 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.527 seconds
[0m05:50:48.169064 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:50:48.287505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60952300>]}
[0m05:50:48.289534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:50:48.291624 [info ] [MainThread]: 
[0m05:50:48.305429 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m05:50:48.306517 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m05:50:48.307628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m05:50:48.308230 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m05:50:48.314978 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m05:50:48.317434 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m05:50:48.334843 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m05:50:48.336069 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m05:50:48.336370 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m05:50:48.336652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:49.148621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m05:50:49.177133 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m05:50:49.295060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff610cc680>]}
[0m05:50:49.295890 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.99s]
[0m05:50:49.296720 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m05:50:49.297577 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m05:50:49.298099 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m05:50:49.298718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m05:50:49.299084 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m05:50:49.301164 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m05:50:49.302793 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m05:50:49.304728 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m05:50:49.306265 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m05:50:49.306589 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        COALESCE(LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date),0) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        
        CASE 
            WHEN price_close_7d_ago = 0 THEN 0
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    COALESCE(price_close_7d_ago, 0) as price_close_7d_ago,
    COALESCE(price_momentum_7d, 0) as price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m05:50:49.306904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:50.170632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m05:50:50.176691 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m05:50:50.306884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff606e2720>]}
[0m05:50:50.309937 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 1.01s]
[0m05:50:50.312604 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m05:50:50.313732 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m05:50:50.314808 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m05:50:50.316230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m05:50:50.317227 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m05:50:50.322171 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m05:50:50.324385 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m05:50:50.327103 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m05:50:50.329468 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m05:50:50.329996 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_gain_7d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_loss_7d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_7d,
    avg_loss_7d,
    CASE WHEN avg_loss_7d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_7d / avg_loss_7d))) 
    END AS rsi_7d
FROM avg_gain_loss
  );
[0m05:50:50.330438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:51.096026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m05:50:51.101998 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m05:50:51.359485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6080c0b0>]}
[0m05:50:51.361146 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 1.04s]
[0m05:50:51.363025 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m05:50:51.364031 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m05:50:51.364954 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m05:50:51.366214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m05:50:51.367089 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m05:50:51.372368 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m05:50:51.374401 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m05:50:51.377379 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m05:50:51.379420 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m05:50:51.380038 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m05:50:51.380577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:52.185031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.804 seconds
[0m05:50:52.189891 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m05:50:52.304241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6080e990>]}
[0m05:50:52.305329 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.94s]
[0m05:50:52.306515 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m05:50:52.307246 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:50:52.307974 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m05:50:52.309033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m05:50:52.309376 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:50:52.312149 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m05:50:52.314068 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:50:52.330114 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m05:50:52.331970 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m05:50:52.332353 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_7d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7d, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_7d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7d,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m05:50:52.332646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:50:53.825063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.492 seconds
[0m05:50:53.829151 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m05:50:53.956492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6754f96-de6d-47ca-8804-9c7c988321e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff60575c40>]}
[0m05:50:53.958491 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.65s]
[0m05:50:53.962219 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:50:53.966510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:50:53.967377 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m05:50:53.968164 [info ] [MainThread]: 
[0m05:50:53.969490 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m05:50:53.971641 [debug] [MainThread]: Command end result
[0m05:50:54.009224 [info ] [MainThread]: 
[0m05:50:54.009970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:50:54.010233 [info ] [MainThread]: 
[0m05:50:54.010490 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:50:54.011306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.6473055, "process_user_time": 2.784962, "process_kernel_time": 0.198998, "process_mem_max_rss": "209788", "process_out_blocks": "3809", "process_in_blocks": "0"}
[0m05:50:54.011657 [debug] [MainThread]: Command `dbt run` succeeded at 05:50:54.011598 after 8.65 seconds
[0m05:50:54.011930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87541550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85051280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff609aa420>]}
[0m05:50:54.012162 [debug] [MainThread]: Flushing usage events
[0m05:50:56.404417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24bf8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24bc4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24be270>]}


============================== 05:50:56.407787 | ac7e8e5e-1371-42db-aebc-63ffca5761bf ==============================
[0m05:50:56.407787 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:50:56.408400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:50:56.841847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac7e8e5e-1371-42db-aebc-63ffca5761bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94770ce0>]}
[0m05:50:56.860504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac7e8e5e-1371-42db-aebc-63ffca5761bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94721ee0>]}
[0m05:50:56.860967 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:50:56.904337 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:50:56.976480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:50:56.976777 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:50:56.993236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac7e8e5e-1371-42db-aebc-63ffca5761bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb34b5c40>]}
[0m05:50:57.054455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac7e8e5e-1371-42db-aebc-63ffca5761bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dc23f0>]}
[0m05:50:57.054809 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m05:50:57.055292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac7e8e5e-1371-42db-aebc-63ffca5761bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e3a7e0>]}
[0m05:50:57.056096 [info ] [MainThread]: 
[0m05:50:57.056426 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:50:57.057325 [debug] [MainThread]: Command end result
[0m05:50:57.079463 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.7099554, "process_user_time": 2.209372, "process_kernel_time": 0.115636, "process_mem_max_rss": "209352", "process_out_blocks": "2482", "process_in_blocks": "0"}
[0m05:50:57.079843 [debug] [MainThread]: Command `dbt test` succeeded at 05:50:57.079776 after 0.71 seconds
[0m05:50:57.080076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2aaa150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadbe0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb200e660>]}
[0m05:50:57.080308 [debug] [MainThread]: Flushing usage events
[0m05:50:59.232779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9496bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9544cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a9e1b0>]}


============================== 05:50:59.236011 | f3278836-67f6-445e-a982-6dfc6a9692a6 ==============================
[0m05:50:59.236011 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:50:59.236567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:50:59.594322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3278836-67f6-445e-a982-6dfc6a9692a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71bb06e0>]}
[0m05:50:59.612371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3278836-67f6-445e-a982-6dfc6a9692a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911678c0>]}
[0m05:50:59.612824 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:50:59.653715 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:50:59.720884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:50:59.721183 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:50:59.736790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3278836-67f6-445e-a982-6dfc6a9692a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71046ab0>]}
[0m05:50:59.790712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3278836-67f6-445e-a982-6dfc6a9692a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f788c0>]}
[0m05:50:59.790986 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m05:50:59.791339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3278836-67f6-445e-a982-6dfc6a9692a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70dea900>]}
[0m05:50:59.792110 [info ] [MainThread]: 
[0m05:50:59.792475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:50:59.794556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:50:59.800692 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:50:59.800909 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:50:59.801065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:51:00.295151 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.494 seconds
[0m05:51:00.299156 [debug] [ThreadPool]: On list_dev: Close
[0m05:51:00.424000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:51:00.437622 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:51:00.438423 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:51:00.438875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:00.841568 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.403 seconds
[0m05:51:00.845165 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:51:00.970804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:51:00.977264 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:51:00.978097 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:51:00.978819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:51:01.555540 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.576 seconds
[0m05:51:01.560051 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:51:01.706009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3278836-67f6-445e-a982-6dfc6a9692a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71148770>]}
[0m05:51:01.707646 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:51:01.709516 [info ] [MainThread]: 
[0m05:51:01.716094 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:51:01.716564 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m05:51:01.717058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m05:51:01.717346 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:51:01.725924 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:51:01.749843 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:01.750239 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m05:51:01.750534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:51:02.258359 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.507 seconds
[0m05:51:02.303229 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:02.303888 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_7d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:51:03.207264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.903 seconds
[0m05:51:03.209164 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:03.209470 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m05:51:03.322076 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.112 seconds
[0m05:51:03.323933 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:03.324219 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m05:51:03.427446 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.103 seconds
[0m05:51:03.429334 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:03.429644 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m05:51:03.533556 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.104 seconds
[0m05:51:03.535547 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:03.535813 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m05:51:03.627160 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.091 seconds
[0m05:51:03.629900 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:03.630195 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
alter table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS" add column "RSI_7D" NUMBER(22,6);
[0m05:51:03.906003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m05:51:03.907673 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:03.908003 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m05:51:03.995382 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.087 seconds
[0m05:51:04.005148 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:04.005509 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_7d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:51:04.403345 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.397 seconds
[0m05:51:04.411042 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:04.412193 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:51:04.518811 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.105 seconds
[0m05:51:04.519988 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:04.523928 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:04.524501 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
BEGIN
[0m05:51:04.627870 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m05:51:04.629342 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:04.630270 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_7D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_7D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:51:05.325176 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.694 seconds
[0m05:51:05.325942 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:51:05.326367 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
COMMIT
[0m05:51:05.733191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m05:51:05.760128 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m05:51:05.871671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3278836-67f6-445e-a982-6dfc6a9692a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff713a8470>]}
[0m05:51:05.872867 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_crypto_abstract_metrics ................ [[32mSUCCESS 0[0m in 4.15s]
[0m05:51:05.874304 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:51:05.874842 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:51:05.875443 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m05:51:05.876099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m05:51:05.876569 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:51:05.881635 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:51:05.884696 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:05.885140 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m05:51:05.885552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:51:06.366679 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.481 seconds
[0m05:51:06.374443 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:06.375034 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:51:07.201839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.825 seconds
[0m05:51:07.208681 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:07.209572 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m05:51:07.329096 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.118 seconds
[0m05:51:07.333867 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:07.334405 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m05:51:07.429255 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.094 seconds
[0m05:51:07.437106 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:07.438129 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m05:51:07.528905 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.090 seconds
[0m05:51:07.536410 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:07.537200 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m05:51:07.638818 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.101 seconds
[0m05:51:07.645079 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:07.645756 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m05:51:07.746506 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.100 seconds
[0m05:51:07.755655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:07.756573 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:51:08.152561 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.395 seconds
[0m05:51:08.155311 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:08.156133 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:51:08.244938 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.088 seconds
[0m05:51:08.247878 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:08.253389 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:08.254463 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
BEGIN
[0m05:51:08.393264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m05:51:08.395167 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:08.396382 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:51:08.839404 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.440 seconds
[0m05:51:08.841367 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:51:08.842577 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
COMMIT
[0m05:51:09.211852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m05:51:09.216047 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m05:51:09.330890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3278836-67f6-445e-a982-6dfc6a9692a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701c6bd0>]}
[0m05:51:09.333511 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 0[0m in 3.45s]
[0m05:51:09.336075 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:51:09.339120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:51:09.339900 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m05:51:09.340619 [info ] [MainThread]: 
[0m05:51:09.342052 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 9.55 seconds (9.55s).
[0m05:51:09.343834 [debug] [MainThread]: Command end result
[0m05:51:09.381970 [info ] [MainThread]: 
[0m05:51:09.382511 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:51:09.382887 [info ] [MainThread]: 
[0m05:51:09.383200 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:51:09.383973 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.185078, "process_user_time": 2.746198, "process_kernel_time": 0.139518, "process_mem_max_rss": "209336", "process_out_blocks": "2570", "process_in_blocks": "0"}
[0m05:51:09.384337 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:51:09.384266 after 10.19 seconds
[0m05:51:09.384629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9496bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b1e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70b45250>]}
[0m05:51:09.384887 [debug] [MainThread]: Flushing usage events
[0m05:53:54.797786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c4a3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc09be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb11f10>]}


============================== 05:53:54.801645 | 24bd6fde-c554-4b30-953a-6b8fc8c29da0 ==============================
[0m05:53:54.801645 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:53:54.802238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m05:53:54.843170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24bd6fde-c554-4b30-953a-6b8fc8c29da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bccb7d0>]}
[0m05:53:54.848768 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:53:54.892924 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zze2ugam'
[0m05:53:54.893443 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m05:53:55.097857 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m05:53:55.099761 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m05:53:55.181915 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m05:53:55.186275 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m05:53:55.823159 [info ] [MainThread]: Installed from version 1.3.0
[0m05:53:55.824224 [info ] [MainThread]: Up to date!
[0m05:53:55.824637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '24bd6fde-c554-4b30-953a-6b8fc8c29da0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8e3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8e3890>]}
[0m05:53:55.825468 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.064512, "process_user_time": 0.946292, "process_kernel_time": 0.115157, "process_mem_max_rss": "209332", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m05:53:55.825852 [debug] [MainThread]: Command `dbt deps` succeeded at 05:53:55.825797 after 1.06 seconds
[0m05:53:55.826092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80224da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc73f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b753d10>]}
[0m05:53:55.826283 [debug] [MainThread]: Flushing usage events
[0m05:53:58.768729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890db650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8897fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b82ff0>]}


============================== 05:53:58.772084 | 96fff6d4-78b6-4937-9baf-b6c5f4e24b44 ==============================
[0m05:53:58.772084 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:53:58.772600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:53:59.169831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff66b2bda0>]}
[0m05:53:59.192794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87927320>]}
[0m05:53:59.193384 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:53:59.238100 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:53:59.313035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:53:59.313344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:53:59.329836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff65073440>]}
[0m05:53:59.385691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64c6a630>]}
[0m05:53:59.385979 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m05:53:59.386341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64c33620>]}
[0m05:53:59.387113 [info ] [MainThread]: 
[0m05:53:59.387473 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:53:59.389670 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:53:59.395760 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:53:59.396018 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:53:59.396211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:53:59.818186 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.422 seconds
[0m05:53:59.819200 [debug] [ThreadPool]: On list_dev: Close
[0m05:53:59.927013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m05:53:59.934899 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:53:59.935351 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:53:59.935631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:54:00.353193 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.417 seconds
[0m05:54:00.357851 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:54:00.476603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m05:54:00.479308 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:54:00.479680 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:54:00.480056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:54:00.925096 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.445 seconds
[0m05:54:00.930567 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:54:01.055950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff650560f0>]}
[0m05:54:01.058067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:54:01.060409 [info ] [MainThread]: 
[0m05:54:01.075572 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m05:54:01.076654 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m05:54:01.077869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m05:54:01.078294 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m05:54:01.085173 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m05:54:01.087713 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m05:54:01.105268 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m05:54:01.106556 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m05:54:01.106856 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m05:54:01.107149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:01.797339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m05:54:01.827872 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m05:54:01.974932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64150d40>]}
[0m05:54:01.977780 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.89s]
[0m05:54:01.979939 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m05:54:01.981560 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m05:54:01.982346 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m05:54:01.983353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m05:54:01.983960 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m05:54:01.988717 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m05:54:01.991111 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m05:54:01.993424 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m05:54:01.995579 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m05:54:01.996084 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        COALESCE(LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date),0) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        
        CASE 
            WHEN price_close_7d_ago = 0 THEN 0
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    COALESCE(price_close_7d_ago, 0) as price_close_7d_ago,
    COALESCE(price_momentum_7d, 0) as price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m05:54:01.996478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:02.763552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m05:54:02.765013 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m05:54:02.871706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64074e30>]}
[0m05:54:02.872308 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.89s]
[0m05:54:02.873035 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m05:54:02.873365 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m05:54:02.873814 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m05:54:02.874277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m05:54:02.874541 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m05:54:02.876230 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m05:54:02.877990 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m05:54:02.879287 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m05:54:02.880333 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m05:54:02.880582 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_gain_7d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_loss_7d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_7d,
    avg_loss_7d,
    CASE WHEN avg_loss_7d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_7d / avg_loss_7d))) 
    END AS rsi_7d
FROM avg_gain_loss
  );
[0m05:54:02.880849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:03.636800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m05:54:03.641324 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m05:54:03.765064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64138950>]}
[0m05:54:03.766973 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.89s]
[0m05:54:03.768766 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m05:54:03.769710 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m05:54:03.770755 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m05:54:03.772124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m05:54:03.773047 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m05:54:03.778263 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m05:54:03.780508 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m05:54:03.783560 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m05:54:03.785869 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m05:54:03.786478 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m05:54:03.786937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:04.306747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m05:54:04.312533 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m05:54:04.440296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6403b8f0>]}
[0m05:54:04.443270 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.67s]
[0m05:54:04.445724 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m05:54:04.447930 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:54:04.449809 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m05:54:04.451353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m05:54:04.452054 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:54:04.456473 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m05:54:04.459123 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:54:04.476390 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m05:54:04.478315 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m05:54:04.478735 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_7d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7d, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_7d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7d,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m05:54:04.479155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:05.962135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.482 seconds
[0m05:54:05.969176 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m05:54:06.081018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96fff6d4-78b6-4937-9baf-b6c5f4e24b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640e0aa0>]}
[0m05:54:06.083743 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.63s]
[0m05:54:06.086295 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m05:54:06.089864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:54:06.090952 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m05:54:06.091792 [info ] [MainThread]: 
[0m05:54:06.092971 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m05:54:06.094888 [debug] [MainThread]: Command end result
[0m05:54:06.131322 [info ] [MainThread]: 
[0m05:54:06.131798 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:54:06.132074 [info ] [MainThread]: 
[0m05:54:06.132351 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m05:54:06.133207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.399121, "process_user_time": 2.700649, "process_kernel_time": 0.195191, "process_mem_max_rss": "209336", "process_out_blocks": "2564", "process_in_blocks": "0"}
[0m05:54:06.133580 [debug] [MainThread]: Command `dbt run` succeeded at 05:54:06.133527 after 7.40 seconds
[0m05:54:06.133865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e94cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89895910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885ac080>]}
[0m05:54:06.134090 [debug] [MainThread]: Flushing usage events
[0m05:54:08.839980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7d3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7d0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7d0620>]}


============================== 05:54:08.843166 | 65afa76d-d1eb-45f4-bbf7-d9cca6edc341 ==============================
[0m05:54:08.843166 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:54:08.843679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:54:09.211397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65afa76d-d1eb-45f4-bbf7-d9cca6edc341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ed8ce0>]}
[0m05:54:09.230511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65afa76d-d1eb-45f4-bbf7-d9cca6edc341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e32c60>]}
[0m05:54:09.230941 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:54:09.273097 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:54:09.341989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:54:09.342274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:54:09.358460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65afa76d-d1eb-45f4-bbf7-d9cca6edc341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78677380>]}
[0m05:54:09.417528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65afa76d-d1eb-45f4-bbf7-d9cca6edc341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78190cb0>]}
[0m05:54:09.417850 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m05:54:09.418261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65afa76d-d1eb-45f4-bbf7-d9cca6edc341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7820a9f0>]}
[0m05:54:09.419028 [info ] [MainThread]: 
[0m05:54:09.419330 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:54:09.420138 [debug] [MainThread]: Command end result
[0m05:54:09.441065 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.635967, "process_user_time": 2.143625, "process_kernel_time": 0.107432, "process_mem_max_rss": "209336", "process_out_blocks": "2482", "process_in_blocks": "0"}
[0m05:54:09.441448 [debug] [MainThread]: Command `dbt test` succeeded at 05:54:09.441401 after 0.64 seconds
[0m05:54:09.441706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c969eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7815c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff787cb0e0>]}
[0m05:54:09.441964 [debug] [MainThread]: Flushing usage events
[0m05:54:11.867115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88066090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88067bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88064a70>]}


============================== 05:54:11.870256 | 22610846-3522-477d-82b6-d2cd0e218d50 ==============================
[0m05:54:11.870256 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:54:11.870858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:54:12.225449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22610846-3522-477d-82b6-d2cd0e218d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896bb800>]}
[0m05:54:12.244466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22610846-3522-477d-82b6-d2cd0e218d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c7b890>]}
[0m05:54:12.244909 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:54:12.287725 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:54:12.356790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:54:12.357086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:54:12.373378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22610846-3522-477d-82b6-d2cd0e218d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6458e000>]}
[0m05:54:12.428100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22610846-3522-477d-82b6-d2cd0e218d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff643d5580>]}
[0m05:54:12.428411 [info ] [MainThread]: Found 5 models, 2 snapshots, 2 sources, 575 macros
[0m05:54:12.428792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22610846-3522-477d-82b6-d2cd0e218d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff648ccec0>]}
[0m05:54:12.429598 [info ] [MainThread]: 
[0m05:54:12.429951 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:54:12.432020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m05:54:12.438262 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m05:54:12.438475 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m05:54:12.438629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:54:12.985033 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.546 seconds
[0m05:54:12.988322 [debug] [ThreadPool]: On list_dev: Close
[0m05:54:13.099870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m05:54:13.106664 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m05:54:13.107047 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m05:54:13.107352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:54:13.531338 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.424 seconds
[0m05:54:13.533128 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m05:54:13.658304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m05:54:13.662954 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m05:54:13.663530 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m05:54:13.664048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:54:14.208874 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.544 seconds
[0m05:54:14.213850 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m05:54:14.350340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22610846-3522-477d-82b6-d2cd0e218d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff64af3530>]}
[0m05:54:14.352193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:54:14.354639 [info ] [MainThread]: 
[0m05:54:14.369239 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:54:14.370342 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m05:54:14.371600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m05:54:14.372076 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:54:14.387220 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:54:14.415397 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:14.415713 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m05:54:14.415975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:14.870280 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.454 seconds
[0m05:54:14.910021 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:14.910903 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_7d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:54:15.583679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.672 seconds
[0m05:54:15.587329 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:15.587751 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m05:54:15.692583 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.104 seconds
[0m05:54:15.697765 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:15.698326 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m05:54:15.813646 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.114 seconds
[0m05:54:15.825225 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:15.826545 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m05:54:15.918579 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.091 seconds
[0m05:54:15.923653 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:15.924987 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m05:54:16.039148 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.113 seconds
[0m05:54:16.047137 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:16.047819 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m05:54:16.132237 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.083 seconds
[0m05:54:16.145914 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:16.146554 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_7d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:54:16.709699 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.563 seconds
[0m05:54:16.712548 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:16.712910 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:54:16.805033 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.092 seconds
[0m05:54:16.806187 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:16.809084 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:16.809599 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
BEGIN
[0m05:54:16.939837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m05:54:16.941245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:16.942318 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_7D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_7D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:54:17.563982 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.621 seconds
[0m05:54:17.564633 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m05:54:17.565028 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
COMMIT
[0m05:54:17.988869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m05:54:17.999888 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m05:54:18.122368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22610846-3522-477d-82b6-d2cd0e218d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff648ccbc0>]}
[0m05:54:18.123208 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_crypto_abstract_metrics ................ [[32mSUCCESS 0[0m in 3.75s]
[0m05:54:18.124405 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m05:54:18.124850 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:54:18.125331 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m05:54:18.125785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m05:54:18.126078 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:54:18.129997 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:54:18.133175 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:18.133525 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m05:54:18.133795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:18.537090 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.403 seconds
[0m05:54:18.540536 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:18.540946 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m05:54:19.370489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.829 seconds
[0m05:54:19.371970 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:19.372260 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m05:54:19.496015 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.123 seconds
[0m05:54:19.498167 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:19.498433 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m05:54:19.592155 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.093 seconds
[0m05:54:19.594319 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:19.594598 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m05:54:19.662960 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.068 seconds
[0m05:54:19.664914 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:19.665183 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m05:54:19.758932 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.093 seconds
[0m05:54:19.761943 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:19.762338 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m05:54:19.886980 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.124 seconds
[0m05:54:19.897823 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:19.899966 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m05:54:20.184531 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.283 seconds
[0m05:54:20.188133 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:20.189488 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m05:54:20.263435 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.073 seconds
[0m05:54:20.265906 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:20.267574 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:20.267919 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
BEGIN
[0m05:54:20.423238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m05:54:20.423614 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:20.423885 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m05:54:20.948209 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.524 seconds
[0m05:54:20.948624 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m05:54:20.948939 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
COMMIT
[0m05:54:21.196309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m05:54:21.197566 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m05:54:21.320116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22610846-3522-477d-82b6-d2cd0e218d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5ffc6ab0>]}
[0m05:54:21.320744 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 0[0m in 3.19s]
[0m05:54:21.321364 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m05:54:21.322432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:54:21.322641 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m05:54:21.322865 [info ] [MainThread]: 
[0m05:54:21.323248 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m05:54:21.323832 [debug] [MainThread]: Command end result
[0m05:54:21.344569 [info ] [MainThread]: 
[0m05:54:21.345119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:54:21.345337 [info ] [MainThread]: 
[0m05:54:21.345600 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:54:21.346429 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.514132, "process_user_time": 2.640348, "process_kernel_time": 0.164457, "process_mem_max_rss": "209332", "process_out_blocks": "2569", "process_in_blocks": "0"}
[0m05:54:21.346763 [debug] [MainThread]: Command `dbt snapshot` succeeded at 05:54:21.346712 after 9.51 seconds
[0m05:54:21.346994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ca23c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6459d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff640913a0>]}
[0m05:54:21.347195 [debug] [MainThread]: Flushing usage events
[0m06:18:16.948941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939263f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94352a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943525a0>]}


============================== 06:18:16.952645 | 27d16ff0-f5a4-4391-81a2-6603d8f5d745 ==============================
[0m06:18:16.952645 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:18:16.952963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m06:18:16.992282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27d16ff0-f5a4-4391-81a2-6603d8f5d745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948be420>]}
[0m06:18:16.997893 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:18:17.044331 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_u84_4_d'
[0m06:18:17.044695 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:18:17.272806 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:18:17.277193 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:18:17.396495 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:18:17.402030 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:18:18.154360 [info ] [MainThread]: Installed from version 1.3.0
[0m06:18:18.155580 [info ] [MainThread]: Up to date!
[0m06:18:18.156121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '27d16ff0-f5a4-4391-81a2-6603d8f5d745', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939afc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934cd160>]}
[0m06:18:18.157349 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2441918, "process_user_time": 0.979193, "process_kernel_time": 0.153716, "process_mem_max_rss": "209332", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m06:18:18.157761 [debug] [MainThread]: Command `dbt deps` succeeded at 06:18:18.157672 after 1.24 seconds
[0m06:18:18.158093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9432bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9420aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939afc50>]}
[0m06:18:18.158373 [debug] [MainThread]: Flushing usage events
[0m06:18:20.814119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabdbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabd7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad724470>]}


============================== 06:18:20.817484 | 55c3161a-d30c-4a59-81e0-08e43ad0c9c8 ==============================
[0m06:18:20.817484 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:18:20.817952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:18:21.195304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba11c10>]}
[0m06:18:21.214351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836dbc80>]}
[0m06:18:21.214757 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:18:21.258768 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:18:21.327648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:18:21.328026 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/schema.yml
[0m06:18:21.348748 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:18:21.349229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e381a0>]}
[0m06:18:21.431215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e834a0>]}
[0m06:18:21.483978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8303cb90>]}
[0m06:18:21.484277 [info ] [MainThread]: Found 5 models, 2 snapshots, 8 data tests, 2 sources, 575 macros
[0m06:18:21.484734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831eba40>]}
[0m06:18:21.485610 [info ] [MainThread]: 
[0m06:18:21.486026 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:18:21.487964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m06:18:21.493532 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m06:18:21.493755 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m06:18:21.493975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:18:22.024460 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.530 seconds
[0m06:18:22.030542 [debug] [ThreadPool]: On list_dev: Close
[0m06:18:22.198466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m06:18:22.212687 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m06:18:22.213700 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m06:18:22.214188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:18:22.606421 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.392 seconds
[0m06:18:22.611094 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m06:18:22.726202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m06:18:22.728745 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m06:18:22.729209 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m06:18:22.729641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:18:23.225294 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.496 seconds
[0m06:18:23.228017 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m06:18:23.361327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff830f22a0>]}
[0m06:18:23.362121 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:18:23.363111 [info ] [MainThread]: 
[0m06:18:23.369989 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m06:18:23.370529 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m06:18:23.371204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m06:18:23.371570 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m06:18:23.375484 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m06:18:23.376653 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m06:18:23.389200 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m06:18:23.390624 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m06:18:23.390875 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m06:18:23.391118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:24.022521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m06:18:24.032331 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m06:18:24.156406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab22e090>]}
[0m06:18:24.156933 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.78s]
[0m06:18:24.157375 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m06:18:24.158041 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m06:18:24.158378 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m06:18:24.158694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m06:18:24.158920 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m06:18:24.160347 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m06:18:24.162210 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m06:18:24.163342 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m06:18:24.164410 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m06:18:24.164633 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        COALESCE(LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date),0) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        
        CASE 
            WHEN price_close_7d_ago = 0 THEN 0
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Positive'
            WHEN price_momentum_7d < 0 THEN 'Negative'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    COALESCE(price_close_7d_ago, 0) as price_close_7d_ago,
    COALESCE(price_momentum_7d, 0) as price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m06:18:24.164844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:24.757282 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m06:18:24.759243 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m06:18:24.887780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d38a40>]}
[0m06:18:24.890420 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.73s]
[0m06:18:24.892187 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m06:18:24.893595 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m06:18:24.894985 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m06:18:24.896906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m06:18:24.897976 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m06:18:24.902509 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m06:18:24.905156 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m06:18:24.908538 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m06:18:24.911867 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m06:18:24.912425 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_gain_7d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_loss_7d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_7d,
    avg_loss_7d,
    CASE WHEN avg_loss_7d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_7d / avg_loss_7d))) 
    END AS rsi_7d
FROM avg_gain_loss
  );
[0m06:18:24.912923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:25.583653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.670 seconds
[0m06:18:25.589000 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m06:18:25.724331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8210ff50>]}
[0m06:18:25.726034 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.83s]
[0m06:18:25.728150 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m06:18:25.729134 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m06:18:25.730250 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m06:18:25.731656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m06:18:25.732285 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m06:18:25.736927 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m06:18:25.738941 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m06:18:25.742093 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m06:18:25.744067 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m06:18:25.744882 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m06:18:25.745893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:26.455734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.709 seconds
[0m06:18:26.459480 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m06:18:26.573565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821062d0>]}
[0m06:18:26.575638 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.84s]
[0m06:18:26.577713 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m06:18:26.579101 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:18:26.580063 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m06:18:26.581053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m06:18:26.581658 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:18:26.587120 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m06:18:26.590146 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:18:26.611402 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m06:18:26.613534 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m06:18:26.613923 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_7d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7d, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_7d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7d,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m06:18:26.614285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:28.231650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.617 seconds
[0m06:18:28.236524 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m06:18:28.353176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c3161a-d30c-4a59-81e0-08e43ad0c9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820068d0>]}
[0m06:18:28.354325 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.77s]
[0m06:18:28.355617 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:18:28.357181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:18:28.357700 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m06:18:28.358539 [info ] [MainThread]: 
[0m06:18:28.358978 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 6.87 seconds (6.87s).
[0m06:18:28.360062 [debug] [MainThread]: Command end result
[0m06:18:28.431785 [info ] [MainThread]: 
[0m06:18:28.432365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:18:28.432700 [info ] [MainThread]: 
[0m06:18:28.432989 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:18:28.433629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.6692176, "process_user_time": 2.788085, "process_kernel_time": 0.183122, "process_mem_max_rss": "210160", "process_out_blocks": "3929", "process_in_blocks": "0"}
[0m06:18:28.433888 [debug] [MainThread]: Command `dbt run` succeeded at 06:18:28.433836 after 7.67 seconds
[0m06:18:28.434107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c1b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82105a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821041a0>]}
[0m06:18:28.434318 [debug] [MainThread]: Flushing usage events
[0m06:18:30.792290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3dac7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38b6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3dafaa0>]}


============================== 06:18:30.795388 | 5eafbce4-a59d-4582-80c7-b1dc701441dc ==============================
[0m06:18:30.795388 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:18:30.796105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:18:31.151450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5eafbce4-a59d-4582-80c7-b1dc701441dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92fa0ce0>]}
[0m06:18:31.176125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5eafbce4-a59d-4582-80c7-b1dc701441dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801df950>]}
[0m06:18:31.176652 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:18:31.219794 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:18:31.291334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:18:31.291634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:18:31.313317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5eafbce4-a59d-4582-80c7-b1dc701441dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bdb2090>]}
[0m06:18:31.372397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5eafbce4-a59d-4582-80c7-b1dc701441dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b91c1d0>]}
[0m06:18:31.372795 [info ] [MainThread]: Found 5 models, 2 snapshots, 8 data tests, 2 sources, 575 macros
[0m06:18:31.373252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eafbce4-a59d-4582-80c7-b1dc701441dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b96eb70>]}
[0m06:18:31.374247 [info ] [MainThread]: 
[0m06:18:31.374677 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:18:31.376646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m06:18:31.383679 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m06:18:31.383924 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m06:18:31.384144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:18:31.791224 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.407 seconds
[0m06:18:31.795508 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m06:18:31.908582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m06:18:31.914689 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m06:18:31.915620 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m06:18:31.916190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:18:32.339088 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.423 seconds
[0m06:18:32.343027 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m06:18:32.451928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eafbce4-a59d-4582-80c7-b1dc701441dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be80860>]}
[0m06:18:32.454260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:18:32.455774 [info ] [MainThread]: 
[0m06:18:32.466824 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333
[0m06:18:32.467371 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral  [RUN]
[0m06:18:32.468127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333)
[0m06:18:32.468534 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333
[0m06:18:32.480268 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333"
[0m06:18:32.481771 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333
[0m06:18:32.494564 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333"
[0m06:18:32.496105 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333"
[0m06:18:32.496407 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        price_momentum as value_field,
        count(*) as n_records

    from dev.analytics.crypto_abstract_metrics
    group by price_momentum

)

select *
from all_values
where value_field not in (
    'Overbought','Oversold','Neutral'
)



      
    ) dbt_internal_test
[0m06:18:32.496684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:32.995067 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b861ba-0004-2ced-0000-00027873fe25
[0m06:18:32.995525 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'PRICE_MOMENTUM'
[0m06:18:32.995922 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333: Close
[0m06:18:33.109189 [debug] [Thread-1 (]: Database Error in test accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral (models/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'PRICE_MOMENTUM'
  compiled code at target/run/crypto_currencies_elt/models/schema.yml/accepted_values_crypto_abstrac_a988f1dfa9e3998f99a2f915cf58faaf.sql
[0m06:18:33.109796 [error] [Thread-1 (]: 1 of 8 ERROR accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral  [[31mERROR[0m in 0.64s]
[0m06:18:33.110705 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333
[0m06:18:33.111034 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:18:33.111838 [info ] [Thread-1 (]: 2 of 8 START test not_null_crypto_abstract_metrics_date ........................ [RUN]
[0m06:18:33.112371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06)
[0m06:18:33.112688 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:18:33.116552 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:18:33.117494 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:18:33.118721 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:18:33.119661 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:18:33.119914 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.crypto_abstract_metrics
where date is null



      
    ) dbt_internal_test
[0m06:18:33.120132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:33.878903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m06:18:33.897889 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: Close
[0m06:18:34.047935 [info ] [Thread-1 (]: 2 of 8 PASS not_null_crypto_abstract_metrics_date .............................. [[32mPASS[0m in 0.93s]
[0m06:18:34.051370 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:18:34.052534 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:18:34.053708 [info ] [Thread-1 (]: 3 of 8 START test not_null_crypto_abstract_metrics_price_close ................. [RUN]
[0m06:18:34.055521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3)
[0m06:18:34.056384 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:18:34.062663 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:18:34.064680 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:18:34.067507 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:18:34.069180 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:18:34.069697 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_close
from dev.analytics.crypto_abstract_metrics
where price_close is null



      
    ) dbt_internal_test
[0m06:18:34.070122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:34.498216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.428 seconds
[0m06:18:34.500746 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: Close
[0m06:18:34.616589 [info ] [Thread-1 (]: 3 of 8 PASS not_null_crypto_abstract_metrics_price_close ....................... [[32mPASS[0m in 0.56s]
[0m06:18:34.619416 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:18:34.620850 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:18:34.621877 [info ] [Thread-1 (]: 4 of 8 START test not_null_crypto_abstract_metrics_rsi_7d ...................... [RUN]
[0m06:18:34.623277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405)
[0m06:18:34.624091 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:18:34.631122 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:18:34.633190 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:18:34.635476 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:18:34.637226 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:18:34.637844 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_7d
from dev.analytics.crypto_abstract_metrics
where rsi_7d is null



      
    ) dbt_internal_test
[0m06:18:34.638395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:35.345451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m06:18:35.350587 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: Close
[0m06:18:35.471828 [info ] [Thread-1 (]: 4 of 8 PASS not_null_crypto_abstract_metrics_rsi_7d ............................ [[32mPASS[0m in 0.85s]
[0m06:18:35.474267 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:18:35.475575 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:18:35.476560 [info ] [Thread-1 (]: 5 of 8 START test not_null_crypto_abstract_metrics_sma_7d ...................... [RUN]
[0m06:18:35.477862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003)
[0m06:18:35.479107 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:18:35.484459 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:18:35.487412 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:18:35.489580 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:18:35.491128 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:18:35.491657 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_7d
from dev.analytics.crypto_abstract_metrics
where sma_7d is null



      
    ) dbt_internal_test
[0m06:18:35.492097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:36.248887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m06:18:36.251919 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: Close
[0m06:18:36.372265 [info ] [Thread-1 (]: 5 of 8 PASS not_null_crypto_abstract_metrics_sma_7d ............................ [[32mPASS[0m in 0.89s]
[0m06:18:36.373524 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:18:36.374182 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:18:36.374749 [info ] [Thread-1 (]: 6 of 8 START test not_null_crypto_abstract_metrics_symbol ...................... [RUN]
[0m06:18:36.375482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e)
[0m06:18:36.375999 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:18:36.379399 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:18:36.380777 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:18:36.382583 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:18:36.383870 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:18:36.384183 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.crypto_abstract_metrics
where symbol is null



      
    ) dbt_internal_test
[0m06:18:36.384455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:36.915215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.530 seconds
[0m06:18:36.921194 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: Close
[0m06:18:37.052181 [info ] [Thread-1 (]: 6 of 8 PASS not_null_crypto_abstract_metrics_symbol ............................ [[32mPASS[0m in 0.68s]
[0m06:18:37.055448 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:18:37.056875 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:18:37.057915 [info ] [Thread-1 (]: 7 of 8 START test not_null_crypto_abstract_metrics_trades_count ................ [RUN]
[0m06:18:37.059226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724)
[0m06:18:37.060260 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:18:37.067482 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:18:37.069529 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:18:37.072027 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:18:37.073777 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:18:37.074336 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trades_count
from dev.analytics.crypto_abstract_metrics
where trades_count is null



      
    ) dbt_internal_test
[0m06:18:37.074714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:37.789186 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m06:18:37.791568 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: Close
[0m06:18:37.916531 [info ] [Thread-1 (]: 7 of 8 PASS not_null_crypto_abstract_metrics_trades_count ...................... [[32mPASS[0m in 0.86s]
[0m06:18:37.919969 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:18:37.921264 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:18:37.922425 [info ] [Thread-1 (]: 8 of 8 START test not_null_crypto_abstract_metrics_volume_traded ............... [RUN]
[0m06:18:37.923760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56)
[0m06:18:37.924711 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:18:37.930737 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:18:37.932861 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:18:37.935215 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:18:37.937029 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:18:37.937570 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume_traded
from dev.analytics.crypto_abstract_metrics
where volume_traded is null



      
    ) dbt_internal_test
[0m06:18:37.938000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:38.769918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.832 seconds
[0m06:18:38.771708 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: Close
[0m06:18:38.902153 [info ] [Thread-1 (]: 8 of 8 PASS not_null_crypto_abstract_metrics_volume_traded ..................... [[32mPASS[0m in 0.98s]
[0m06:18:38.902761 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:18:38.903699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:18:38.903939 [debug] [MainThread]: Connection 'test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56' was properly closed.
[0m06:18:38.904185 [info ] [MainThread]: 
[0m06:18:38.904494 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 7.53 seconds (7.53s).
[0m06:18:38.905329 [debug] [MainThread]: Command end result
[0m06:18:38.929758 [info ] [MainThread]: 
[0m06:18:38.930232 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:18:38.930556 [info ] [MainThread]: 
[0m06:18:38.930942 [error] [MainThread]:   Database Error in test accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral (models/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'PRICE_MOMENTUM'
  compiled code at target/run/crypto_currencies_elt/models/schema.yml/accepted_values_crypto_abstrac_a988f1dfa9e3998f99a2f915cf58faaf.sql
[0m06:18:38.931235 [info ] [MainThread]: 
[0m06:18:38.931595 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:18:38.932362 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 8.174747, "process_user_time": 2.917435, "process_kernel_time": 0.161466, "process_mem_max_rss": "210548", "process_out_blocks": "2663", "command_success": false, "process_in_blocks": "0"}
[0m06:18:38.932736 [debug] [MainThread]: Command `dbt test` failed at 06:18:38.932677 after 8.18 seconds
[0m06:18:38.933044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ec71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8062d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b667e0>]}
[0m06:18:38.933291 [debug] [MainThread]: Flushing usage events
[0m06:19:00.887862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c9f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872f5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8733c170>]}


============================== 06:19:00.891520 | 3b892c85-1779-47a0-8ec9-6d29e02f947c ==============================
[0m06:19:00.891520 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:19:00.892207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:19:00.933231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b892c85-1779-47a0-8ec9-6d29e02f947c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e67cb0>]}
[0m06:19:00.938298 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:19:00.983935 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tkak0lqc'
[0m06:19:00.984232 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:19:01.072801 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:19:01.073936 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:19:01.148936 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:19:01.152253 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:19:01.798773 [info ] [MainThread]: Installed from version 1.3.0
[0m06:19:01.799394 [info ] [MainThread]: Up to date!
[0m06:19:01.799861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b892c85-1779-47a0-8ec9-6d29e02f947c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86eafb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86eafc50>]}
[0m06:19:01.800720 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9493686, "process_user_time": 0.935948, "process_kernel_time": 0.137259, "process_mem_max_rss": "209352", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m06:19:01.801120 [debug] [MainThread]: Command `dbt deps` succeeded at 06:19:01.801064 after 0.95 seconds
[0m06:19:01.801440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c9f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872f5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f93c20>]}
[0m06:19:01.802168 [debug] [MainThread]: Flushing usage events
[0m06:19:03.739241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93711a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967f9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937125a0>]}


============================== 06:19:03.742433 | fc1c756e-77ce-480f-8d91-c107c3c7f128 ==============================
[0m06:19:03.742433 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:19:03.743142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:19:04.116507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bea3890>]}
[0m06:19:04.134733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70498d40>]}
[0m06:19:04.135175 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:19:04.178811 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:19:04.255889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:19:04.256345 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/input/crypto_price_momentum.sql
[0m06:19:04.348218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ba511c0>]}
[0m06:19:04.401590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bb7b650>]}
[0m06:19:04.401890 [info ] [MainThread]: Found 5 models, 2 snapshots, 8 data tests, 2 sources, 575 macros
[0m06:19:04.402429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940ba240>]}
[0m06:19:04.403371 [info ] [MainThread]: 
[0m06:19:04.403844 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:19:04.405816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m06:19:04.411748 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m06:19:04.411967 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m06:19:04.412157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:04.835892 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.424 seconds
[0m06:19:04.840877 [debug] [ThreadPool]: On list_dev: Close
[0m06:19:04.974826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m06:19:04.984224 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m06:19:04.984729 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m06:19:04.985207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:05.449227 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.464 seconds
[0m06:19:05.454679 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m06:19:05.589060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m06:19:05.596257 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m06:19:05.597361 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m06:19:05.598085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:06.187101 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.589 seconds
[0m06:19:06.192003 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m06:19:06.307573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6bda8e60>]}
[0m06:19:06.310055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:19:06.311975 [info ] [MainThread]: 
[0m06:19:06.326546 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m06:19:06.327416 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m06:19:06.328416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m06:19:06.328880 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m06:19:06.335350 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m06:19:06.337882 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m06:19:06.355107 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m06:19:06.356324 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m06:19:06.356623 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m06:19:06.356941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:07.156006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m06:19:07.182062 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m06:19:07.317437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff701486b0>]}
[0m06:19:07.319965 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.99s]
[0m06:19:07.322089 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m06:19:07.324580 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m06:19:07.325583 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m06:19:07.326734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m06:19:07.327338 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m06:19:07.330962 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m06:19:07.334051 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m06:19:07.336492 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m06:19:07.338539 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m06:19:07.338998 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        COALESCE(LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date),0) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        
        CASE 
            WHEN price_close_7d_ago = 0 THEN 0
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Overbought'
            WHEN price_momentum_7d < 0 THEN 'Oversold'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    COALESCE(price_close_7d_ago, 0) as price_close_7d_ago,
    COALESCE(price_momentum_7d, 0) as price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m06:19:07.339435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:07.978328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m06:19:07.980898 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m06:19:08.103731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b1e94c0>]}
[0m06:19:08.106594 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.78s]
[0m06:19:08.109583 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m06:19:08.110889 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m06:19:08.111999 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m06:19:08.113531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m06:19:08.114382 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m06:19:08.120205 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m06:19:08.123129 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m06:19:08.125911 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m06:19:08.128072 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m06:19:08.128558 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_gain_7d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_loss_7d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_7d,
    avg_loss_7d,
    CASE WHEN avg_loss_7d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_7d / avg_loss_7d))) 
    END AS rsi_7d
FROM avg_gain_loss
  );
[0m06:19:08.128952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:08.795423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m06:19:08.801847 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m06:19:09.033023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b106210>]}
[0m06:19:09.035777 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.92s]
[0m06:19:09.038253 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m06:19:09.039524 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m06:19:09.040528 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m06:19:09.041919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m06:19:09.042648 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m06:19:09.046806 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m06:19:09.048688 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m06:19:09.051455 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m06:19:09.053190 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m06:19:09.053727 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m06:19:09.054172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:09.917162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.863 seconds
[0m06:19:09.918509 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m06:19:10.028070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b5b7b60>]}
[0m06:19:10.028583 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.99s]
[0m06:19:10.029146 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m06:19:10.029626 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:19:10.030030 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m06:19:10.030408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m06:19:10.030663 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:19:10.032206 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m06:19:10.033721 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:19:10.042513 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m06:19:10.043681 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m06:19:10.043925 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_7d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7d, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_7d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7d,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m06:19:10.044140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:11.559953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.516 seconds
[0m06:19:11.564219 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m06:19:11.830016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc1c756e-77ce-480f-8d91-c107c3c7f128', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ad029f0>]}
[0m06:19:11.832404 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.80s]
[0m06:19:11.836126 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:19:11.839326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:11.840091 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m06:19:11.840886 [info ] [MainThread]: 
[0m06:19:11.842000 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m06:19:11.843569 [debug] [MainThread]: Command end result
[0m06:19:11.879787 [info ] [MainThread]: 
[0m06:19:11.880305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:19:11.880668 [info ] [MainThread]: 
[0m06:19:11.880978 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:19:11.881773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.177227, "process_user_time": 2.768956, "process_kernel_time": 0.17544, "process_mem_max_rss": "210356", "process_out_blocks": "3933", "process_in_blocks": "0"}
[0m06:19:11.882126 [debug] [MainThread]: Command `dbt run` succeeded at 06:19:11.882067 after 8.18 seconds
[0m06:19:11.882407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967f9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93712cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93712960>]}
[0m06:19:11.882680 [debug] [MainThread]: Flushing usage events
[0m06:19:14.874319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb507ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb55be5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5028d40>]}


============================== 06:19:14.877504 | e5d80f85-4646-403c-979a-ddba8482ff1c ==============================
[0m06:19:14.877504 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:19:14.878074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:19:15.242598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5d80f85-4646-403c-979a-ddba8482ff1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5df8ce0>]}
[0m06:19:15.261751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5d80f85-4646-403c-979a-ddba8482ff1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91388d40>]}
[0m06:19:15.262223 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:19:15.303587 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:19:15.376323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:15.376649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:15.397262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5d80f85-4646-403c-979a-ddba8482ff1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e6c680>]}
[0m06:19:15.456023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5d80f85-4646-403c-979a-ddba8482ff1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bfeea0>]}
[0m06:19:15.456324 [info ] [MainThread]: Found 5 models, 2 snapshots, 8 data tests, 2 sources, 575 macros
[0m06:19:15.456761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d80f85-4646-403c-979a-ddba8482ff1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fed9d0>]}
[0m06:19:15.457709 [info ] [MainThread]: 
[0m06:19:15.458143 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:19:15.460010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m06:19:15.467011 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m06:19:15.467257 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m06:19:15.467485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:15.974110 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.506 seconds
[0m06:19:15.980595 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m06:19:16.107603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m06:19:16.116070 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m06:19:16.117108 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m06:19:16.117974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:16.678364 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.560 seconds
[0m06:19:16.680621 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m06:19:16.796597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5d80f85-4646-403c-979a-ddba8482ff1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5e98f80>]}
[0m06:19:16.797427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:19:16.798368 [info ] [MainThread]: 
[0m06:19:16.807286 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333
[0m06:19:16.807801 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral  [RUN]
[0m06:19:16.808434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333)
[0m06:19:16.808828 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333
[0m06:19:16.820381 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333"
[0m06:19:16.821511 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333
[0m06:19:16.833627 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333"
[0m06:19:16.834815 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333"
[0m06:19:16.835127 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        price_momentum as value_field,
        count(*) as n_records

    from dev.analytics.crypto_abstract_metrics
    group by price_momentum

)

select *
from all_values
where value_field not in (
    'Overbought','Oversold','Neutral'
)



      
    ) dbt_internal_test
[0m06:19:16.835397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:17.239672 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b861bb-0004-2cf5-0002-787300012d46
[0m06:19:17.241276 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 8
invalid identifier 'PRICE_MOMENTUM'
[0m06:19:17.242818 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333: Close
[0m06:19:17.378765 [debug] [Thread-1 (]: Database Error in test accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral (models/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'PRICE_MOMENTUM'
  compiled code at target/run/crypto_currencies_elt/models/schema.yml/accepted_values_crypto_abstrac_a988f1dfa9e3998f99a2f915cf58faaf.sql
[0m06:19:17.380405 [error] [Thread-1 (]: 1 of 8 ERROR accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral  [[31mERROR[0m in 0.57s]
[0m06:19:17.381945 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333
[0m06:19:17.382672 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:19:17.384131 [info ] [Thread-1 (]: 2 of 8 START test not_null_crypto_abstract_metrics_date ........................ [RUN]
[0m06:19:17.385232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral.3f753f4333, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06)
[0m06:19:17.385887 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:19:17.392681 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:19:17.394155 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:19:17.396215 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:19:17.397607 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:19:17.398131 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.crypto_abstract_metrics
where date is null



      
    ) dbt_internal_test
[0m06:19:17.398536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:18.215499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m06:19:18.231414 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: Close
[0m06:19:18.722270 [info ] [Thread-1 (]: 2 of 8 PASS not_null_crypto_abstract_metrics_date .............................. [[32mPASS[0m in 1.34s]
[0m06:19:18.725288 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:19:18.726837 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:19:18.727976 [info ] [Thread-1 (]: 3 of 8 START test not_null_crypto_abstract_metrics_price_close ................. [RUN]
[0m06:19:18.729447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3)
[0m06:19:18.730577 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:19:18.736276 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:19:18.738066 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:19:18.740593 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:19:18.742160 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:19:18.742594 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_close
from dev.analytics.crypto_abstract_metrics
where price_close is null



      
    ) dbt_internal_test
[0m06:19:18.743004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:19.331434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m06:19:19.333009 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: Close
[0m06:19:19.457617 [info ] [Thread-1 (]: 3 of 8 PASS not_null_crypto_abstract_metrics_price_close ....................... [[32mPASS[0m in 0.73s]
[0m06:19:19.460259 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:19:19.461375 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:19:19.462444 [info ] [Thread-1 (]: 4 of 8 START test not_null_crypto_abstract_metrics_rsi_7d ...................... [RUN]
[0m06:19:19.463788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405)
[0m06:19:19.464665 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:19:19.469614 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:19:19.471252 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:19:19.473649 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:19:19.475114 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:19:19.475560 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_7d
from dev.analytics.crypto_abstract_metrics
where rsi_7d is null



      
    ) dbt_internal_test
[0m06:19:19.475972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:20.257886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m06:19:20.263261 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: Close
[0m06:19:20.374272 [info ] [Thread-1 (]: 4 of 8 PASS not_null_crypto_abstract_metrics_rsi_7d ............................ [[32mPASS[0m in 0.91s]
[0m06:19:20.377061 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:19:20.378296 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:19:20.379307 [info ] [Thread-1 (]: 5 of 8 START test not_null_crypto_abstract_metrics_sma_7d ...................... [RUN]
[0m06:19:20.380688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003)
[0m06:19:20.381352 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:19:20.389568 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:19:20.392084 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:19:20.394988 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:19:20.397285 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:19:20.397848 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_7d
from dev.analytics.crypto_abstract_metrics
where sma_7d is null



      
    ) dbt_internal_test
[0m06:19:20.398384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:20.838297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m06:19:20.839540 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: Close
[0m06:19:20.960300 [info ] [Thread-1 (]: 5 of 8 PASS not_null_crypto_abstract_metrics_sma_7d ............................ [[32mPASS[0m in 0.58s]
[0m06:19:20.961951 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:19:20.962666 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:19:20.963264 [info ] [Thread-1 (]: 6 of 8 START test not_null_crypto_abstract_metrics_symbol ...................... [RUN]
[0m06:19:20.964155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e)
[0m06:19:20.964740 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:19:20.969049 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:19:20.970375 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:19:20.972565 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:19:20.973975 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:19:20.974400 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.crypto_abstract_metrics
where symbol is null



      
    ) dbt_internal_test
[0m06:19:20.974831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:22.430174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.455 seconds
[0m06:19:22.434417 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: Close
[0m06:19:22.552848 [info ] [Thread-1 (]: 6 of 8 PASS not_null_crypto_abstract_metrics_symbol ............................ [[32mPASS[0m in 1.59s]
[0m06:19:22.553952 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:19:22.554449 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:19:22.554893 [info ] [Thread-1 (]: 7 of 8 START test not_null_crypto_abstract_metrics_trades_count ................ [RUN]
[0m06:19:22.555551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724)
[0m06:19:22.555917 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:19:22.558998 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:19:22.560050 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:19:22.561557 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:19:22.562652 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:19:22.563050 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trades_count
from dev.analytics.crypto_abstract_metrics
where trades_count is null



      
    ) dbt_internal_test
[0m06:19:22.563384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:23.134203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m06:19:23.135814 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: Close
[0m06:19:23.385438 [info ] [Thread-1 (]: 7 of 8 PASS not_null_crypto_abstract_metrics_trades_count ...................... [[32mPASS[0m in 0.83s]
[0m06:19:23.388997 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:19:23.390370 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:19:23.391543 [info ] [Thread-1 (]: 8 of 8 START test not_null_crypto_abstract_metrics_volume_traded ............... [RUN]
[0m06:19:23.393260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56)
[0m06:19:23.394279 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:19:23.401376 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:19:23.403349 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:19:23.405942 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:19:23.407668 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:19:23.408160 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume_traded
from dev.analytics.crypto_abstract_metrics
where volume_traded is null



      
    ) dbt_internal_test
[0m06:19:23.408539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:23.854542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m06:19:23.861031 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: Close
[0m06:19:23.990968 [info ] [Thread-1 (]: 8 of 8 PASS not_null_crypto_abstract_metrics_volume_traded ..................... [[32mPASS[0m in 0.60s]
[0m06:19:23.994749 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:19:23.998084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:23.998846 [debug] [MainThread]: Connection 'test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56' was properly closed.
[0m06:19:23.999628 [info ] [MainThread]: 
[0m06:19:24.001083 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 8.54 seconds (8.54s).
[0m06:19:24.003560 [debug] [MainThread]: Command end result
[0m06:19:24.043632 [info ] [MainThread]: 
[0m06:19:24.044274 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:19:24.044644 [info ] [MainThread]: 
[0m06:19:24.044940 [error] [MainThread]:   Database Error in test accepted_values_crypto_abstract_metrics_price_momentum__Overbought__Oversold__Neutral (models/schema.yml)
  000904 (42000): SQL compilation error: error line 13 at position 8
  invalid identifier 'PRICE_MOMENTUM'
  compiled code at target/run/crypto_currencies_elt/models/schema.yml/accepted_values_crypto_abstrac_a988f1dfa9e3998f99a2f915cf58faaf.sql
[0m06:19:24.045220 [info ] [MainThread]: 
[0m06:19:24.045444 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:19:24.046146 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.2064, "process_user_time": 2.820391, "process_kernel_time": 0.179725, "process_mem_max_rss": "210688", "process_out_blocks": "2663", "command_success": false, "process_in_blocks": "0"}
[0m06:19:24.046549 [debug] [MainThread]: Command `dbt test` failed at 06:19:24.046459 after 9.21 seconds
[0m06:19:24.046839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90bff2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4b82c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4dea1b0>]}
[0m06:19:24.047109 [debug] [MainThread]: Flushing usage events
[0m06:36:29.891377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c59ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c355670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c0c47a0>]}
[0m06:36:29.891374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6b7ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dcfd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c51fda0>]}


============================== 06:36:29.895955 | ef6b4ffb-49ea-4617-9fa9-8891e69cde5d ==============================
[0m06:36:29.895955 [info ] [MainThread]: Running with dbt=1.8.7


============================== 06:36:29.896017 | 64f573b6-38c1-4070-8661-6489679d6535 ==============================
[0m06:36:29.896017 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:36:29.897503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:36:29.897556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:36:29.949358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f573b6-38c1-4070-8661-6489679d6535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccd9bb0>]}
[0m06:36:29.949358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef6b4ffb-49ea-4617-9fa9-8891e69cde5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d30ba40>]}
[0m06:36:29.957268 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:36:29.957268 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:36:29.959302 [error] [MainThread]: Encountered an error:
[Errno 2] No such file or directory: 'run_functional_test.sh'
[0m06:36:29.960882 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 447, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/deps.py", line 233, in run
    system.rmtree(self.project.packages_install_path)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt_common/clients/system.py", line 715, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 785, in rmtree
    _rmtree_safe_fd(fd, path, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 686, in _rmtree_safe_fd
    _rmtree_safe_fd(dirfd, fullname, onexc)
  File "/usr/local/lib/python3.12/shutil.py", line 717, in _rmtree_safe_fd
    onexc(os.unlink, fullname, err)
  File "/usr/local/lib/python3.12/shutil.py", line 764, in onexc
    return onerror(func, path, exc_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/shutil.py", line 715, in _rmtree_safe_fd
    os.unlink(entry.name, dir_fd=topfd)
FileNotFoundError: [Errno 2] No such file or directory: 'run_functional_test.sh'

[0m06:36:29.961557 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.11428625, "process_user_time": 1.078915, "process_kernel_time": 0.163349, "process_mem_max_rss": "207308", "process_out_blocks": "7", "command_success": false, "process_in_blocks": "0"}
[0m06:36:29.961916 [debug] [MainThread]: Command `dbt deps` failed at 06:36:29.961854 after 0.11 seconds
[0m06:36:29.962673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904c6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b977830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b72d520>]}
[0m06:36:29.963049 [debug] [MainThread]: Flushing usage events
[0m06:36:30.016384 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-n9egbvqf'
[0m06:36:30.016696 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:36:30.204506 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:36:30.206223 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:36:30.294003 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:36:30.297399 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:36:30.952726 [info ] [MainThread]: Installed from version 1.3.0
[0m06:36:30.953130 [info ] [MainThread]: Up to date!
[0m06:36:30.953497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ef6b4ffb-49ea-4617-9fa9-8891e69cde5d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6cd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b6cd0a0>]}
[0m06:36:30.954261 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1069727, "process_user_time": 1.213697, "process_kernel_time": 0.175986, "process_mem_max_rss": "205352", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m06:36:30.954550 [debug] [MainThread]: Command `dbt deps` succeeded at 06:36:30.954500 after 1.11 seconds
[0m06:36:30.954784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b7c2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900b8ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c309970>]}
[0m06:36:30.955034 [debug] [MainThread]: Flushing usage events
[0m06:36:33.741968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb53cd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fe6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb901fda0>]}


============================== 06:36:33.745091 | 2b87886c-a1e0-4b17-b549-d8ea035a8466 ==============================
[0m06:36:33.745091 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:36:33.745707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:36:34.122684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91873260>]}
[0m06:36:34.141778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917c5400>]}
[0m06:36:34.142284 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:36:34.186123 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:36:34.259544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:36:34.260013 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/schema.yml
[0m06:36:34.346113 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:36:34.347368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91349be0>]}
[0m06:36:34.428765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f18830>]}
[0m06:36:34.486387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916202f0>]}
[0m06:36:34.486723 [info ] [MainThread]: Found 5 models, 2 snapshots, 8 data tests, 2 sources, 575 macros
[0m06:36:34.487275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91296570>]}
[0m06:36:34.488171 [info ] [MainThread]: 
[0m06:36:34.488652 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:36:34.490843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m06:36:34.497225 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m06:36:34.497449 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m06:36:34.497653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:34.984323 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.487 seconds
[0m06:36:34.986541 [debug] [ThreadPool]: On list_dev: Close
[0m06:36:35.158483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m06:36:35.169960 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m06:36:35.170401 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m06:36:35.170747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:35.685928 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.515 seconds
[0m06:36:35.690837 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m06:36:35.825887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m06:36:35.828672 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m06:36:35.829051 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m06:36:35.829469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:36.365775 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.536 seconds
[0m06:36:36.370878 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m06:36:36.491851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ba1520>]}
[0m06:36:36.492578 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:36:36.493400 [info ] [MainThread]: 
[0m06:36:36.500915 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m06:36:36.501416 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m06:36:36.501987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now model.crypto_currencies_elt.crypto_staging)
[0m06:36:36.502315 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m06:36:36.507016 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m06:36:36.509327 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m06:36:36.524012 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m06:36:36.525225 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m06:36:36.525497 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m06:36:36.525764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:37.104160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m06:36:37.125698 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m06:36:37.246526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb58da090>]}
[0m06:36:37.247183 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.74s]
[0m06:36:37.247905 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m06:36:37.248644 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m06:36:37.248997 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m06:36:37.249461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m06:36:37.249745 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m06:36:37.251557 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m06:36:37.253343 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m06:36:37.254843 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m06:36:37.256194 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m06:36:37.256541 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        COALESCE(LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date),0) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        
        CASE 
            WHEN price_close_7d_ago = 0 THEN 0
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        -- Classify the momentum as Positive, Negative, or Neutral
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Overbought'
            WHEN price_momentum_7d < 0 THEN 'Oversold'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

-- Final output with context columns
SELECT
    symbol,
    date,
    price_close,
    COALESCE(price_close_7d_ago, 0) as price_close_7d_ago,
    COALESCE(price_momentum_7d, 0) as price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m06:36:37.256897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:39.021600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.765 seconds
[0m06:36:39.022736 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m06:36:39.143074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9074f710>]}
[0m06:36:39.143632 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 1.89s]
[0m06:36:39.144290 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m06:36:39.144600 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m06:36:39.144941 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m06:36:39.145405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m06:36:39.145697 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m06:36:39.147326 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m06:36:39.148621 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m06:36:39.150048 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m06:36:39.151226 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m06:36:39.151522 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_gain_7d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_loss_7d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_7d,
    avg_loss_7d,
    CASE WHEN avg_loss_7d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_7d / avg_loss_7d))) 
    END AS rsi_7d
FROM avg_gain_loss
  );
[0m06:36:39.151773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:39.841256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m06:36:39.843602 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m06:36:39.973627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90fcd7c0>]}
[0m06:36:39.975588 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.83s]
[0m06:36:39.977355 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m06:36:39.978143 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m06:36:39.978956 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m06:36:39.979976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m06:36:39.980686 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m06:36:39.984302 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m06:36:39.985835 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m06:36:39.988147 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m06:36:39.990715 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m06:36:39.991155 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m06:36:39.991572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:40.685968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m06:36:40.690711 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m06:36:40.835851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9021a210>]}
[0m06:36:40.838216 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.85s]
[0m06:36:40.840545 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m06:36:40.842339 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:36:40.843749 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m06:36:40.845223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m06:36:40.845874 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:36:40.850223 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m06:36:40.853140 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:36:40.917863 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m06:36:40.919429 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m06:36:40.919714 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_7d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7d, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_7d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7d,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m06:36:40.919972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:42.669814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.750 seconds
[0m06:36:42.672773 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m06:36:42.801361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b87886c-a1e0-4b17-b549-d8ea035a8466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b3b110>]}
[0m06:36:42.802362 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.96s]
[0m06:36:42.804054 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m06:36:42.806970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:36:42.807402 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m06:36:42.807904 [info ] [MainThread]: 
[0m06:36:42.808573 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 8.32 seconds (8.32s).
[0m06:36:42.809902 [debug] [MainThread]: Command end result
[0m06:36:42.842593 [info ] [MainThread]: 
[0m06:36:42.843148 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:36:42.843415 [info ] [MainThread]: 
[0m06:36:42.843724 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:36:42.844768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.138032, "process_user_time": 2.837323, "process_kernel_time": 0.171321, "process_mem_max_rss": "208056", "process_out_blocks": "3929", "process_in_blocks": "0"}
[0m06:36:42.845120 [debug] [MainThread]: Command `dbt run` succeeded at 06:36:42.845044 after 9.14 seconds
[0m06:36:42.845400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fe6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb542f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9137c8f0>]}
[0m06:36:42.845628 [debug] [MainThread]: Flushing usage events
[0m06:36:45.870763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff813219d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d84740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839c6090>]}


============================== 06:36:45.874002 | bb5cd4f3-1568-47c8-ae8e-2687b43af4a1 ==============================
[0m06:36:45.874002 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:36:45.874372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:36:46.231663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb5cd4f3-1568-47c8-ae8e-2687b43af4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d90bd70>]}
[0m06:36:46.249864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb5cd4f3-1568-47c8-ae8e-2687b43af4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff717f3e60>]}
[0m06:36:46.250276 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:36:46.291648 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:36:46.355908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:36:46.356173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:36:46.376864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb5cd4f3-1568-47c8-ae8e-2687b43af4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d0a9dc0>]}
[0m06:36:46.433974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb5cd4f3-1568-47c8-ae8e-2687b43af4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d0ab590>]}
[0m06:36:46.434273 [info ] [MainThread]: Found 5 models, 2 snapshots, 8 data tests, 2 sources, 575 macros
[0m06:36:46.434683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5cd4f3-1568-47c8-ae8e-2687b43af4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80816510>]}
[0m06:36:46.435594 [info ] [MainThread]: 
[0m06:36:46.436021 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:36:46.437890 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m06:36:46.444650 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m06:36:46.444922 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m06:36:46.445214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:36:46.979445 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.534 seconds
[0m06:36:46.980597 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m06:36:47.093907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m06:36:47.095847 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m06:36:47.096231 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m06:36:47.096517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:36:47.560723 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.464 seconds
[0m06:36:47.562419 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m06:36:47.674482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb5cd4f3-1568-47c8-ae8e-2687b43af4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5d236ae0>]}
[0m06:36:47.675349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:36:47.676389 [info ] [MainThread]: 
[0m06:36:47.685095 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e
[0m06:36:47.685577 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral  [RUN]
[0m06:36:47.686223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e)
[0m06:36:47.686576 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e
[0m06:36:47.697939 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e"
[0m06:36:47.699913 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e
[0m06:36:47.711906 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e"
[0m06:36:47.713129 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e"
[0m06:36:47.713377 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        price_momentum_7d as value_field,
        count(*) as n_records

    from dev.analytics.crypto_abstract_metrics
    group by price_momentum_7d

)

select *
from all_values
where value_field not in (
    'Overbought','Oversold','Neutral'
)



      
    ) dbt_internal_test
[0m06:36:47.713572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:48.240089 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b861cc-0004-2cf4-0002-787300014f66
[0m06:36:48.240698 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100038 (22018): Numeric value 'Overbought' is not recognized
[0m06:36:48.241123 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e: Close
[0m06:36:48.492437 [debug] [Thread-1 (]: Database Error in test accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral (models/schema.yml)
  100038 (22018): Numeric value 'Overbought' is not recognized
  compiled code at target/run/crypto_currencies_elt/models/schema.yml/accepted_values_crypto_abstrac_eb7a9ca4d0f513d4d59d6426d8826215.sql
[0m06:36:48.494597 [error] [Thread-1 (]: 1 of 8 ERROR accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral  [[31mERROR[0m in 0.81s]
[0m06:36:48.495853 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e
[0m06:36:48.496683 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:36:48.498299 [info ] [Thread-1 (]: 2 of 8 START test not_null_crypto_abstract_metrics_date ........................ [RUN]
[0m06:36:48.499055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral.140659df5e, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06)
[0m06:36:48.499620 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:36:48.506886 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:36:48.510704 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:36:48.516422 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:36:48.520501 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:36:48.521008 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.crypto_abstract_metrics
where date is null



      
    ) dbt_internal_test
[0m06:36:48.521348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:49.107239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m06:36:49.123277 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: Close
[0m06:36:49.243302 [info ] [Thread-1 (]: 2 of 8 PASS not_null_crypto_abstract_metrics_date .............................. [[32mPASS[0m in 0.74s]
[0m06:36:49.244854 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:36:49.245522 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:36:49.246240 [info ] [Thread-1 (]: 3 of 8 START test not_null_crypto_abstract_metrics_price_close ................. [RUN]
[0m06:36:49.247242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3)
[0m06:36:49.247722 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:36:49.252219 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:36:49.253568 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:36:49.255667 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:36:49.256809 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:36:49.257181 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_close
from dev.analytics.crypto_abstract_metrics
where price_close is null



      
    ) dbt_internal_test
[0m06:36:49.257492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:49.761302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m06:36:49.763956 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: Close
[0m06:36:49.889537 [info ] [Thread-1 (]: 3 of 8 PASS not_null_crypto_abstract_metrics_price_close ....................... [[32mPASS[0m in 0.64s]
[0m06:36:49.890974 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:36:49.891434 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:36:49.891820 [info ] [Thread-1 (]: 4 of 8 START test not_null_crypto_abstract_metrics_rsi_7d ...................... [RUN]
[0m06:36:49.892364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405)
[0m06:36:49.892669 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:36:49.896415 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:36:49.897206 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:36:49.898414 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:36:49.899449 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:36:49.899682 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_7d
from dev.analytics.crypto_abstract_metrics
where rsi_7d is null



      
    ) dbt_internal_test
[0m06:36:49.899926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:50.413354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m06:36:50.414806 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: Close
[0m06:36:50.548320 [info ] [Thread-1 (]: 4 of 8 PASS not_null_crypto_abstract_metrics_rsi_7d ............................ [[32mPASS[0m in 0.66s]
[0m06:36:50.550004 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:36:50.550898 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:36:50.551738 [info ] [Thread-1 (]: 5 of 8 START test not_null_crypto_abstract_metrics_sma_7d ...................... [RUN]
[0m06:36:50.552761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003)
[0m06:36:50.553320 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:36:50.557780 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:36:50.559093 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:36:50.561225 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:36:50.562727 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:36:50.563148 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_7d
from dev.analytics.crypto_abstract_metrics
where sma_7d is null



      
    ) dbt_internal_test
[0m06:36:50.563525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:51.103392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.539 seconds
[0m06:36:51.109816 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: Close
[0m06:36:51.238972 [info ] [Thread-1 (]: 5 of 8 PASS not_null_crypto_abstract_metrics_sma_7d ............................ [[32mPASS[0m in 0.68s]
[0m06:36:51.241608 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:36:51.242481 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:36:51.243277 [info ] [Thread-1 (]: 6 of 8 START test not_null_crypto_abstract_metrics_symbol ...................... [RUN]
[0m06:36:51.244303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e)
[0m06:36:51.244784 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:36:51.249784 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:36:51.251135 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:36:51.253166 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:36:51.254362 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:36:51.254707 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.crypto_abstract_metrics
where symbol is null



      
    ) dbt_internal_test
[0m06:36:51.255157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:51.676307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m06:36:51.677506 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: Close
[0m06:36:51.787746 [info ] [Thread-1 (]: 6 of 8 PASS not_null_crypto_abstract_metrics_symbol ............................ [[32mPASS[0m in 0.54s]
[0m06:36:51.788673 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:36:51.789091 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:36:51.789474 [info ] [Thread-1 (]: 7 of 8 START test not_null_crypto_abstract_metrics_trades_count ................ [RUN]
[0m06:36:51.790061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724)
[0m06:36:51.790394 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:36:51.792829 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:36:51.793670 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:36:51.794929 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:36:51.795781 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:36:51.796083 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trades_count
from dev.analytics.crypto_abstract_metrics
where trades_count is null



      
    ) dbt_internal_test
[0m06:36:51.796358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:52.278396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m06:36:52.279505 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: Close
[0m06:36:52.385144 [info ] [Thread-1 (]: 7 of 8 PASS not_null_crypto_abstract_metrics_trades_count ...................... [[32mPASS[0m in 0.59s]
[0m06:36:52.385904 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:36:52.386252 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:36:52.386548 [info ] [Thread-1 (]: 8 of 8 START test not_null_crypto_abstract_metrics_volume_traded ............... [RUN]
[0m06:36:52.387001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56)
[0m06:36:52.387234 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:36:52.389280 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:36:52.390025 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:36:52.391126 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:36:52.391797 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:36:52.391999 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume_traded
from dev.analytics.crypto_abstract_metrics
where volume_traded is null



      
    ) dbt_internal_test
[0m06:36:52.392192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:36:52.977595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m06:36:52.983508 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: Close
[0m06:36:53.152270 [info ] [Thread-1 (]: 8 of 8 PASS not_null_crypto_abstract_metrics_volume_traded ..................... [[32mPASS[0m in 0.76s]
[0m06:36:53.155460 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:36:53.159625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:36:53.160691 [debug] [MainThread]: Connection 'test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56' was properly closed.
[0m06:36:53.161598 [info ] [MainThread]: 
[0m06:36:53.162385 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 6.73 seconds (6.73s).
[0m06:36:53.164713 [debug] [MainThread]: Command end result
[0m06:36:53.203216 [info ] [MainThread]: 
[0m06:36:53.203743 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:36:53.204060 [info ] [MainThread]: 
[0m06:36:53.204467 [error] [MainThread]:   Database Error in test accepted_values_crypto_abstract_metrics_price_momentum_7d__Overbought__Oversold__Neutral (models/schema.yml)
  100038 (22018): Numeric value 'Overbought' is not recognized
  compiled code at target/run/crypto_currencies_elt/models/schema.yml/accepted_values_crypto_abstrac_eb7a9ca4d0f513d4d59d6426d8826215.sql
[0m06:36:53.204801 [info ] [MainThread]: 
[0m06:36:53.205231 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:36:53.206390 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 7.371506, "process_user_time": 2.786764, "process_kernel_time": 0.188321, "process_mem_max_rss": "209184", "process_out_blocks": "2663", "command_success": false, "process_in_blocks": "0"}
[0m06:36:53.206764 [debug] [MainThread]: Command `dbt test` failed at 06:36:53.206710 after 7.37 seconds
[0m06:36:53.207149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81322d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a061b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e723f0>]}
[0m06:36:53.207424 [debug] [MainThread]: Flushing usage events
[0m06:39:57.275034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8febf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85fa1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85fa120>]}


============================== 06:39:57.279715 | 397c7e2b-48e0-4b3e-b344-41a975d587c1 ==============================
[0m06:39:57.279715 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:39:57.280391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m06:39:57.665818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '397c7e2b-48e0-4b3e-b344-41a975d587c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9d53b60>]}
[0m06:39:57.684894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '397c7e2b-48e0-4b3e-b344-41a975d587c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85552f60>]}
[0m06:39:57.685318 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:39:57.729031 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:39:57.795050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:39:57.795495 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/schema.yml
[0m06:39:57.869983 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:39:57.870335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '397c7e2b-48e0-4b3e-b344-41a975d587c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa886d820>]}
[0m06:39:57.948409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '397c7e2b-48e0-4b3e-b344-41a975d587c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848418e0>]}
[0m06:39:58.016577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '397c7e2b-48e0-4b3e-b344-41a975d587c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84706b70>]}
[0m06:39:58.016913 [info ] [MainThread]: Found 5 models, 2 snapshots, 9 data tests, 2 sources, 575 macros
[0m06:39:58.017407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397c7e2b-48e0-4b3e-b344-41a975d587c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84cfa600>]}
[0m06:39:58.018707 [info ] [MainThread]: 
[0m06:39:58.019249 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:39:58.021386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_analytics'
[0m06:39:58.032636 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m06:39:58.033070 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m06:39:58.033444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:58.480884 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.447 seconds
[0m06:39:58.482218 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m06:39:58.584426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m06:39:58.586136 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m06:39:58.586414 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m06:39:58.586657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:59.062242 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.476 seconds
[0m06:39:59.063582 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m06:39:59.186179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397c7e2b-48e0-4b3e-b344-41a975d587c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9bc4fb0>]}
[0m06:39:59.186648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:39:59.187293 [info ] [MainThread]: 
[0m06:39:59.193257 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b
[0m06:39:59.193673 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral  [RUN]
[0m06:39:59.194173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b)
[0m06:39:59.194440 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b
[0m06:39:59.198697 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b"
[0m06:39:59.200695 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b
[0m06:39:59.209712 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b"
[0m06:39:59.210684 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b"
[0m06:39:59.210888 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        momentum_direction as value_field,
        count(*) as n_records

    from dev.analytics.crypto_abstract_metrics
    group by momentum_direction

)

select *
from all_values
where value_field not in (
    'Overbought','Oversold','Neutral'
)



      
    ) dbt_internal_test
[0m06:39:59.211108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:39:59.699808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m06:39:59.709424 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b: Close
[0m06:39:59.824398 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral  [[32mPASS[0m in 0.63s]
[0m06:39:59.825159 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b
[0m06:39:59.825469 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:39:59.825753 [info ] [Thread-1 (]: 2 of 9 START test not_null_crypto_abstract_metrics_date ........................ [RUN]
[0m06:39:59.826047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06)
[0m06:39:59.826260 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:39:59.829518 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:39:59.830271 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:39:59.831259 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:39:59.831964 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m06:39:59.832171 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.crypto_abstract_metrics
where date is null



      
    ) dbt_internal_test
[0m06:39:59.832386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:00.271992 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m06:40:00.278110 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: Close
[0m06:40:00.422125 [info ] [Thread-1 (]: 2 of 9 PASS not_null_crypto_abstract_metrics_date .............................. [[32mPASS[0m in 0.59s]
[0m06:40:00.425867 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m06:40:00.427114 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:40:00.428245 [info ] [Thread-1 (]: 3 of 9 START test not_null_crypto_abstract_metrics_price_close ................. [RUN]
[0m06:40:00.429696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3)
[0m06:40:00.430519 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:40:00.436328 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:40:00.439177 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:40:00.441679 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:40:00.443197 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m06:40:00.443576 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_close
from dev.analytics.crypto_abstract_metrics
where price_close is null



      
    ) dbt_internal_test
[0m06:40:00.443989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:00.833309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m06:40:00.835931 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: Close
[0m06:40:00.967412 [info ] [Thread-1 (]: 3 of 9 PASS not_null_crypto_abstract_metrics_price_close ....................... [[32mPASS[0m in 0.54s]
[0m06:40:00.969560 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m06:40:00.970502 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6
[0m06:40:00.971195 [info ] [Thread-1 (]: 4 of 9 START test not_null_crypto_abstract_metrics_price_momentum_7d ........... [RUN]
[0m06:40:00.972337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6)
[0m06:40:00.972912 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6
[0m06:40:01.087161 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6"
[0m06:40:01.090575 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6
[0m06:40:01.091865 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6"
[0m06:40:01.092635 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6"
[0m06:40:01.092834 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_momentum_7d
from dev.analytics.crypto_abstract_metrics
where price_momentum_7d is null



      
    ) dbt_internal_test
[0m06:40:01.093061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:01.641127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m06:40:01.647150 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6: Close
[0m06:40:01.786947 [info ] [Thread-1 (]: 4 of 9 PASS not_null_crypto_abstract_metrics_price_momentum_7d ................. [[32mPASS[0m in 0.81s]
[0m06:40:01.790243 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6
[0m06:40:01.791665 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:40:01.792611 [info ] [Thread-1 (]: 5 of 9 START test not_null_crypto_abstract_metrics_rsi_7d ...................... [RUN]
[0m06:40:01.794089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405)
[0m06:40:01.794963 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:40:01.800968 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:40:01.802973 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:40:01.805452 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:40:01.807167 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m06:40:01.807697 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_7d
from dev.analytics.crypto_abstract_metrics
where rsi_7d is null



      
    ) dbt_internal_test
[0m06:40:01.808137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:02.270829 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m06:40:02.277060 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: Close
[0m06:40:02.410421 [info ] [Thread-1 (]: 5 of 9 PASS not_null_crypto_abstract_metrics_rsi_7d ............................ [[32mPASS[0m in 0.62s]
[0m06:40:02.412752 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m06:40:02.413761 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:40:02.414517 [info ] [Thread-1 (]: 6 of 9 START test not_null_crypto_abstract_metrics_sma_7d ...................... [RUN]
[0m06:40:02.415758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003)
[0m06:40:02.416358 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:40:02.423145 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:40:02.426007 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:40:02.430694 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:40:02.433447 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m06:40:02.433996 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_7d
from dev.analytics.crypto_abstract_metrics
where sma_7d is null



      
    ) dbt_internal_test
[0m06:40:02.434636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:03.017859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m06:40:03.023803 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: Close
[0m06:40:03.185671 [info ] [Thread-1 (]: 6 of 9 PASS not_null_crypto_abstract_metrics_sma_7d ............................ [[32mPASS[0m in 0.77s]
[0m06:40:03.189014 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m06:40:03.189955 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:40:03.190820 [info ] [Thread-1 (]: 7 of 9 START test not_null_crypto_abstract_metrics_symbol ...................... [RUN]
[0m06:40:03.192293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e)
[0m06:40:03.192936 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:40:03.199992 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:40:03.202862 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:40:03.205609 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:40:03.207123 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m06:40:03.207575 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.crypto_abstract_metrics
where symbol is null



      
    ) dbt_internal_test
[0m06:40:03.207953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:03.608351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.400 seconds
[0m06:40:03.613144 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: Close
[0m06:40:03.749786 [info ] [Thread-1 (]: 7 of 9 PASS not_null_crypto_abstract_metrics_symbol ............................ [[32mPASS[0m in 0.56s]
[0m06:40:03.752130 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m06:40:03.753158 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:40:03.754042 [info ] [Thread-1 (]: 8 of 9 START test not_null_crypto_abstract_metrics_trades_count ................ [RUN]
[0m06:40:03.755150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724)
[0m06:40:03.755789 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:40:03.760674 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:40:03.762261 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:40:03.764355 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:40:03.765739 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m06:40:03.766155 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trades_count
from dev.analytics.crypto_abstract_metrics
where trades_count is null



      
    ) dbt_internal_test
[0m06:40:03.766624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:04.142349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m06:40:04.143871 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: Close
[0m06:40:04.259349 [info ] [Thread-1 (]: 8 of 9 PASS not_null_crypto_abstract_metrics_trades_count ...................... [[32mPASS[0m in 0.50s]
[0m06:40:04.261570 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m06:40:04.262302 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:40:04.263070 [info ] [Thread-1 (]: 9 of 9 START test not_null_crypto_abstract_metrics_volume_traded ............... [RUN]
[0m06:40:04.264320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56)
[0m06:40:04.264912 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:40:04.269421 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:40:04.270829 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:40:04.272827 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:40:04.274103 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m06:40:04.274518 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume_traded
from dev.analytics.crypto_abstract_metrics
where volume_traded is null



      
    ) dbt_internal_test
[0m06:40:04.274905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:04.686800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m06:40:04.691868 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: Close
[0m06:40:04.811971 [info ] [Thread-1 (]: 9 of 9 PASS not_null_crypto_abstract_metrics_volume_traded ..................... [[32mPASS[0m in 0.55s]
[0m06:40:04.813440 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m06:40:04.816655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:04.817126 [debug] [MainThread]: Connection 'test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56' was properly closed.
[0m06:40:04.817668 [info ] [MainThread]: 
[0m06:40:04.818169 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m06:40:04.819843 [debug] [MainThread]: Command end result
[0m06:40:04.853988 [info ] [MainThread]: 
[0m06:40:04.854528 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:40:04.854835 [info ] [MainThread]: 
[0m06:40:04.855162 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m06:40:04.856242 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.6179376, "process_user_time": 3.078825, "process_kernel_time": 0.249607, "process_mem_max_rss": "210272", "process_out_blocks": "3951", "process_in_blocks": "0"}
[0m06:40:04.856574 [debug] [MainThread]: Command `dbt test` succeeded at 06:40:04.856515 after 7.62 seconds
[0m06:40:04.856873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8febf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43d6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa43d6720>]}
[0m06:40:04.857101 [debug] [MainThread]: Flushing usage events
[0m06:40:07.181786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df1cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d48c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e8e95e0>]}


============================== 06:40:07.186709 | 553dabc4-3d10-4118-b116-6af34fd9c790 ==============================
[0m06:40:07.186709 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:40:07.187358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m06:40:07.563467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '553dabc4-3d10-4118-b116-6af34fd9c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0d7860>]}
[0m06:40:07.583692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '553dabc4-3d10-4118-b116-6af34fd9c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff59771010>]}
[0m06:40:07.584250 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:40:07.628962 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:40:07.700153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:40:07.700428 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:40:07.721084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '553dabc4-3d10-4118-b116-6af34fd9c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff59113440>]}
[0m06:40:07.783038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '553dabc4-3d10-4118-b116-6af34fd9c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff58d27710>]}
[0m06:40:07.783459 [info ] [MainThread]: Found 5 models, 2 snapshots, 9 data tests, 2 sources, 575 macros
[0m06:40:07.783900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553dabc4-3d10-4118-b116-6af34fd9c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff58dc41d0>]}
[0m06:40:07.784928 [info ] [MainThread]: 
[0m06:40:07.785347 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:40:07.787750 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m06:40:07.795021 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m06:40:07.795347 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m06:40:07.795550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:08.229012 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.433 seconds
[0m06:40:08.230676 [debug] [ThreadPool]: On list_dev: Close
[0m06:40:08.363321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_snapshot)
[0m06:40:08.374517 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m06:40:08.375153 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m06:40:08.375746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:08.799158 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.423 seconds
[0m06:40:08.804500 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m06:40:08.925341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m06:40:08.931971 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m06:40:08.932835 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m06:40:08.933533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:09.464937 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.531 seconds
[0m06:40:09.468139 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m06:40:09.595021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553dabc4-3d10-4118-b116-6af34fd9c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c147500>]}
[0m06:40:09.596419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:40:09.598804 [info ] [MainThread]: 
[0m06:40:09.611737 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m06:40:09.612470 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m06:40:09.613202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m06:40:09.613611 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m06:40:09.628665 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m06:40:09.659738 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:09.660146 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m06:40:09.660480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:10.042833 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.382 seconds
[0m06:40:10.078222 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:10.078721 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_7d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m06:40:10.997423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.918 seconds
[0m06:40:11.002607 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:11.003448 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m06:40:11.142036 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.138 seconds
[0m06:40:11.150189 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:11.151117 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m06:40:11.281954 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.130 seconds
[0m06:40:11.286883 [debug] [Thread-1 (]: Changing col type from character varying(8) to character varying(10) in table database: "DEV"
schema: "SNAPSHOT"
identifier: "SNAPSHOT_CRYPTO_ABSTRACT_METRICS"

[0m06:40:11.295945 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:11.296725 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
alter table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS" alter "MOMENTUM_DIRECTION" set data type character varying(10);
[0m06:40:11.510881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m06:40:11.516867 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:11.517722 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m06:40:11.595429 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.077 seconds
[0m06:40:11.604070 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:11.604857 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m06:40:11.705471 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.100 seconds
[0m06:40:11.719985 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:11.721637 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m06:40:11.818898 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.096 seconds
[0m06:40:11.847652 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:11.848495 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_7d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m06:40:12.328410 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.479 seconds
[0m06:40:12.335474 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:12.336565 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m06:40:12.499402 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.162 seconds
[0m06:40:12.501143 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:12.506023 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:12.507419 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
BEGIN
[0m06:40:12.659461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m06:40:12.661326 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:12.662662 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_7D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_7D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:40:13.194199 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.530 seconds
[0m06:40:13.196015 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m06:40:13.197289 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
COMMIT
[0m06:40:13.484717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m06:40:13.512197 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m06:40:13.691585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553dabc4-3d10-4118-b116-6af34fd9c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0d9f10>]}
[0m06:40:13.694201 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_crypto_abstract_metrics ................ [[32mSUCCESS 0[0m in 4.07s]
[0m06:40:13.697632 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m06:40:13.698658 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m06:40:13.699598 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m06:40:13.700854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m06:40:13.702136 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m06:40:13.708419 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m06:40:13.712608 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:13.713084 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m06:40:13.713497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:14.283898 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.570 seconds
[0m06:40:14.296105 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:14.297574 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m06:40:15.335651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.036 seconds
[0m06:40:15.343305 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:15.344335 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m06:40:15.469873 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.124 seconds
[0m06:40:15.479306 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:15.480335 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m06:40:15.563676 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.082 seconds
[0m06:40:15.570446 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:15.571269 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m06:40:15.659208 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.087 seconds
[0m06:40:15.670887 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:15.671583 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m06:40:15.784910 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.112 seconds
[0m06:40:15.793040 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:15.794150 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m06:40:15.914134 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.119 seconds
[0m06:40:15.918488 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:15.918957 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,  -- Create a unique identifier
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m06:40:16.422820 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.503 seconds
[0m06:40:16.423666 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:16.423945 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m06:40:16.501318 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.077 seconds
[0m06:40:16.501946 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:16.504779 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:16.505150 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
BEGIN
[0m06:40:16.680230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m06:40:16.680869 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:16.681330 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:40:17.344845 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.663 seconds
[0m06:40:17.345502 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m06:40:17.345828 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
COMMIT
[0m06:40:17.961828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m06:40:17.964671 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m06:40:18.100847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553dabc4-3d10-4118-b116-6af34fd9c790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff581f42c0>]}
[0m06:40:18.103001 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 0[0m in 4.40s]
[0m06:40:18.104953 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m06:40:18.107068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:18.107598 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m06:40:18.108115 [info ] [MainThread]: 
[0m06:40:18.108899 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m06:40:18.110035 [debug] [MainThread]: Command end result
[0m06:40:18.146114 [info ] [MainThread]: 
[0m06:40:18.146710 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:40:18.147087 [info ] [MainThread]: 
[0m06:40:18.147440 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:40:18.148297 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.027084, "process_user_time": 2.800987, "process_kernel_time": 0.192756, "process_mem_max_rss": "205352", "process_out_blocks": "2682", "process_in_blocks": "0"}
[0m06:40:18.148702 [debug] [MainThread]: Command `dbt snapshot` succeeded at 06:40:18.148640 after 11.03 seconds
[0m06:40:18.148984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4dee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca2f3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd33110>]}
[0m06:40:18.149209 [debug] [MainThread]: Flushing usage events
[0m21:18:30.805450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aca2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d192300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aca34d0>]}


============================== 21:18:30.809145 | 107756b7-b604-485f-995f-45a2d9d644c3 ==============================
[0m21:18:30.809145 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:18:30.809520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'send_anonymous_usage_stats': 'True'}
[0m21:18:30.851640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '107756b7-b604-485f-995f-45a2d9d644c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a372c30>]}
[0m21:18:30.856973 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:18:30.901710 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_390qz2n'
[0m21:18:30.902006 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:18:31.093682 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:18:31.095105 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:18:31.181295 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:18:31.185932 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:18:31.830387 [info ] [MainThread]: Installed from version 1.3.0
[0m21:18:31.831071 [info ] [MainThread]: Up to date!
[0m21:18:31.832107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '107756b7-b604-485f-995f-45a2d9d644c3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2c6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3ae2d0>]}
[0m21:18:31.833457 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.068118, "process_user_time": 0.986277, "process_kernel_time": 0.143476, "process_mem_max_rss": "209336", "process_out_blocks": "734", "process_in_blocks": "0"}
[0m21:18:31.833827 [debug] [MainThread]: Command `dbt deps` succeeded at 21:18:31.833775 after 1.07 seconds
[0m21:18:31.834060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5b3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a372c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3ae2d0>]}
[0m21:18:31.834298 [debug] [MainThread]: Flushing usage events
[0m21:18:34.725658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba1a8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3ffad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb0f6870>]}


============================== 21:18:34.729050 | cfeaf602-b155-4c40-98e7-73650553b9e2 ==============================
[0m21:18:34.729050 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:18:34.729620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:18:35.113429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9dc3e60>]}
[0m21:18:35.132747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93467770>]}
[0m21:18:35.133208 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:18:35.178389 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:18:35.254934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:18:35.255348 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://models/input/crypto_price_momentum.sql
[0m21:18:35.255611 [debug] [MainThread]: Partial parsing: updated file: crypto_currencies_elt://snapshots/snapshot_crypto_currencies.sql
[0m21:18:35.410410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ffb320>]}
[0m21:18:35.464611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9249a6f0>]}
[0m21:18:35.464933 [info ] [MainThread]: Found 5 models, 2 snapshots, 9 data tests, 2 sources, 575 macros
[0m21:18:35.465315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f39700>]}
[0m21:18:35.466268 [info ] [MainThread]: 
[0m21:18:35.466772 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:35.469129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m21:18:35.474965 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m21:18:35.475230 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m21:18:35.475439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:35.941471 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.466 seconds
[0m21:18:35.945474 [debug] [ThreadPool]: On list_dev: Close
[0m21:18:36.254800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m21:18:36.267337 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m21:18:36.268118 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m21:18:36.268749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:36.799937 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.531 seconds
[0m21:18:36.807313 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m21:18:36.936964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m21:18:36.944652 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m21:18:36.945672 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m21:18:36.946380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:37.407012 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.461 seconds
[0m21:18:37.409072 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m21:18:37.552923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba908aa0>]}
[0m21:18:37.554298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:37.555818 [info ] [MainThread]: 
[0m21:18:37.568302 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_staging
[0m21:18:37.569260 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.crypto_staging ........................... [RUN]
[0m21:18:37.570204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now model.crypto_currencies_elt.crypto_staging)
[0m21:18:37.570694 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_staging
[0m21:18:37.577302 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_staging"
[0m21:18:37.579600 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_staging
[0m21:18:37.597498 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_staging"
[0m21:18:37.599131 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_staging"
[0m21:18:37.599442 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_staging"} */
create or replace   view dev.analytics.crypto_staging
  
   as (
    WITH crypto_staging AS (
    SELECT 
        symbol,
        date,
        CAST(price_open AS DECIMAL(10, 3)) AS price_open,
        CAST(price_high AS DECIMAL(10, 3)) AS price_high,
        CAST(price_low AS DECIMAL(10, 3)) AS price_low,
        CAST(price_close AS DECIMAL(10, 3)) AS price_close,
        volume_traded,
        trades_count
    FROM dev.raw_data.crypto_currencies
)
SELECT * FROM crypto_staging
  );
[0m21:18:37.599724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:38.327235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m21:18:38.342346 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_staging: Close
[0m21:18:38.482006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a142f0>]}
[0m21:18:38.483199 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.crypto_staging ...................... [[32mSUCCESS 1[0m in 0.91s]
[0m21:18:38.484401 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_staging
[0m21:18:38.485552 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_price_momentum
[0m21:18:38.486034 [info ] [Thread-1 (]: 2 of 5 START sql view model analytics.crypto_price_momentum .................... [RUN]
[0m21:18:38.486558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_staging, now model.crypto_currencies_elt.crypto_price_momentum)
[0m21:18:38.486895 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_price_momentum
[0m21:18:38.491172 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m21:18:38.492895 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_price_momentum
[0m21:18:38.494785 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_price_momentum"
[0m21:18:38.496456 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_price_momentum"
[0m21:18:38.496819 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_price_momentum"} */
create or replace   view dev.analytics.crypto_price_momentum
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        COALESCE(LAG(price_close, 7) OVER(PARTITION BY symbol ORDER BY date),0) AS price_close_7d_ago
    FROM dev.analytics.crypto_staging
),
momentum_calc AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,       
        CASE 
            WHEN price_close_7d_ago = 0 THEN 0
            ELSE ((price_close - price_close_7d_ago) / price_close_7d_ago) * 100
        END AS price_momentum_7d
    FROM base
),
momentum_classification AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close_7d_ago,
        price_momentum_7d,
        CASE 
            WHEN price_momentum_7d > 0 THEN 'Overbought'
            WHEN price_momentum_7d < 0 THEN 'Oversold'
            ELSE 'Neutral'
        END AS momentum_direction
    FROM momentum_calc
)

SELECT
    symbol,
    date,
    price_close,
    COALESCE(price_close_7d_ago, 0) as price_close_7d_ago,
    COALESCE(price_momentum_7d, 0) as price_momentum_7d,
    momentum_direction
FROM momentum_classification
ORDER BY symbol, date
  );
[0m21:18:38.497145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:39.316562 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.819 seconds
[0m21:18:39.320028 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_price_momentum: Close
[0m21:18:39.428077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917e7200>]}
[0m21:18:39.429144 [info ] [Thread-1 (]: 2 of 5 OK created sql view model analytics.crypto_price_momentum ............... [[32mSUCCESS 1[0m in 0.94s]
[0m21:18:39.430345 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_price_momentum
[0m21:18:39.430836 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_rsi
[0m21:18:39.431418 [info ] [Thread-1 (]: 3 of 5 START sql view model analytics.crypto_rsi ............................... [RUN]
[0m21:18:39.432192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_price_momentum, now model.crypto_currencies_elt.crypto_rsi)
[0m21:18:39.432672 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_rsi
[0m21:18:39.435157 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_rsi"
[0m21:18:39.436690 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_rsi
[0m21:18:39.438407 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_rsi"
[0m21:18:39.439788 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_rsi"
[0m21:18:39.440105 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_rsi"} */
create or replace   view dev.analytics.crypto_rsi
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        price_close - LAG(price_close) OVER(PARTITION BY symbol ORDER BY date) AS price_change
    FROM dev.analytics.crypto_staging
)
, gains_losses AS (
    SELECT
        symbol,
        date,
        price_close,
        CASE WHEN price_change > 0 THEN price_change ELSE 0 END AS gain,
        CASE WHEN price_change < 0 THEN ABS(price_change) ELSE 0 END AS loss
    FROM base
)
, avg_gain_loss AS (
    SELECT
        symbol,
        date,
        price_close,
        AVG(gain) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_gain_7d,
        AVG(loss) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS avg_loss_7d
    FROM gains_losses
)
SELECT
    symbol,
    date,
    price_close,
    avg_gain_7d,
    avg_loss_7d,
    CASE WHEN avg_loss_7d = 0 THEN 100
         ELSE 100 - (100 / (1 + (avg_gain_7d / avg_loss_7d))) 
    END AS rsi_7d
FROM avg_gain_loss
  );
[0m21:18:39.440361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:40.260523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m21:18:40.261756 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_rsi: Close
[0m21:18:40.387319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917e4560>]}
[0m21:18:40.387798 [info ] [Thread-1 (]: 3 of 5 OK created sql view model analytics.crypto_rsi .......................... [[32mSUCCESS 1[0m in 0.96s]
[0m21:18:40.388400 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_rsi
[0m21:18:40.388689 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_sma
[0m21:18:40.389012 [info ] [Thread-1 (]: 4 of 5 START sql view model analytics.crypto_sma ............................... [RUN]
[0m21:18:40.389419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_rsi, now model.crypto_currencies_elt.crypto_sma)
[0m21:18:40.389674 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_sma
[0m21:18:40.391360 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_sma"
[0m21:18:40.392173 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_sma
[0m21:18:40.393327 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_sma"
[0m21:18:40.394225 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_sma"
[0m21:18:40.394500 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_sma"} */
create or replace   view dev.analytics.crypto_sma
  
   as (
    WITH base AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_staging
)
, moving_avg AS (
    SELECT
        symbol,
        date,
        price_close,
        volume_traded,
        trades_count,
        AVG(price_close) OVER(PARTITION BY symbol ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS sma_7d
    FROM base
)
SELECT * FROM moving_avg
  );
[0m21:18:40.394705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:41.068242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m21:18:41.070546 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_sma: Close
[0m21:18:41.191634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f0e510>]}
[0m21:18:41.192182 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analytics.crypto_sma .......................... [[32mSUCCESS 1[0m in 0.80s]
[0m21:18:41.193604 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_sma
[0m21:18:41.194285 [debug] [Thread-1 (]: Began running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m21:18:41.194603 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.crypto_abstract_metrics ................. [RUN]
[0m21:18:41.194986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_currencies_elt.crypto_sma, now model.crypto_currencies_elt.crypto_abstract_metrics)
[0m21:18:41.195231 [debug] [Thread-1 (]: Began compiling node model.crypto_currencies_elt.crypto_abstract_metrics
[0m21:18:41.197051 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m21:18:41.198383 [debug] [Thread-1 (]: Began executing node model.crypto_currencies_elt.crypto_abstract_metrics
[0m21:18:41.207261 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m21:18:41.208498 [debug] [Thread-1 (]: Using snowflake connection "model.crypto_currencies_elt.crypto_abstract_metrics"
[0m21:18:41.208715 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "model.crypto_currencies_elt.crypto_abstract_metrics"} */
create or replace transient table dev.analytics.crypto_abstract_metrics
         as
        (WITH sma AS (
    SELECT
        symbol,
        date,
        sma_7d,
        price_close,
        volume_traded,
        trades_count
    FROM dev.analytics.crypto_sma
),

rsi AS (
    SELECT
        symbol,
        date,
        rsi_7d
    FROM dev.analytics.crypto_rsi
),

crypto_price_momentum AS (
    SELECT
        symbol,
        date,
        price_close,
        price_momentum_7d, 
        momentum_direction
    FROM dev.analytics.crypto_price_momentum
)

SELECT
    sma.symbol,
    sma.date,
    sma.price_close,
    sma.sma_7d,
    rsi.rsi_7d,
    sma.volume_traded,
    sma.trades_count,
    crypto_price_momentum. price_momentum_7d,
    crypto_price_momentum.momentum_direction
FROM sma
JOIN rsi ON sma.symbol = rsi.symbol AND sma.date = rsi.date
JOIN crypto_price_momentum ON sma.symbol = crypto_price_momentum.symbol AND sma.date = crypto_price_momentum.date
ORDER BY sma.symbol, sma.date
        );
[0m21:18:41.208907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:42.873324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.664 seconds
[0m21:18:42.878660 [debug] [Thread-1 (]: On model.crypto_currencies_elt.crypto_abstract_metrics: Close
[0m21:18:43.005375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfeaf602-b155-4c40-98e7-73650553b9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f6c830>]}
[0m21:18:43.007876 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.crypto_abstract_metrics ............ [[32mSUCCESS 1[0m in 1.81s]
[0m21:18:43.010608 [debug] [Thread-1 (]: Finished running node model.crypto_currencies_elt.crypto_abstract_metrics
[0m21:18:43.014470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:43.015422 [debug] [MainThread]: Connection 'model.crypto_currencies_elt.crypto_abstract_metrics' was properly closed.
[0m21:18:43.016228 [info ] [MainThread]: 
[0m21:18:43.017766 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m21:18:43.020621 [debug] [MainThread]: Command end result
[0m21:18:43.131725 [info ] [MainThread]: 
[0m21:18:43.132458 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:43.132719 [info ] [MainThread]: 
[0m21:18:43.132966 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m21:18:43.133686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.443656, "process_user_time": 2.889931, "process_kernel_time": 0.192055, "process_mem_max_rss": "212148", "process_out_blocks": "3948", "process_in_blocks": "0"}
[0m21:18:43.134110 [debug] [MainThread]: Command `dbt run` succeeded at 21:18:43.134017 after 8.44 seconds
[0m21:18:43.134393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3ffad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba19fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92542840>]}
[0m21:18:43.134629 [debug] [MainThread]: Flushing usage events
[0m21:18:45.933681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6dc6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6dc7ce0>]}


============================== 21:18:45.936850 | 42c2773e-38cc-4662-a09a-738caa7841f1 ==============================
[0m21:18:45.936850 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:18:45.937520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:46.298220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42c2773e-38cc-4662-a09a-738caa7841f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9219c3e0>]}
[0m21:18:46.318332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42c2773e-38cc-4662-a09a-738caa7841f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921694c0>]}
[0m21:18:46.318948 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:18:46.362461 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:18:46.437074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:46.437427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:46.458268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c2773e-38cc-4662-a09a-738caa7841f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5716c60>]}
[0m21:18:46.519367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c2773e-38cc-4662-a09a-738caa7841f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff919ac6b0>]}
[0m21:18:46.519685 [info ] [MainThread]: Found 5 models, 2 snapshots, 9 data tests, 2 sources, 575 macros
[0m21:18:46.520066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c2773e-38cc-4662-a09a-738caa7841f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9276a990>]}
[0m21:18:46.521048 [info ] [MainThread]: 
[0m21:18:46.521419 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:46.523502 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_snapshot'
[0m21:18:46.530652 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m21:18:46.530935 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m21:18:46.531164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:47.056675 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.525 seconds
[0m21:18:47.062090 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m21:18:47.192579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_snapshot, now list_dev_analytics)
[0m21:18:47.206178 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m21:18:47.209062 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m21:18:47.209694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:47.648390 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.438 seconds
[0m21:18:47.651200 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m21:18:47.763018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c2773e-38cc-4662-a09a-738caa7841f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f64890>]}
[0m21:18:47.765538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:47.768297 [info ] [MainThread]: 
[0m21:18:47.782755 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b
[0m21:18:47.783616 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral  [RUN]
[0m21:18:47.784728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_analytics, now test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b)
[0m21:18:47.785234 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b
[0m21:18:47.799552 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b"
[0m21:18:47.801609 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b
[0m21:18:47.814596 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b"
[0m21:18:47.815889 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b"
[0m21:18:47.816197 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        momentum_direction as value_field,
        count(*) as n_records

    from dev.analytics.crypto_abstract_metrics
    group by momentum_direction

)

select *
from all_values
where value_field not in (
    'Overbought','Oversold','Neutral'
)



      
    ) dbt_internal_test
[0m21:18:47.816489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:48.386386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m21:18:48.396536 [debug] [Thread-1 (]: On test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b: Close
[0m21:18:48.514016 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral  [[32mPASS[0m in 0.73s]
[0m21:18:48.516916 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b
[0m21:18:48.518501 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m21:18:48.519771 [info ] [Thread-1 (]: 2 of 9 START test not_null_crypto_abstract_metrics_date ........................ [RUN]
[0m21:18:48.521685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.accepted_values_crypto_abstract_metrics_momentum_direction__Overbought__Oversold__Neutral.4a2e0a631b, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06)
[0m21:18:48.522931 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m21:18:48.532808 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m21:18:48.536538 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m21:18:48.540990 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m21:18:48.543321 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"
[0m21:18:48.543849 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from dev.analytics.crypto_abstract_metrics
where date is null



      
    ) dbt_internal_test
[0m21:18:48.544322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:49.094139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m21:18:49.099721 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06: Close
[0m21:18:49.217547 [info ] [Thread-1 (]: 2 of 9 PASS not_null_crypto_abstract_metrics_date .............................. [[32mPASS[0m in 0.70s]
[0m21:18:49.219111 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06
[0m21:18:49.219624 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m21:18:49.220132 [info ] [Thread-1 (]: 3 of 9 START test not_null_crypto_abstract_metrics_price_close ................. [RUN]
[0m21:18:49.220757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_date.b0c0f93b06, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3)
[0m21:18:49.221130 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m21:18:49.224853 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m21:18:49.226115 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m21:18:49.227638 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m21:18:49.228647 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"
[0m21:18:49.228950 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_close
from dev.analytics.crypto_abstract_metrics
where price_close is null



      
    ) dbt_internal_test
[0m21:18:49.229234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:49.796384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m21:18:49.801925 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3: Close
[0m21:18:49.909151 [info ] [Thread-1 (]: 3 of 9 PASS not_null_crypto_abstract_metrics_price_close ....................... [[32mPASS[0m in 0.69s]
[0m21:18:49.911134 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3
[0m21:18:49.912021 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6
[0m21:18:49.912920 [info ] [Thread-1 (]: 4 of 9 START test not_null_crypto_abstract_metrics_price_momentum_7d ........... [RUN]
[0m21:18:49.914158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_close.aca51c56e3, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6)
[0m21:18:49.914968 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6
[0m21:18:49.922134 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6"
[0m21:18:49.924716 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6
[0m21:18:49.929681 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6"
[0m21:18:49.931661 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6"
[0m21:18:49.932291 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price_momentum_7d
from dev.analytics.crypto_abstract_metrics
where price_momentum_7d is null



      
    ) dbt_internal_test
[0m21:18:49.932855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:50.422883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m21:18:50.427108 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6: Close
[0m21:18:50.544902 [info ] [Thread-1 (]: 4 of 9 PASS not_null_crypto_abstract_metrics_price_momentum_7d ................. [[32mPASS[0m in 0.63s]
[0m21:18:50.547463 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6
[0m21:18:50.548560 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m21:18:50.549577 [info ] [Thread-1 (]: 5 of 9 START test not_null_crypto_abstract_metrics_rsi_7d ...................... [RUN]
[0m21:18:50.550829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_price_momentum_7d.e059c335b6, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405)
[0m21:18:50.551469 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m21:18:50.556305 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m21:18:50.558882 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m21:18:50.561006 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m21:18:50.562601 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"
[0m21:18:50.563079 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_7d
from dev.analytics.crypto_abstract_metrics
where rsi_7d is null



      
    ) dbt_internal_test
[0m21:18:50.563473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:51.106322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m21:18:51.112102 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405: Close
[0m21:18:51.248600 [info ] [Thread-1 (]: 5 of 9 PASS not_null_crypto_abstract_metrics_rsi_7d ............................ [[32mPASS[0m in 0.70s]
[0m21:18:51.251219 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405
[0m21:18:51.252545 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m21:18:51.253629 [info ] [Thread-1 (]: 6 of 9 START test not_null_crypto_abstract_metrics_sma_7d ...................... [RUN]
[0m21:18:51.255188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_rsi_7d.f47a972405, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003)
[0m21:18:51.255897 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m21:18:51.261870 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m21:18:51.263587 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m21:18:51.265906 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m21:18:51.267292 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"
[0m21:18:51.267790 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sma_7d
from dev.analytics.crypto_abstract_metrics
where sma_7d is null



      
    ) dbt_internal_test
[0m21:18:51.268200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:51.757653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m21:18:51.762089 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003: Close
[0m21:18:51.891415 [info ] [Thread-1 (]: 6 of 9 PASS not_null_crypto_abstract_metrics_sma_7d ............................ [[32mPASS[0m in 0.64s]
[0m21:18:51.894609 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003
[0m21:18:51.896102 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m21:18:51.897229 [info ] [Thread-1 (]: 7 of 9 START test not_null_crypto_abstract_metrics_symbol ...................... [RUN]
[0m21:18:51.898719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_sma_7d.63bf00d003, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e)
[0m21:18:51.899616 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m21:18:51.906400 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m21:18:51.909354 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m21:18:51.911812 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m21:18:51.913641 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"
[0m21:18:51.914147 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from dev.analytics.crypto_abstract_metrics
where symbol is null



      
    ) dbt_internal_test
[0m21:18:51.914647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:52.410839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.496 seconds
[0m21:18:52.415555 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e: Close
[0m21:18:52.530530 [info ] [Thread-1 (]: 7 of 9 PASS not_null_crypto_abstract_metrics_symbol ............................ [[32mPASS[0m in 0.63s]
[0m21:18:52.531340 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e
[0m21:18:52.531772 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m21:18:52.532110 [info ] [Thread-1 (]: 8 of 9 START test not_null_crypto_abstract_metrics_trades_count ................ [RUN]
[0m21:18:52.532680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_symbol.e182650d5e, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724)
[0m21:18:52.532983 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m21:18:52.535659 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m21:18:52.536483 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m21:18:52.538721 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m21:18:52.539504 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"
[0m21:18:52.539739 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trades_count
from dev.analytics.crypto_abstract_metrics
where trades_count is null



      
    ) dbt_internal_test
[0m21:18:52.539966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:53.035608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m21:18:53.041415 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724: Close
[0m21:18:53.161525 [info ] [Thread-1 (]: 8 of 9 PASS not_null_crypto_abstract_metrics_trades_count ...................... [[32mPASS[0m in 0.63s]
[0m21:18:53.164677 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724
[0m21:18:53.165981 [debug] [Thread-1 (]: Began running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m21:18:53.167015 [info ] [Thread-1 (]: 9 of 9 START test not_null_crypto_abstract_metrics_volume_traded ............... [RUN]
[0m21:18:53.168373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.crypto_currencies_elt.not_null_crypto_abstract_metrics_trades_count.03b6f24724, now test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56)
[0m21:18:53.169273 [debug] [Thread-1 (]: Began compiling node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m21:18:53.176024 [debug] [Thread-1 (]: Writing injected SQL for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m21:18:53.178215 [debug] [Thread-1 (]: Began executing node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m21:18:53.180727 [debug] [Thread-1 (]: Writing runtime sql for node "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m21:18:53.182529 [debug] [Thread-1 (]: Using snowflake connection "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"
[0m21:18:53.183029 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select volume_traded
from dev.analytics.crypto_abstract_metrics
where volume_traded is null



      
    ) dbt_internal_test
[0m21:18:53.183509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:53.692303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.509 seconds
[0m21:18:53.695252 [debug] [Thread-1 (]: On test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56: Close
[0m21:18:53.823227 [info ] [Thread-1 (]: 9 of 9 PASS not_null_crypto_abstract_metrics_volume_traded ..................... [[32mPASS[0m in 0.65s]
[0m21:18:53.826580 [debug] [Thread-1 (]: Finished running node test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56
[0m21:18:53.832026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:53.833182 [debug] [MainThread]: Connection 'test.crypto_currencies_elt.not_null_crypto_abstract_metrics_volume_traded.7949c42b56' was properly closed.
[0m21:18:53.834217 [info ] [MainThread]: 
[0m21:18:53.834891 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 7.31 seconds (7.31s).
[0m21:18:53.837190 [debug] [MainThread]: Command end result
[0m21:18:53.877327 [info ] [MainThread]: 
[0m21:18:53.877875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:53.878171 [info ] [MainThread]: 
[0m21:18:53.878542 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m21:18:53.879559 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.9830356, "process_user_time": 2.967541, "process_kernel_time": 0.178574, "process_mem_max_rss": "209672", "process_out_blocks": "2681", "process_in_blocks": "0"}
[0m21:18:53.880009 [debug] [MainThread]: Command `dbt test` succeeded at 21:18:53.879922 after 7.98 seconds
[0m21:18:53.880359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b23080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fc4e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57e7b60>]}
[0m21:18:53.880650 [debug] [MainThread]: Flushing usage events
[0m21:18:56.907168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9cde1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcac60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5db080>]}


============================== 21:18:56.910343 | 034ddf3d-008a-4a11-a4f7-21f063118429 ==============================
[0m21:18:56.910343 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:18:56.910858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/crypto_currencies_elt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/crypto_currencies_elt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/crypto_currencies_elt --project-dir /opt/airflow/crypto_currencies_elt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:18:57.301940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '034ddf3d-008a-4a11-a4f7-21f063118429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97627e0>]}
[0m21:18:57.321594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '034ddf3d-008a-4a11-a4f7-21f063118429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9638a030>]}
[0m21:18:57.322080 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:18:57.369213 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:18:57.465465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:57.465909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:57.496591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '034ddf3d-008a-4a11-a4f7-21f063118429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96231340>]}
[0m21:18:57.566997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '034ddf3d-008a-4a11-a4f7-21f063118429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95dbefc0>]}
[0m21:18:57.567404 [info ] [MainThread]: Found 5 models, 2 snapshots, 9 data tests, 2 sources, 575 macros
[0m21:18:57.568188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034ddf3d-008a-4a11-a4f7-21f063118429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbdfd6de0>]}
[0m21:18:57.569532 [info ] [MainThread]: 
[0m21:18:57.570106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:57.572344 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev'
[0m21:18:57.579752 [debug] [ThreadPool]: Using snowflake connection "list_dev"
[0m21:18:57.580057 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev"} */
show terse schemas in database dev
    limit 10000
[0m21:18:57.580231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:57.996900 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.417 seconds
[0m21:18:57.998158 [debug] [ThreadPool]: On list_dev: Close
[0m21:18:58.134777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now list_dev_analytics)
[0m21:18:58.140731 [debug] [ThreadPool]: Using snowflake connection "list_dev_analytics"
[0m21:18:58.141186 [debug] [ThreadPool]: On list_dev_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_analytics"} */
show objects in dev.analytics limit 10000
[0m21:18:58.141856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:58.642571 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.501 seconds
[0m21:18:58.644408 [debug] [ThreadPool]: On list_dev_analytics: Close
[0m21:18:58.750651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_analytics, now list_dev_snapshot)
[0m21:18:58.753347 [debug] [ThreadPool]: Using snowflake connection "list_dev_snapshot"
[0m21:18:58.753774 [debug] [ThreadPool]: On list_dev_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "connection_name": "list_dev_snapshot"} */
show objects in dev.snapshot limit 10000
[0m21:18:58.754076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:59.164014 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.410 seconds
[0m21:18:59.165212 [debug] [ThreadPool]: On list_dev_snapshot: Close
[0m21:18:59.291456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '034ddf3d-008a-4a11-a4f7-21f063118429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95dbe600>]}
[0m21:18:59.291984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:18:59.292643 [info ] [MainThread]: 
[0m21:18:59.298131 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m21:18:59.298599 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshot.snapshot_crypto_abstract_metrics ................ [RUN]
[0m21:18:59.299084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_snapshot, now snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics)
[0m21:18:59.299334 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m21:18:59.308316 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m21:18:59.333215 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:18:59.333617 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m21:18:59.333857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:59.710003 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.376 seconds
[0m21:18:59.738655 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:18:59.739111 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_7d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m21:19:00.588990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m21:19:00.597186 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:00.598691 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m21:19:00.709626 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.110 seconds
[0m21:19:00.713005 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:00.713587 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m21:19:00.864177 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.150 seconds
[0m21:19:00.872209 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:00.873863 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m21:19:00.985214 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.110 seconds
[0m21:19:00.995503 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:00.996542 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
[0m21:19:01.086627 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.089 seconds
[0m21:19:01.094846 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:01.095476 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp"
[0m21:19:01.190184 [debug] [Thread-1 (]: SQL status: SUCCESS 16 in 0.094 seconds
[0m21:19:01.218156 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:01.219006 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_close,
        sma_7d,
        rsi_7d,
        volume_traded,
        trades_count,
        price_momentum_7d,
        momentum_direction
    FROM dev.analytics.crypto_abstract_metrics
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m21:19:01.382608 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.162 seconds
[0m21:19:01.393291 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:01.394677 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:19:01.479304 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m21:19:01.481197 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:01.484694 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:01.485391 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
BEGIN
[0m21:19:01.632173 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m21:19:01.634645 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:01.635270 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_ABSTRACT_METRICS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_7D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_CLOSE", "SMA_7D", "RSI_7D", "VOLUME_TRADED", "TRADES_COUNT", "PRICE_MOMENTUM_7D", "MOMENTUM_DIRECTION", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:19:02.533895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.898 seconds
[0m21:19:02.535691 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"
[0m21:19:02.536363 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics"} */
COMMIT
[0m21:19:02.810351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m21:19:02.862178 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics: Close
[0m21:19:03.012903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034ddf3d-008a-4a11-a4f7-21f063118429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96558410>]}
[0m21:19:03.015224 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshot.snapshot_crypto_abstract_metrics ................ [[32mSUCCESS 0[0m in 3.71s]
[0m21:19:03.018679 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics
[0m21:19:03.019521 [debug] [Thread-1 (]: Began running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m21:19:03.020399 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshot.snapshot_crypto_currencies ...................... [RUN]
[0m21:19:03.021329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.crypto_currencies_elt.snapshot_crypto_abstract_metrics, now snapshot.crypto_currencies_elt.snapshot_crypto_currencies)
[0m21:19:03.021719 [debug] [Thread-1 (]: Began compiling node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m21:19:03.026420 [debug] [Thread-1 (]: Began executing node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m21:19:03.032020 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:03.032875 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m21:19:03.033473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:03.455005 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.421 seconds
[0m21:19:03.468566 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:03.469788 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
create or replace temporary table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
         as
        (

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m21:19:04.274007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.803 seconds
[0m21:19:04.280697 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:04.282009 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m21:19:04.422858 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.140 seconds
[0m21:19:04.431374 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:04.432543 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m21:19:04.521102 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.088 seconds
[0m21:19:04.530284 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:04.531641 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m21:19:04.652404 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.120 seconds
[0m21:19:04.661806 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:04.665812 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
[0m21:19:04.758189 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.091 seconds
[0m21:19:04.761954 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:04.762509 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
describe table "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp"
[0m21:19:04.858794 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.096 seconds
[0m21:19:04.864858 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:04.865592 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        

    with snapshot_query as (

        



WITH source_data AS (
    SELECT
        md5(cast(coalesce(cast(symbol as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id,
        symbol,
        date,
        price_open,
        price_high,
        price_low,
        price_close,
        volume_traded,
	trades_count
    FROM dev.raw_data.crypto_currencies
)

SELECT * FROM source_data


    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            
  
  coalesce(nullif(date, date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            date as dbt_updated_at,
            date as dbt_valid_from,
            date as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.date)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m21:19:05.398960 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.532 seconds
[0m21:19:05.402143 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:05.403120 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m21:19:05.536652 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.132 seconds
[0m21:19:05.538852 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:05.542297 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:05.543118 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
BEGIN
[0m21:19:05.671138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m21:19:05.671514 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:05.671783 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
merge into "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES" as DBT_INTERNAL_DEST
    using "DEV"."SNAPSHOT"."SNAPSHOT_CRYPTO_CURRENCIES__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "SYMBOL", "DATE", "PRICE_OPEN", "PRICE_HIGH", "PRICE_LOW", "PRICE_CLOSE", "VOLUME_TRADED", "TRADES_COUNT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m21:19:06.116977 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.445 seconds
[0m21:19:06.118502 [debug] [Thread-1 (]: Using snowflake connection "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"
[0m21:19:06.120485 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "crypto_currencies_elt", "target_name": "dev", "node_id": "snapshot.crypto_currencies_elt.snapshot_crypto_currencies"} */
COMMIT
[0m21:19:06.572355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m21:19:06.576934 [debug] [Thread-1 (]: On snapshot.crypto_currencies_elt.snapshot_crypto_currencies: Close
[0m21:19:06.708186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '034ddf3d-008a-4a11-a4f7-21f063118429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd8278f0>]}
[0m21:19:06.709888 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshot.snapshot_crypto_currencies ...................... [[32mSUCCESS 0[0m in 3.69s]
[0m21:19:06.711628 [debug] [Thread-1 (]: Finished running node snapshot.crypto_currencies_elt.snapshot_crypto_currencies
[0m21:19:06.714408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:06.715091 [debug] [MainThread]: Connection 'snapshot.crypto_currencies_elt.snapshot_crypto_currencies' was properly closed.
[0m21:19:06.715736 [info ] [MainThread]: 
[0m21:19:06.716599 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m21:19:06.717802 [debug] [MainThread]: Command end result
[0m21:19:06.767027 [info ] [MainThread]: 
[0m21:19:06.768758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:19:06.769498 [info ] [MainThread]: 
[0m21:19:06.770113 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:19:06.778943 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 9.906198, "process_user_time": 2.746491, "process_kernel_time": 0.190401, "process_mem_max_rss": "209356", "process_out_blocks": "2680", "process_in_blocks": "0"}
[0m21:19:06.780896 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:19:06.780632 after 9.91 seconds
[0m21:19:06.782498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba43d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c83a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9f52300>]}
[0m21:19:06.783640 [debug] [MainThread]: Flushing usage events
